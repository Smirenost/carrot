{"version":3,"sources":["architecture/layer/Layer.js","architecture/layer/ConvolutionLayer.js","methods/Activation.js","architecture/Connection.js","methods/Utils.js","architecture/Node.js","architecture/layer/DenseLayer.js","architecture/layer/GaussianNoiseLayer.js","architecture/layer/InputLayer.js","architecture/layer/LSTMLayer.js","architecture/layer/PoolLayer.js","architecture/layer/RNNLayer.js","architecture/Architect.js","methods/Mutation.js","methods/Loss.js","methods/Rate.js","methods/Selection.js","NEAT.js","architecture/Network.js","architecture/node.js","index.js"],"names":["Object","defineProperty","exports","value","Layer","inputSize","outputSize","nodes","connections","__extends","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Layer_1","require","ConvolutionLayer","_super","call","Activation","type","ActivationType","NO_ACTIVATION","getActivation","activationType","LogisticActivation","TanhActivation","IdentityActivation","StepActivation","RELUActivation","SoftsignActivation","SinusoidActivation","GaussianActivation","BentIdentityActivation","BipolarActivation","BipolarSigmoidActivation","HardTanhActivation","AbsoluteActivation","InverseActivation","SELUActivation","ReferenceError","ALL_ACTIVATIONS","calc","x","derivative","Math","exp","tanh","abs","sin","cos","sqrt","max","min","alpha","scale","Connection","from","to","weight","gateNode","gain","eligibility","deltaWeightsPrevious","deltaWeightsTotal","xTraceNodes","xTraceValues","addGate","innovationID","a","toJSON","fromIndex","index","toIndex","gateNodeIndex","pickRandom","arr","randInt","length","floor","random","randDouble","randBoolean","anyMatch","target","_i","arr_1","elem","remove","indexOf","splice","getOrDefault","defaultValue","undefined","shuffle","array","counter","temp","Activation_1","Connection_1","Utils_1","Node","NodeType","HIDDEN","bias","squash","activation","state","old","mask","deltaBiasPrevious","deltaBiasTotal","incoming","outgoing","gated","selfConnection","errorResponsibility","errorProjected","errorGated","NaN","fromJSON","json","node","clear","_a","connection","_b","_c","mutateBias","method","mutateActivation","newActivationType","isProjectedBy","map","conn","isProjectingTo","push","removeGate","connect","twoSided","disconnect","Error","propagate","momentum","rate","update","Number","isFinite","influence","_d","_e","gradient","j","responsibility","projected","activate","input","trace","_this","forEach","nodes_1","influences_1","i","isInputNode","INPUT","isHiddenNode","isOutputNode","OUTPUT","Node_1","DenseLayer","filter","inputNode","outputNode","GaussianNoiseLayer","InputLayer","LSTMLayer","PoolLayer","PoolingType","RNNLayer","Architect","layers","addLayer","layer","RangeError","Mutation","AddNodeMutation","randomActivation","mutate","genome","maxNodes","minBound","newConnection1","newConnection2","SubNodeMutation","keepGates","possible","removeNode","AddConnectionMutation","apply","arguments","maxConnections","pair","SubConnectionMutation","randomConnection","ModWeightMutation","ModBiasMutation","ModActivationMutation","mutateOutput","AddSelfConnectionMutation","SubSelfConnectionMutation","AddGateMutation","maxGates","gates","SubGateMutation","AddBackConnectionMutation","SubBackConnectionMutation","SwapNodesMutation","node1_1","node2","biasTemp","squashTemp","ALL_MUTATIONS","FEEDFORWARD_MUTATIONS","Loss","CrossEntropyLoss","targets","outputs","error","log","MSELoss","pow","BinaryLoss","round","MAELoss","MAPELoss","WAPELoss","sum","MSLELoss","HINGELoss","ALL_LOSSES","Rate","baseRate","FixedRate","iteration","StepRate","gamma","stepSize","ExponentialRate","InverseRate","power","Selection","FitnessProportionateSelection","select","population","totalFitness","minimalFitness","population_1","score","population_2","PowerSelection","TournamentSelection","size","probability","individuals","sort","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","pop","__spreadArrays","s","il","r","k","jl","Network_1","Selection_1","Mutation_1","NEAT","dataset","options","generation","output","equal","populationSize","elitism","provenance","mutationRate","mutationAmount","fitnessPopulation","fitnessFunction","selection","mutations","template","Network","Infinity","createInitialPopulation","filterGenome","pickGenome","adjustGenome","filtered","copy","mutateRandom","name","evolve","elitists","newPopulation","fittest","evaluate","fill","getOffspring","parent1","parent2","crossOver","getFittest","getAverage","val","Loss_1","Rate_1","NEAT_1","network","nodeJSON","jsonConnection","network1","network2","offspring","score1","score2","offspringSize","chosenNode","chosenNodeType","sourceNetwork","inputNumber","outputNumber","newNode","n1connections","n2connections","keys1","keys","keys2","parseInt","key","connectionJSON","dropoutRate","inputNodeIndex","targetIndex","inputs","gate","shift","allowedMethods","train","iterations","loss","dropout","batchSize","ratePolicy","targetError","start","Date","now","trainingSetSize","trainingSet","testSet","crossValidateTestSize","ceil","slice","currentTrainingRate","iterationCount","trainError","trainEpoch","test","console","schedule","function","time","trainingRate","errorSum","correctOutput","dataset_1","entry","neat","bestFitness","bestGenome","fitness","growth","amount","isArray","all","__importStar","mod","__esModule","ConvolutionLayer_1","DenseLayer_1","GaussianNoiseLayer_1","InputLayer_1","LSTMLayer_1","PoolLayer_1","RNNLayer_1","Architect_1","node_1"],"mappings":"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","file":"index.js","sourceRoot":"..\\..\\build\\src","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer = /** @class */ (function () {\r\n    function Layer(inputSize, outputSize) {\r\n        this.inputSize = inputSize;\r\n        this.outputSize = outputSize;\r\n        this.nodes = [];\r\n        this.connections = [];\r\n    }\r\n    return Layer;\r\n}());\r\nexports.Layer = Layer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar ConvolutionLayer = /** @class */ (function (_super) {\r\n    __extends(ConvolutionLayer, _super);\r\n    function ConvolutionLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return ConvolutionLayer;\r\n}(Layer_1.Layer));\r\nexports.ConvolutionLayer = ConvolutionLayer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Activation = /** @class */ (function () {\r\n    function Activation() {\r\n        this.type = ActivationType.NO_ACTIVATION;\r\n    }\r\n    Activation.getActivation = function (activationType) {\r\n        switch (activationType) {\r\n            case ActivationType.LogisticActivation:\r\n                return new LogisticActivation();\r\n            case ActivationType.TanhActivation:\r\n                return new TanhActivation();\r\n            case ActivationType.IdentityActivation:\r\n                return new IdentityActivation();\r\n            case ActivationType.StepActivation:\r\n                return new StepActivation();\r\n            case ActivationType.RELUActivation:\r\n                return new RELUActivation();\r\n            case ActivationType.SoftsignActivation:\r\n                return new SoftsignActivation();\r\n            case ActivationType.SinusoidActivation:\r\n                return new LogisticActivation();\r\n            case ActivationType.GaussianActivation:\r\n                return new GaussianActivation();\r\n            case ActivationType.BentIdentityActivation:\r\n                return new BentIdentityActivation();\r\n            case ActivationType.BipolarActivation:\r\n                return new BipolarActivation();\r\n            case ActivationType.BipolarSigmoidActivation:\r\n                return new BipolarSigmoidActivation();\r\n            case ActivationType.HardTanhActivation:\r\n                return new HardTanhActivation();\r\n            case ActivationType.AbsoluteActivation:\r\n                return new AbsoluteActivation();\r\n            case ActivationType.InverseActivation:\r\n                return new InverseActivation();\r\n            case ActivationType.SELUActivation:\r\n                return new SELUActivation();\r\n        }\r\n        throw new ReferenceError(activationType + \" is not the name of any available activations! These are all available activations: \" + exports.ALL_ACTIVATIONS);\r\n    };\r\n    return Activation;\r\n}());\r\nexports.Activation = Activation;\r\nvar LogisticActivation = /** @class */ (function () {\r\n    function LogisticActivation() {\r\n        this.type = ActivationType.LogisticActivation;\r\n    }\r\n    LogisticActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return 1 / (1 + Math.exp(-x));\r\n        }\r\n        else {\r\n            return this.calc(x, false) * (1 - this.calc(x, false));\r\n        }\r\n    };\r\n    return LogisticActivation;\r\n}());\r\nexports.LogisticActivation = LogisticActivation;\r\nvar TanhActivation = /** @class */ (function () {\r\n    function TanhActivation() {\r\n        this.type = ActivationType.TanhActivation;\r\n    }\r\n    TanhActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.tanh(x);\r\n        }\r\n        else {\r\n            return 1 - this.calc(x, false) * this.calc(x, false);\r\n        }\r\n    };\r\n    return TanhActivation;\r\n}());\r\nexports.TanhActivation = TanhActivation;\r\nvar IdentityActivation = /** @class */ (function () {\r\n    function IdentityActivation() {\r\n        this.type = ActivationType.IdentityActivation;\r\n    }\r\n    IdentityActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x;\r\n        }\r\n        else {\r\n            return 1;\r\n        }\r\n    };\r\n    return IdentityActivation;\r\n}());\r\nexports.IdentityActivation = IdentityActivation;\r\nvar StepActivation = /** @class */ (function () {\r\n    function StepActivation() {\r\n        this.type = ActivationType.StepActivation;\r\n    }\r\n    StepActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x < 0 ? 0 : 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    return StepActivation;\r\n}());\r\nexports.StepActivation = StepActivation;\r\nvar RELUActivation = /** @class */ (function () {\r\n    function RELUActivation() {\r\n        this.type = ActivationType.RELUActivation;\r\n    }\r\n    RELUActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x <= 0 ? 0 : x;\r\n        }\r\n        else {\r\n            return x <= 0 ? 0 : 1;\r\n        }\r\n    };\r\n    return RELUActivation;\r\n}());\r\nexports.RELUActivation = RELUActivation;\r\nvar SoftsignActivation = /** @class */ (function () {\r\n    function SoftsignActivation() {\r\n        this.type = ActivationType.SoftsignActivation;\r\n    }\r\n    SoftsignActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x / (1 + Math.abs(x));\r\n        }\r\n        else {\r\n            return x / ((1 + Math.abs(x)) * (1 + Math.abs(x)));\r\n        }\r\n    };\r\n    return SoftsignActivation;\r\n}());\r\nexports.SoftsignActivation = SoftsignActivation;\r\nvar SinusoidActivation = /** @class */ (function () {\r\n    function SinusoidActivation() {\r\n        this.type = ActivationType.SinusoidActivation;\r\n    }\r\n    SinusoidActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.sin(x);\r\n        }\r\n        else {\r\n            return Math.cos(x);\r\n        }\r\n    };\r\n    return SinusoidActivation;\r\n}());\r\nexports.SinusoidActivation = SinusoidActivation;\r\nvar GaussianActivation = /** @class */ (function () {\r\n    function GaussianActivation() {\r\n        this.type = ActivationType.GaussianActivation;\r\n    }\r\n    GaussianActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.exp(-x * x);\r\n        }\r\n        else {\r\n            return -2 * x * this.calc(x, false);\r\n        }\r\n    };\r\n    return GaussianActivation;\r\n}());\r\nexports.GaussianActivation = GaussianActivation;\r\nvar BentIdentityActivation = /** @class */ (function () {\r\n    function BentIdentityActivation() {\r\n        this.type = ActivationType.BentIdentityActivation;\r\n    }\r\n    BentIdentityActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return (Math.sqrt(x * x + 1) - 1) / 2 + x;\r\n        }\r\n        else {\r\n            return x / (2 * Math.sqrt(x * x + 1)) + 1;\r\n        }\r\n    };\r\n    return BentIdentityActivation;\r\n}());\r\nexports.BentIdentityActivation = BentIdentityActivation;\r\nvar BipolarActivation = /** @class */ (function () {\r\n    function BipolarActivation() {\r\n        this.type = ActivationType.BipolarActivation;\r\n    }\r\n    BipolarActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x > 0 ? 1 : -1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    return BipolarActivation;\r\n}());\r\nexports.BipolarActivation = BipolarActivation;\r\nvar BipolarSigmoidActivation = /** @class */ (function () {\r\n    function BipolarSigmoidActivation() {\r\n        this.type = ActivationType.BipolarSigmoidActivation;\r\n    }\r\n    BipolarSigmoidActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return 2 / (1 + Math.exp(-x)) - 1;\r\n        }\r\n        else {\r\n            return (2 * Math.exp(-x)) / ((1 + Math.exp(-x)) * (1 + Math.exp(-x)));\r\n        }\r\n    };\r\n    return BipolarSigmoidActivation;\r\n}());\r\nexports.BipolarSigmoidActivation = BipolarSigmoidActivation;\r\nvar HardTanhActivation = /** @class */ (function () {\r\n    function HardTanhActivation() {\r\n        this.type = ActivationType.HardTanhActivation;\r\n    }\r\n    HardTanhActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.max(-1, Math.min(1, x));\r\n        }\r\n        else {\r\n            return Math.abs(x) < 1 ? 1 : 0;\r\n        }\r\n    };\r\n    return HardTanhActivation;\r\n}());\r\nexports.HardTanhActivation = HardTanhActivation;\r\nvar AbsoluteActivation = /** @class */ (function () {\r\n    function AbsoluteActivation() {\r\n        this.type = ActivationType.AbsoluteActivation;\r\n    }\r\n    AbsoluteActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.abs(x);\r\n        }\r\n        else {\r\n            return x < 0 ? -1 : 1;\r\n        }\r\n    };\r\n    return AbsoluteActivation;\r\n}());\r\nexports.AbsoluteActivation = AbsoluteActivation;\r\nvar InverseActivation = /** @class */ (function () {\r\n    function InverseActivation() {\r\n        this.type = ActivationType.InverseActivation;\r\n    }\r\n    InverseActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return 1 - x;\r\n        }\r\n        else {\r\n            return -1;\r\n        }\r\n    };\r\n    return InverseActivation;\r\n}());\r\nexports.InverseActivation = InverseActivation;\r\nvar SELUActivation = /** @class */ (function () {\r\n    function SELUActivation() {\r\n        this.type = ActivationType.SELUActivation;\r\n    }\r\n    SELUActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        var alpha = 1.6732632423543772848170429916717;\r\n        var scale = 1.0507009873554804934193349852946;\r\n        if (!derivative) {\r\n            if (x > 0) {\r\n                return x * scale;\r\n            }\r\n            else {\r\n                return alpha * Math.exp(x) - alpha * scale;\r\n            }\r\n        }\r\n        else if (x > 0) {\r\n            return scale;\r\n        }\r\n        else {\r\n            return alpha * Math.exp(x) * scale;\r\n        }\r\n    };\r\n    return SELUActivation;\r\n}());\r\nexports.SELUActivation = SELUActivation;\r\nvar ActivationType;\r\n(function (ActivationType) {\r\n    ActivationType[ActivationType[\"NO_ACTIVATION\"] = 0] = \"NO_ACTIVATION\";\r\n    ActivationType[ActivationType[\"LogisticActivation\"] = 1] = \"LogisticActivation\";\r\n    ActivationType[ActivationType[\"TanhActivation\"] = 2] = \"TanhActivation\";\r\n    ActivationType[ActivationType[\"IdentityActivation\"] = 3] = \"IdentityActivation\";\r\n    ActivationType[ActivationType[\"StepActivation\"] = 4] = \"StepActivation\";\r\n    ActivationType[ActivationType[\"RELUActivation\"] = 5] = \"RELUActivation\";\r\n    ActivationType[ActivationType[\"SoftsignActivation\"] = 6] = \"SoftsignActivation\";\r\n    ActivationType[ActivationType[\"SinusoidActivation\"] = 7] = \"SinusoidActivation\";\r\n    ActivationType[ActivationType[\"GaussianActivation\"] = 8] = \"GaussianActivation\";\r\n    ActivationType[ActivationType[\"BentIdentityActivation\"] = 9] = \"BentIdentityActivation\";\r\n    ActivationType[ActivationType[\"BipolarActivation\"] = 10] = \"BipolarActivation\";\r\n    ActivationType[ActivationType[\"BipolarSigmoidActivation\"] = 11] = \"BipolarSigmoidActivation\";\r\n    ActivationType[ActivationType[\"HardTanhActivation\"] = 12] = \"HardTanhActivation\";\r\n    ActivationType[ActivationType[\"AbsoluteActivation\"] = 13] = \"AbsoluteActivation\";\r\n    ActivationType[ActivationType[\"InverseActivation\"] = 14] = \"InverseActivation\";\r\n    ActivationType[ActivationType[\"SELUActivation\"] = 15] = \"SELUActivation\";\r\n})(ActivationType = exports.ActivationType || (exports.ActivationType = {}));\r\nexports.ALL_ACTIVATIONS = [\r\n    ActivationType.LogisticActivation,\r\n    ActivationType.TanhActivation,\r\n    ActivationType.IdentityActivation,\r\n    ActivationType.StepActivation,\r\n    ActivationType.RELUActivation,\r\n    ActivationType.SoftsignActivation,\r\n    ActivationType.SinusoidActivation,\r\n    ActivationType.GaussianActivation,\r\n    ActivationType.BentIdentityActivation,\r\n    ActivationType.BipolarActivation,\r\n    ActivationType.BipolarSigmoidActivation,\r\n    ActivationType.HardTanhActivation,\r\n    ActivationType.AbsoluteActivation,\r\n    ActivationType.InverseActivation,\r\n    ActivationType.SELUActivation\r\n];\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Connection = /** @class */ (function () {\r\n    function Connection(from, to, weight, gateNode) {\r\n        this.from = from;\r\n        this.to = to;\r\n        this.weight = weight || 0;\r\n        this.gain = 1;\r\n        this.eligibility = 0;\r\n        this.deltaWeightsPrevious = 0;\r\n        this.deltaWeightsTotal = 0;\r\n        this.xTraceNodes = [];\r\n        this.xTraceValues = [];\r\n        if (gateNode) {\r\n            this.gateNode = gateNode;\r\n            gateNode.addGate(this);\r\n        }\r\n        else {\r\n            this.gateNode = null;\r\n        }\r\n    }\r\n    Connection.innovationID = function (a, b) {\r\n        return 1 / 2 * (a + b) * (a + b + 1) + b;\r\n    };\r\n    Connection.prototype.toJSON = function () {\r\n        return {\r\n            fromIndex: this.from.index,\r\n            toIndex: this.to.index,\r\n            gateNodeIndex: this.gateNode === null ? null : this.gateNode.index,\r\n            weight: this.weight\r\n        };\r\n    };\r\n    return Connection;\r\n}());\r\nexports.Connection = Connection;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction pickRandom(arr) {\r\n    return arr[randInt(0, arr.length)];\r\n}\r\nexports.pickRandom = pickRandom;\r\nfunction randInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min) + min);\r\n}\r\nexports.randInt = randInt;\r\nfunction randDouble(min, max) {\r\n    return Math.random() * (max - min) + min;\r\n}\r\nexports.randDouble = randDouble;\r\nfunction randBoolean() {\r\n    return Math.random() >= 0.5;\r\n}\r\nexports.randBoolean = randBoolean;\r\nfunction anyMatch(arr, target) {\r\n    for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n        var elem = arr_1[_i];\r\n        if (elem === target) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexports.anyMatch = anyMatch;\r\nfunction remove(arr, elem) {\r\n    var index = arr.indexOf(elem);\r\n    if (index === -1) {\r\n        return false;\r\n    }\r\n    else {\r\n        arr.splice(index, 1);\r\n        return true;\r\n    }\r\n}\r\nexports.remove = remove;\r\nfunction getOrDefault(value, defaultValue) {\r\n    return value !== undefined && value !== null ? value : defaultValue;\r\n}\r\nexports.getOrDefault = getOrDefault;\r\nfunction shuffle(array) {\r\n    var counter = array.length;\r\n    // While there are elements in the array\r\n    while (counter > 0) {\r\n        // Pick a random index\r\n        var index = randInt(0, counter);\r\n        // Decrease counter by 1\r\n        counter--;\r\n        // And swap the last element with it\r\n        var temp = array[counter];\r\n        array[counter] = array[index];\r\n        array[index] = temp;\r\n    }\r\n    return array;\r\n}\r\nexports.shuffle = shuffle;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Activation_1 = require(\"../methods/Activation\");\r\nvar Connection_1 = require(\"./Connection\");\r\nvar Utils_1 = require(\"../methods/Utils\");\r\nvar Node = /** @class */ (function () {\r\n    function Node(type) {\r\n        if (type === void 0) { type = NodeType.HIDDEN; }\r\n        this.type = type;\r\n        this.bias = Utils_1.randDouble(-1, 1);\r\n        this.squash = new Activation_1.LogisticActivation();\r\n        this.activation = 0;\r\n        this.state = 0;\r\n        this.old = 0;\r\n        this.mask = 1;\r\n        this.deltaBiasPrevious = 0;\r\n        this.deltaBiasTotal = 0;\r\n        this.incoming = [];\r\n        this.outgoing = [];\r\n        this.gated = [];\r\n        this.selfConnection = new Connection_1.Connection(this, this, 0);\r\n        this.errorResponsibility = 0;\r\n        this.errorProjected = 0;\r\n        this.errorGated = 0;\r\n        this.index = NaN;\r\n    }\r\n    Node.fromJSON = function (json) {\r\n        var node = new Node();\r\n        node.bias = json.bias;\r\n        node.type = json.type;\r\n        node.squash = Activation_1.Activation.getActivation(json.squash);\r\n        node.mask = json.mask;\r\n        node.index = json.index;\r\n        return node;\r\n    };\r\n    Node.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            connection.eligibility = 0;\r\n            connection.xTraceNodes = [];\r\n            connection.xTraceValues = [];\r\n        }\r\n        for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n            var connection = _c[_b];\r\n            connection.gain = 0;\r\n        }\r\n        this.errorResponsibility = this.errorProjected = this.errorGated = 0;\r\n        this.old = this.state = this.activation = 0;\r\n    };\r\n    Node.prototype.mutateBias = function (method) {\r\n        this.bias += Utils_1.randDouble(method.min, method.max);\r\n    };\r\n    Node.prototype.mutateActivation = function () {\r\n        var newActivationType;\r\n        do {\r\n            newActivationType = Utils_1.pickRandom(Activation_1.ALL_ACTIVATIONS);\r\n        } while (newActivationType === this.squash.type);\r\n        this.squash = Activation_1.Activation.getActivation(newActivationType);\r\n    };\r\n    Node.prototype.isProjectedBy = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.incoming.map(function (conn) { return conn.from; }), node);\r\n        }\r\n    };\r\n    Node.prototype.isProjectingTo = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.outgoing.map(function (conn) { return conn.to; }), node);\r\n        }\r\n    };\r\n    Node.prototype.addGate = function (connection) {\r\n        this.gated.push(connection);\r\n        connection.gateNode = this;\r\n    };\r\n    Node.prototype.removeGate = function (connection) {\r\n        Utils_1.remove(this.gated, connection);\r\n        connection.gateNode = null;\r\n        connection.gain = 1;\r\n    };\r\n    Node.prototype.connect = function (target, weight, twoSided) {\r\n        if (weight === void 0) { weight = 0; }\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (target === this) {\r\n            this.selfConnection.weight = weight || 1;\r\n            return this.selfConnection;\r\n        }\r\n        else if (this.isProjectingTo(target)) {\r\n            throw new ReferenceError();\r\n        }\r\n        else {\r\n            var connection = new Connection_1.Connection(this, target, weight);\r\n            this.outgoing.push(connection);\r\n            target.incoming.push(connection);\r\n            if (twoSided) {\r\n                target.connect(this);\r\n            }\r\n            return connection;\r\n        }\r\n    };\r\n    Node.prototype.disconnect = function (node, twoSided) {\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (node === this) {\r\n            this.selfConnection.weight = 0;\r\n            return this.selfConnection;\r\n        }\r\n        for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            if (connection.to !== node) {\r\n                continue;\r\n            }\r\n            Utils_1.remove(this.outgoing, connection);\r\n            Utils_1.remove(connection.to.incoming, connection);\r\n            if (connection.gateNode !== undefined && connection.gateNode != null) {\r\n                connection.gateNode.removeGate(connection);\r\n            }\r\n            if (twoSided) {\r\n                node.disconnect(this);\r\n            }\r\n            return connection;\r\n        }\r\n        throw new Error(\"No connection found!\");\r\n    };\r\n    Node.prototype.propagate = function (target, momentum, rate, update) {\r\n        // TODO: check for errors\r\n        if (target !== undefined && Number.isFinite(target)) {\r\n            this.errorResponsibility = this.errorProjected = target - this.activation;\r\n        }\r\n        else {\r\n            this.errorProjected = 0;\r\n            for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                this.errorProjected += connection.to.errorResponsibility * connection.weight * connection.gain;\r\n            }\r\n            this.errorProjected *= this.derivative || 1;\r\n            this.errorGated = 0;\r\n            for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                var node = connection.to;\r\n                var influence = void 0;\r\n                if (node.selfConnection.gateNode === this) {\r\n                    influence = node.old + connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    influence = connection.weight * connection.from.activation;\r\n                }\r\n                this.errorGated += node.errorResponsibility * influence;\r\n            }\r\n            this.errorGated *= this.derivative || 1;\r\n            this.errorResponsibility = this.errorProjected + this.errorGated;\r\n        }\r\n        for (var _d = 0, _e = this.incoming; _d < _e.length; _d++) {\r\n            var connection = _e[_d];\r\n            var gradient = this.errorProjected * connection.eligibility;\r\n            for (var j = 0; j < connection.xTraceNodes.length; j++) {\r\n                var node = connection.xTraceNodes[j];\r\n                gradient += node.errorResponsibility * connection.xTraceValues[j];\r\n            }\r\n            connection.deltaWeightsTotal += rate * gradient * this.mask;\r\n            if (update) {\r\n                connection.deltaWeightsTotal += momentum * connection.deltaWeightsPrevious;\r\n                connection.weight += connection.deltaWeightsTotal;\r\n                connection.deltaWeightsPrevious = connection.deltaWeightsTotal;\r\n                connection.deltaWeightsTotal = 0;\r\n            }\r\n        }\r\n        this.deltaBiasTotal += rate * this.errorResponsibility;\r\n        if (update) {\r\n            this.deltaBiasTotal += momentum * this.deltaBiasPrevious;\r\n            this.bias += this.deltaBiasTotal;\r\n            this.deltaBiasPrevious = this.deltaBiasTotal;\r\n            this.deltaBiasTotal = 0;\r\n        }\r\n        return {\r\n            responsibility: this.errorResponsibility,\r\n            projected: this.errorProjected,\r\n            gated: this.errorGated,\r\n        };\r\n    };\r\n    Node.prototype.activate = function (input, trace) {\r\n        var _this = this;\r\n        if (input === void 0) { input = null; }\r\n        if (trace === void 0) { trace = true; }\r\n        // TODO: check for errors\r\n        if (input !== null && Number.isFinite(input)) {\r\n            return this.activation = input;\r\n        }\r\n        if (trace) {\r\n            this.old = this.state;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            this.incoming.forEach(function (conn) {\r\n                _this.state += conn.from.activation * conn.weight * conn.gain;\r\n            });\r\n            this.activation = this.squash.calc(this.state, false) * this.mask;\r\n            this.derivative = this.squash.calc(this.state, true);\r\n            var nodes_1 = [];\r\n            var influences_1 = [];\r\n            this.gated.forEach(function (connection) {\r\n                connection.gain = _this.activation;\r\n                var index = nodes_1.indexOf(connection.to);\r\n                if (index > -1) {\r\n                    influences_1[index] += connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    nodes_1.push(connection.to);\r\n                    if (connection.to.selfConnection.gateNode === _this) {\r\n                        influences_1.push(connection.weight * connection.from.activation + connection.to.old);\r\n                    }\r\n                    else {\r\n                        influences_1.push(connection.weight * connection.from.activation);\r\n                    }\r\n                }\r\n            });\r\n            for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                connection.eligibility = this.selfConnection.gain * this.selfConnection.weight * connection.eligibility + connection.from.activation * connection.gain;\r\n                for (var i = 0; i < nodes_1.length; i++) {\r\n                    var node = nodes_1[i];\r\n                    var influence = influences_1[i];\r\n                    var index = connection.xTraceNodes.indexOf(node);\r\n                    if (index > -1)\r\n                        connection.xTraceValues[index] = node.selfConnection.gain * node.selfConnection.weight * connection.xTraceValues[index] + this.derivative * connection.eligibility * influence;\r\n                    else {\r\n                        connection.xTraceNodes.push(node);\r\n                        connection.xTraceValues.push(this.derivative * connection.eligibility * influence);\r\n                    }\r\n                }\r\n            }\r\n            return this.activation;\r\n        }\r\n        else {\r\n            if (this.isInputNode())\r\n                return this.activation = 0;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            for (var _b = 0, _c = this.incoming; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                this.state += connection.from.activation * connection.weight * connection.gain;\r\n            }\r\n            this.activation = this.squash.calc(this.state, false);\r\n            for (var _d = 0, _e = this.gated; _d < _e.length; _d++) {\r\n                var connection = _e[_d];\r\n                connection.gain = this.activation;\r\n            }\r\n            return this.activation;\r\n        }\r\n    };\r\n    Node.prototype.toJSON = function () {\r\n        return {\r\n            bias: this.bias,\r\n            type: this.type,\r\n            squash: this.squash.type,\r\n            mask: this.mask,\r\n            index: this.index\r\n        };\r\n    };\r\n    Node.prototype.isInputNode = function () {\r\n        return this.type === NodeType.INPUT;\r\n    };\r\n    Node.prototype.isHiddenNode = function () {\r\n        return this.type === NodeType.HIDDEN;\r\n    };\r\n    Node.prototype.isOutputNode = function () {\r\n        return this.type === NodeType.OUTPUT;\r\n    };\r\n    return Node;\r\n}());\r\nexports.Node = Node;\r\nvar NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"INPUT\"] = 0] = \"INPUT\";\r\n    NodeType[NodeType[\"HIDDEN\"] = 1] = \"HIDDEN\";\r\n    NodeType[NodeType[\"OUTPUT\"] = 2] = \"OUTPUT\";\r\n})(NodeType = exports.NodeType || (exports.NodeType = {}));\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar Node_1 = require(\"../Node\");\r\nvar DenseLayer = /** @class */ (function (_super) {\r\n    __extends(DenseLayer, _super);\r\n    function DenseLayer(inputSize, outputSize) {\r\n        var _this = _super.call(this, inputSize, outputSize) || this;\r\n        for (var i = 0; i < inputSize; i++) {\r\n            _this.nodes.push(new Node_1.Node(Node_1.NodeType.INPUT));\r\n        }\r\n        for (var i = 0; i < outputSize; i++) {\r\n            _this.nodes.push(new Node_1.Node(Node_1.NodeType.INPUT));\r\n        }\r\n        _this.nodes\r\n            .filter(function (node) { return node.isInputNode(); })\r\n            .forEach(function (inputNode) {\r\n            _this.nodes\r\n                .filter(function (node) { return node.isOutputNode(); })\r\n                .forEach(function (outputNode) {\r\n                _this.connections.push(inputNode.connect(outputNode, 1));\r\n            });\r\n        });\r\n        return _this;\r\n    }\r\n    return DenseLayer;\r\n}(Layer_1.Layer));\r\nexports.DenseLayer = DenseLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar GaussianNoiseLayer = /** @class */ (function (_super) {\r\n    __extends(GaussianNoiseLayer, _super);\r\n    function GaussianNoiseLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return GaussianNoiseLayer;\r\n}(Layer_1.Layer));\r\nexports.GaussianNoiseLayer = GaussianNoiseLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar InputLayer = /** @class */ (function (_super) {\r\n    __extends(InputLayer, _super);\r\n    function InputLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return InputLayer;\r\n}(Layer_1.Layer));\r\nexports.InputLayer = InputLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar LSTMLayer = /** @class */ (function (_super) {\r\n    __extends(LSTMLayer, _super);\r\n    function LSTMLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n        // TODO: actually implement\r\n    }\r\n    return LSTMLayer;\r\n}(Layer_1.Layer));\r\nexports.LSTMLayer = LSTMLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar PoolLayer = /** @class */ (function (_super) {\r\n    __extends(PoolLayer, _super);\r\n    function PoolLayer(inputSize, outputSize, type) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n        // TODO: actually implement it\r\n    }\r\n    return PoolLayer;\r\n}(Layer_1.Layer));\r\nexports.PoolLayer = PoolLayer;\r\nvar PoolingType;\r\n(function (PoolingType) {\r\n    PoolingType[PoolingType[\"MaxPooling\"] = 0] = \"MaxPooling\";\r\n    PoolingType[PoolingType[\"AveragePooling\"] = 1] = \"AveragePooling\";\r\n    PoolingType[PoolingType[\"GlobalPooling\"] = 2] = \"GlobalPooling\";\r\n})(PoolingType = exports.PoolingType || (exports.PoolingType = {}));\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar RNNLayer = /** @class */ (function (_super) {\r\n    __extends(RNNLayer, _super);\r\n    function RNNLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return RNNLayer;\r\n}(Layer_1.Layer));\r\nexports.RNNLayer = RNNLayer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Architect = /** @class */ (function () {\r\n    function Architect() {\r\n        this.layers = [];\r\n    }\r\n    Architect.prototype.addLayer = function (layer) {\r\n        if (this.layers[this.layers.length - 1].outputSize !== layer.inputSize) {\r\n            throw new RangeError(\"Output size of last layer is unequal input size of this layer! \" + this.layers[this.layers.length - 1].outputSize + \" -> \" + layer.inputSize);\r\n        }\r\n        this.layers.push(layer);\r\n        return this;\r\n    };\r\n    return Architect;\r\n}());\r\nexports.Architect = Architect;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Node_1 = require(\"../architecture/Node\");\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Mutation = /** @class */ (function () {\r\n    function Mutation() {\r\n    }\r\n    return Mutation;\r\n}());\r\nexports.Mutation = Mutation;\r\nvar AddNodeMutation = /** @class */ (function (_super) {\r\n    __extends(AddNodeMutation, _super);\r\n    function AddNodeMutation(randomActivation) {\r\n        if (randomActivation === void 0) { randomActivation = true; }\r\n        var _this = _super.call(this) || this;\r\n        _this.randomActivation = randomActivation;\r\n        return _this;\r\n    }\r\n    AddNodeMutation.prototype.mutate = function (genome, maxNodes) {\r\n        if (maxNodes !== undefined && genome.nodes.length >= maxNodes) {\r\n            return;\r\n        }\r\n        var node = new Node_1.Node(Node_1.NodeType.HIDDEN);\r\n        if (this.randomActivation) {\r\n            node.mutateActivation();\r\n        }\r\n        var connection = Utils_1.pickRandom(genome.connections);\r\n        var from = connection.from;\r\n        var to = connection.to;\r\n        genome.disconnect(from, to);\r\n        var minBound = Math.max(genome.inputSize, 1 + genome.nodes.indexOf(from));\r\n        genome.nodes.splice(minBound, 0, node);\r\n        var newConnection1 = genome.connect(from, node, 1);\r\n        var newConnection2 = genome.connect(node, to, connection.weight);\r\n        if (connection.gateNode != null) {\r\n            if (Utils_1.randBoolean()) {\r\n                genome.addGate(connection.gateNode, newConnection1);\r\n            }\r\n            else {\r\n                genome.addGate(connection.gateNode, newConnection2);\r\n            }\r\n        }\r\n    };\r\n    return AddNodeMutation;\r\n}(Mutation));\r\nexports.AddNodeMutation = AddNodeMutation;\r\nvar SubNodeMutation = /** @class */ (function (_super) {\r\n    __extends(SubNodeMutation, _super);\r\n    function SubNodeMutation(keepGates) {\r\n        if (keepGates === void 0) { keepGates = true; }\r\n        var _this = _super.call(this) || this;\r\n        _this.keepGates = keepGates;\r\n        return _this;\r\n    }\r\n    SubNodeMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.nodes.filter(function (node) { return node !== undefined && node.isHiddenNode(); });\r\n        if (possible.length > 0) {\r\n            var node = Utils_1.pickRandom(possible);\r\n            genome.removeNode(node);\r\n        }\r\n    };\r\n    return SubNodeMutation;\r\n}(Mutation));\r\nexports.SubNodeMutation = SubNodeMutation;\r\nvar AddConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(AddConnectionMutation, _super);\r\n    function AddConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddConnectionMutation.prototype.mutate = function (genome, maxConnections) {\r\n        if (maxConnections !== undefined && maxConnections <= genome.connections.length) {\r\n            return;\r\n        }\r\n        var possible = [];\r\n        for (var i = 0; i < genome.nodes.length - genome.outputSize; i++) {\r\n            var from = genome.nodes[i];\r\n            for (var j = Math.max(i + 1, genome.inputSize); j < genome.nodes.length; j++) {\r\n                var to = genome.nodes[j];\r\n                if (!from.isProjectingTo(to)) {\r\n                    possible.push([from, to]);\r\n                }\r\n            }\r\n        }\r\n        if (possible.length > 0) {\r\n            var pair = Utils_1.pickRandom(possible);\r\n            genome.connect(pair[0], pair[1]);\r\n        }\r\n    };\r\n    return AddConnectionMutation;\r\n}(Mutation));\r\nexports.AddConnectionMutation = AddConnectionMutation;\r\nvar SubConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(SubConnectionMutation, _super);\r\n    function SubConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.connections.filter(function (conn) { return conn.from.outgoing.length > 1 && conn.to.incoming.length > 1 && genome.nodes.indexOf(conn.to) > genome.nodes.indexOf(conn.from); });\r\n        if (possible.length > 0) {\r\n            var randomConnection = Utils_1.pickRandom(possible);\r\n            genome.disconnect(randomConnection.from, randomConnection.to);\r\n        }\r\n    };\r\n    return SubConnectionMutation;\r\n}(Mutation));\r\nexports.SubConnectionMutation = SubConnectionMutation;\r\nvar ModWeightMutation = /** @class */ (function (_super) {\r\n    __extends(ModWeightMutation, _super);\r\n    function ModWeightMutation(min, max) {\r\n        if (min === void 0) { min = -1; }\r\n        if (max === void 0) { max = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this.min = min;\r\n        _this.max = max;\r\n        return _this;\r\n    }\r\n    ModWeightMutation.prototype.mutate = function (genome) {\r\n        Utils_1.pickRandom(genome.connections).weight += Utils_1.randDouble(this.min, this.max);\r\n    };\r\n    return ModWeightMutation;\r\n}(Mutation));\r\nexports.ModWeightMutation = ModWeightMutation;\r\nvar ModBiasMutation = /** @class */ (function (_super) {\r\n    __extends(ModBiasMutation, _super);\r\n    function ModBiasMutation(min, max) {\r\n        if (min === void 0) { min = -1; }\r\n        if (max === void 0) { max = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this.min = min;\r\n        _this.max = max;\r\n        return _this;\r\n    }\r\n    ModBiasMutation.prototype.mutate = function (genome) {\r\n        Utils_1.pickRandom(genome.nodes.filter(function (node) { return !node.isInputNode(); }))\r\n            .mutateBias(this);\r\n    };\r\n    return ModBiasMutation;\r\n}(Mutation));\r\nexports.ModBiasMutation = ModBiasMutation;\r\nvar ModActivationMutation = /** @class */ (function (_super) {\r\n    __extends(ModActivationMutation, _super);\r\n    function ModActivationMutation(mutateOutput) {\r\n        if (mutateOutput === void 0) { mutateOutput = false; }\r\n        var _this = _super.call(this) || this;\r\n        _this.mutateOutput = mutateOutput;\r\n        return _this;\r\n    }\r\n    ModActivationMutation.prototype.mutate = function (genome, max) {\r\n        var possible = this.mutateOutput\r\n            ? genome.nodes.filter(function (node) { return !node.isInputNode(); })\r\n            : genome.nodes.filter(function (node) { return node.isHiddenNode(); });\r\n        if (possible.length > 0) {\r\n            Utils_1.pickRandom(possible).mutateActivation();\r\n        }\r\n    };\r\n    return ModActivationMutation;\r\n}(Mutation));\r\nexports.ModActivationMutation = ModActivationMutation;\r\nvar AddSelfConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(AddSelfConnectionMutation, _super);\r\n    function AddSelfConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddSelfConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.nodes\r\n            .filter(function (node) { return !node.isInputNode(); })\r\n            .filter(function (node) { return node.selfConnection.weight === 0; });\r\n        if (possible.length > 0) {\r\n            var node = Utils_1.pickRandom(possible);\r\n            genome.connect(node, node);\r\n        }\r\n    };\r\n    return AddSelfConnectionMutation;\r\n}(Mutation));\r\nexports.AddSelfConnectionMutation = AddSelfConnectionMutation;\r\nvar SubSelfConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(SubSelfConnectionMutation, _super);\r\n    function SubSelfConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubSelfConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.connections.filter(function (conn) { return conn.from === conn.to; });\r\n        if (possible.length > 0) {\r\n            var randomConnection = Utils_1.pickRandom(possible);\r\n            genome.disconnect(randomConnection.from, randomConnection.to);\r\n        }\r\n    };\r\n    return SubSelfConnectionMutation;\r\n}(Mutation));\r\nexports.SubSelfConnectionMutation = SubSelfConnectionMutation;\r\nvar AddGateMutation = /** @class */ (function (_super) {\r\n    __extends(AddGateMutation, _super);\r\n    function AddGateMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddGateMutation.prototype.mutate = function (genome, maxGates) {\r\n        if (maxGates !== undefined && maxGates <= genome.gates.length) {\r\n            return;\r\n        }\r\n        var possible = genome.connections.filter(function (conn) { return conn.gateNode === null; });\r\n        if (possible.length > 0) {\r\n            var node = Utils_1.pickRandom(genome.nodes.filter(function (node) { return !node.isInputNode(); }));\r\n            var connection = Utils_1.pickRandom(possible);\r\n            genome.addGate(node, connection);\r\n        }\r\n    };\r\n    return AddGateMutation;\r\n}(Mutation));\r\nexports.AddGateMutation = AddGateMutation;\r\nvar SubGateMutation = /** @class */ (function (_super) {\r\n    __extends(SubGateMutation, _super);\r\n    function SubGateMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubGateMutation.prototype.mutate = function (genome) {\r\n        if (genome.gates.length > 0) {\r\n            genome.removeGate(Utils_1.pickRandom(genome.gates));\r\n        }\r\n    };\r\n    return SubGateMutation;\r\n}(Mutation));\r\nexports.SubGateMutation = SubGateMutation;\r\nvar AddBackConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(AddBackConnectionMutation, _super);\r\n    function AddBackConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddBackConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = [];\r\n        for (var i = genome.inputSize; i < genome.nodes.length; i++) {\r\n            var from = genome.nodes[i];\r\n            for (var j = genome.inputSize; j < i; j++) {\r\n                var to = genome.nodes[j];\r\n                if (!from.isProjectingTo(to)) {\r\n                    possible.push([from, to]);\r\n                }\r\n            }\r\n        }\r\n        if (possible.length > 0) {\r\n            var pair = Utils_1.pickRandom(possible);\r\n            genome.connect(pair[0], pair[1]);\r\n        }\r\n    };\r\n    return AddBackConnectionMutation;\r\n}(Mutation));\r\nexports.AddBackConnectionMutation = AddBackConnectionMutation;\r\nvar SubBackConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(SubBackConnectionMutation, _super);\r\n    function SubBackConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubBackConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.connections\r\n            .filter(function (conn) { return conn.from.outgoing.length > 1; })\r\n            .filter(function (conn) { return conn.to.incoming.length > 1; })\r\n            .filter(function (conn) { return genome.nodes.indexOf(conn.from) > genome.nodes.indexOf(conn.to); });\r\n        if (possible.length > 0) {\r\n            var randomConnection = Utils_1.pickRandom(possible);\r\n            genome.disconnect(randomConnection.from, randomConnection.to);\r\n        }\r\n    };\r\n    return SubBackConnectionMutation;\r\n}(Mutation));\r\nexports.SubBackConnectionMutation = SubBackConnectionMutation;\r\nvar SwapNodesMutation = /** @class */ (function (_super) {\r\n    __extends(SwapNodesMutation, _super);\r\n    function SwapNodesMutation(mutateOutput) {\r\n        if (mutateOutput === void 0) { mutateOutput = false; }\r\n        var _this = _super.call(this) || this;\r\n        _this.mutateOutput = mutateOutput;\r\n        return _this;\r\n    }\r\n    SwapNodesMutation.prototype.mutate = function (genome) {\r\n        var possible = this.mutateOutput\r\n            ? genome.nodes.filter(function (node) { return node !== undefined && !node.isInputNode(); })\r\n            : genome.nodes.filter(function (node) { return node !== undefined && node.isHiddenNode(); });\r\n        if (possible.length >= 2) {\r\n            var node1_1 = Utils_1.pickRandom(possible);\r\n            var node2 = Utils_1.pickRandom(possible.filter(function (node) { return node !== node1_1; }));\r\n            var biasTemp = node1_1.bias;\r\n            var squashTemp = node1_1.squash;\r\n            node1_1.bias = node2.bias;\r\n            node1_1.squash = node2.squash;\r\n            node2.bias = biasTemp;\r\n            node2.squash = squashTemp;\r\n        }\r\n    };\r\n    return SwapNodesMutation;\r\n}(Mutation));\r\nexports.SwapNodesMutation = SwapNodesMutation;\r\nexports.ALL_MUTATIONS = [\r\n    new AddNodeMutation(),\r\n    new SubNodeMutation(),\r\n    new AddConnectionMutation(),\r\n    new SubConnectionMutation(),\r\n    new ModWeightMutation(),\r\n    new ModBiasMutation(),\r\n    new ModActivationMutation(),\r\n    new AddGateMutation(),\r\n    new SubGateMutation(),\r\n    new AddSelfConnectionMutation(),\r\n    new SubSelfConnectionMutation(),\r\n    new AddBackConnectionMutation(),\r\n    new SubBackConnectionMutation(),\r\n    new SwapNodesMutation(),\r\n];\r\nexports.FEEDFORWARD_MUTATIONS = [\r\n    new AddNodeMutation(),\r\n    new SubNodeMutation(),\r\n    new AddConnectionMutation(),\r\n    new SubConnectionMutation(),\r\n    new ModWeightMutation(),\r\n    new ModBiasMutation(),\r\n    new ModActivationMutation(),\r\n    new SwapNodesMutation(),\r\n];\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Loss = /** @class */ (function () {\r\n    function Loss() {\r\n    }\r\n    return Loss;\r\n}());\r\nexports.Loss = Loss;\r\nvar CrossEntropyLoss = /** @class */ (function (_super) {\r\n    __extends(CrossEntropyLoss, _super);\r\n    function CrossEntropyLoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CrossEntropyLoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error -= targets[index] * Math.log(Math.max(value, 1e-15)) + (1 - targets[index]) * Math.log(1 - Math.max(value, 1e-15));\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return CrossEntropyLoss;\r\n}(Loss));\r\nexports.CrossEntropyLoss = CrossEntropyLoss;\r\nvar MSELoss = /** @class */ (function (_super) {\r\n    __extends(MSELoss, _super);\r\n    function MSELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MSELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.pow(targets[index] - value, 2);\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MSELoss;\r\n}(Loss));\r\nexports.MSELoss = MSELoss;\r\nvar BinaryLoss = /** @class */ (function (_super) {\r\n    __extends(BinaryLoss, _super);\r\n    function BinaryLoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BinaryLoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.round(targets[index] * 2) !== Math.round(value * 2) ? 1 : 0;\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return BinaryLoss;\r\n}(Loss));\r\nexports.BinaryLoss = BinaryLoss;\r\nvar MAELoss = /** @class */ (function (_super) {\r\n    __extends(MAELoss, _super);\r\n    function MAELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MAELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.abs(targets[index] - value);\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MAELoss;\r\n}(Loss));\r\nexports.MAELoss = MAELoss;\r\nvar MAPELoss = /** @class */ (function (_super) {\r\n    __extends(MAPELoss, _super);\r\n    function MAPELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MAPELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.abs((value - targets[index]) / Math.max(targets[index], 1e-15));\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MAPELoss;\r\n}(Loss));\r\nexports.MAPELoss = MAPELoss;\r\nvar WAPELoss = /** @class */ (function (_super) {\r\n    __extends(WAPELoss, _super);\r\n    function WAPELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WAPELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        var sum = 0;\r\n        for (var i = 0; i < outputs.length; i++) {\r\n            error += Math.abs(targets[i] - outputs[i]);\r\n            sum += targets[i];\r\n        }\r\n        return error / sum;\r\n    };\r\n    return WAPELoss;\r\n}(Loss));\r\nexports.WAPELoss = WAPELoss;\r\nvar MSLELoss = /** @class */ (function (_super) {\r\n    __extends(MSLELoss, _super);\r\n    function MSLELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MSLELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.log(Math.max(targets[index], 1e-15)) - Math.log(Math.max(value, 1e-15));\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MSLELoss;\r\n}(Loss));\r\nexports.MSLELoss = MSLELoss;\r\nvar HINGELoss = /** @class */ (function (_super) {\r\n    __extends(HINGELoss, _super);\r\n    function HINGELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    HINGELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach(function (value, index) {\r\n            error += Math.max(0, 1 - value * targets[index]);\r\n        });\r\n        return error / outputs.length;\r\n    };\r\n    return HINGELoss;\r\n}(Loss));\r\nexports.HINGELoss = HINGELoss;\r\nexports.ALL_LOSSES = [\r\n    new CrossEntropyLoss(),\r\n    new MSELoss(),\r\n    new BinaryLoss(),\r\n    new MAELoss(),\r\n    new MAPELoss(),\r\n    new WAPELoss(),\r\n    new MSLELoss(),\r\n    new HINGELoss()\r\n];\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Rate = /** @class */ (function () {\r\n    function Rate(baseRate) {\r\n        this.baseRate = baseRate;\r\n    }\r\n    return Rate;\r\n}());\r\nexports.Rate = Rate;\r\nvar FixedRate = /** @class */ (function (_super) {\r\n    __extends(FixedRate, _super);\r\n    function FixedRate() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FixedRate.prototype.calc = function (iteration) {\r\n        return this.baseRate;\r\n    };\r\n    return FixedRate;\r\n}(Rate));\r\nexports.FixedRate = FixedRate;\r\nvar StepRate = /** @class */ (function (_super) {\r\n    __extends(StepRate, _super);\r\n    function StepRate(baseRate, gamma, stepSize) {\r\n        if (gamma === void 0) { gamma = 0.9; }\r\n        if (stepSize === void 0) { stepSize = 100; }\r\n        var _this = _super.call(this, baseRate) || this;\r\n        _this.gamma = gamma;\r\n        _this.stepSize = stepSize;\r\n        return _this;\r\n    }\r\n    StepRate.prototype.calc = function (iteration) {\r\n        return this.baseRate * Math.pow(this.gamma, Math.floor(iteration / this.stepSize));\r\n    };\r\n    return StepRate;\r\n}(Rate));\r\nexports.StepRate = StepRate;\r\nvar ExponentialRate = /** @class */ (function (_super) {\r\n    __extends(ExponentialRate, _super);\r\n    function ExponentialRate(baseRate, gamma) {\r\n        if (gamma === void 0) { gamma = 0.999; }\r\n        var _this = _super.call(this, baseRate) || this;\r\n        _this.gamma = gamma;\r\n        return _this;\r\n    }\r\n    ExponentialRate.prototype.calc = function (iteration) {\r\n        return this.baseRate * Math.pow(this.gamma, iteration);\r\n    };\r\n    return ExponentialRate;\r\n}(Rate));\r\nexports.ExponentialRate = ExponentialRate;\r\nvar InverseRate = /** @class */ (function (_super) {\r\n    __extends(InverseRate, _super);\r\n    function InverseRate(baseRate, gamma, power) {\r\n        if (gamma === void 0) { gamma = 0.001; }\r\n        if (power === void 0) { power = 2; }\r\n        var _this = _super.call(this, baseRate) || this;\r\n        _this.gamma = gamma;\r\n        _this.power = power;\r\n        return _this;\r\n    }\r\n    InverseRate.prototype.calc = function (iteration) {\r\n        return this.baseRate * Math.pow(1 + this.gamma * iteration, -this.power);\r\n    };\r\n    return InverseRate;\r\n}(Rate));\r\nexports.InverseRate = InverseRate;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Selection = /** @class */ (function () {\r\n    function Selection() {\r\n    }\r\n    return Selection;\r\n}());\r\nexports.Selection = Selection;\r\nvar FitnessProportionateSelection = /** @class */ (function (_super) {\r\n    __extends(FitnessProportionateSelection, _super);\r\n    function FitnessProportionateSelection() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FitnessProportionateSelection.prototype.select = function (population) {\r\n        var _a;\r\n        var totalFitness = 0;\r\n        var minimalFitness = 0;\r\n        for (var _i = 0, population_1 = population; _i < population_1.length; _i++) {\r\n            var genome = population_1[_i];\r\n            var score = genome.score;\r\n            minimalFitness = score !== undefined && score < minimalFitness ? score : minimalFitness;\r\n            totalFitness += score !== null && score !== void 0 ? score : 0;\r\n        }\r\n        minimalFitness = Math.abs(minimalFitness);\r\n        totalFitness += minimalFitness * population.length;\r\n        var random = Utils_1.randDouble(0, totalFitness);\r\n        var value = 0;\r\n        for (var _b = 0, population_2 = population; _b < population_2.length; _b++) {\r\n            var genome = population_2[_b];\r\n            value += ((_a = genome.score) !== null && _a !== void 0 ? _a : 0) + minimalFitness;\r\n            if (random < value) {\r\n                return genome;\r\n            }\r\n        }\r\n        return Utils_1.pickRandom(population);\r\n    };\r\n    return FitnessProportionateSelection;\r\n}(Selection));\r\nexports.FitnessProportionateSelection = FitnessProportionateSelection;\r\nvar PowerSelection = /** @class */ (function (_super) {\r\n    __extends(PowerSelection, _super);\r\n    function PowerSelection(power) {\r\n        if (power === void 0) { power = 4; }\r\n        var _this = _super.call(this) || this;\r\n        _this.power = power;\r\n        return _this;\r\n    }\r\n    PowerSelection.prototype.select = function (population) {\r\n        return population[Math.floor(Math.pow(Math.random(), this.power) * population.length)];\r\n    };\r\n    return PowerSelection;\r\n}(Selection));\r\nexports.PowerSelection = PowerSelection;\r\nvar TournamentSelection = /** @class */ (function (_super) {\r\n    __extends(TournamentSelection, _super);\r\n    function TournamentSelection(size, probability) {\r\n        if (size === void 0) { size = 5; }\r\n        if (probability === void 0) { probability = 0.5; }\r\n        var _this = _super.call(this) || this;\r\n        _this.size = size;\r\n        _this.probability = probability;\r\n        return _this;\r\n    }\r\n    TournamentSelection.prototype.select = function (population) {\r\n        if (this.size > population.length) {\r\n            throw new Error(\"Your tournament size should be lower than the population size, please change methods.selection.TOURNAMENT.size\");\r\n        }\r\n        // Create a tournament\r\n        var individuals = [];\r\n        for (var i = 0; i < this.size; i++) {\r\n            individuals.push(Utils_1.pickRandom(population));\r\n        }\r\n        // Sort the tournament individuals by score\r\n        individuals.sort(function (a, b) {\r\n            return b.score === undefined || a.score === undefined ? 0 : b.score - a.score;\r\n        });\r\n        // Select an individual\r\n        for (var i = 0; i < this.size; i++) {\r\n            if (Math.random() < this.probability || i === this.size - 1) {\r\n                return individuals[i];\r\n            }\r\n        }\r\n        return Utils_1.pickRandom(population);\r\n    };\r\n    return TournamentSelection;\r\n}(Selection));\r\nexports.TournamentSelection = TournamentSelection;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Network_1 = require(\"./architecture/Network\");\r\nvar Utils_1 = require(\"./methods/Utils\");\r\nvar Selection_1 = require(\"./methods/Selection\");\r\nvar Mutation_1 = require(\"./methods/Mutation\");\r\nvar NEAT = /** @class */ (function () {\r\n    function NEAT(dataset, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.dataset = dataset;\r\n        this.generation = Utils_1.getOrDefault(options.generation, 0);\r\n        this.input = Utils_1.getOrDefault(options.input, 1);\r\n        this.output = Utils_1.getOrDefault(options.output, 1);\r\n        this.equal = Utils_1.getOrDefault(options.equal, true);\r\n        this.clear = Utils_1.getOrDefault(options.clear, false);\r\n        this.populationSize = Utils_1.getOrDefault(options.populationSize, 50);\r\n        this.elitism = Utils_1.getOrDefault(options.elitism, 1);\r\n        this.provenance = Utils_1.getOrDefault(options.provenance, 0);\r\n        this.mutationRate = Utils_1.getOrDefault(options.mutationRate, 0.4);\r\n        this.mutationAmount = Utils_1.getOrDefault(options.mutationAmount, 1);\r\n        this.fitnessPopulation = Utils_1.getOrDefault(options.fitnessPopulation, false);\r\n        this.fitnessFunction = options.fitnessFunction;\r\n        this.selection = Utils_1.getOrDefault(options.selection, new Selection_1.PowerSelection());\r\n        this.mutations = Utils_1.getOrDefault(options.mutations, Mutation_1.FEEDFORWARD_MUTATIONS);\r\n        this.template = Utils_1.getOrDefault(options.template, new Network_1.Network(this.input, this.output));\r\n        this.maxNodes = Utils_1.getOrDefault(options.maxNodes, Infinity);\r\n        this.maxConnections = Utils_1.getOrDefault(options.maxConnections, Infinity);\r\n        this.maxGates = Utils_1.getOrDefault(options.maxGates, Infinity);\r\n        this.population = [];\r\n        this.createInitialPopulation();\r\n    }\r\n    NEAT.prototype.filterGenome = function (population, template, pickGenome, adjustGenome) {\r\n        var filtered = __spreadArrays(population); // avoid mutations\r\n        if (adjustGenome) {\r\n            filtered\r\n                .filter(function (genome) { return pickGenome(genome); })\r\n                .forEach(function (genome, index) { return filtered[index] = adjustGenome(filtered[index]); });\r\n        }\r\n        else {\r\n            filtered\r\n                .filter(function (genome) { return pickGenome(genome); })\r\n                .forEach(function (genome, index) { return filtered[index] = template.copy(); });\r\n        }\r\n        return filtered;\r\n    };\r\n    NEAT.prototype.mutateRandom = function (genome, possible) {\r\n        if (possible === void 0) { possible = this.mutations; }\r\n        var maxNodes = this.maxNodes;\r\n        var maxConnections = this.maxConnections;\r\n        var maxGates = this.maxGates;\r\n        possible = possible.filter(function (method) {\r\n            return (method.constructor.name !== Mutation_1.AddNodeMutation.constructor.name || genome.nodes.length < maxNodes ||\r\n                method.constructor.name !== Mutation_1.AddConnectionMutation.constructor.name || genome.connections.length < maxConnections ||\r\n                method.constructor.name !== Mutation_1.AddGateMutation.constructor.name || genome.gates.length < maxGates);\r\n        });\r\n        genome.mutate(Utils_1.pickRandom(possible));\r\n    };\r\n    NEAT.prototype.evolve = function (pickGenome, adjustGenome) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var elitists, i, newPopulation, i, fittest;\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        // Check if evolve is possible\r\n                        if (this.elitism + this.provenance > this.populationSize) {\r\n                            throw new Error(\"Can`t evolve! Elitism + provenance exceeds population size!\");\r\n                        }\r\n                        if (!(this.population[this.population.length - 1].score === undefined)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (pickGenome) {\r\n                            this.population = this.filterGenome(this.population, this.template, pickGenome, adjustGenome);\r\n                        }\r\n                        // Sort in order of fitness (fittest first)\r\n                        this.sort();\r\n                        elitists = [];\r\n                        for (i = 0; i < this.elitism; i++) {\r\n                            elitists.push(this.population[i]);\r\n                        }\r\n                        newPopulation = Array(this.provenance).fill(this.template.copy());\r\n                        // Breed the next individuals\r\n                        for (i = 0; i < this.populationSize - this.elitism - this.provenance; i++) {\r\n                            newPopulation.push(this.getOffspring());\r\n                        }\r\n                        // Replace the old population with the new population\r\n                        this.population = newPopulation;\r\n                        // Mutate the new population\r\n                        this.mutate(undefined);\r\n                        // Add the elitists\r\n                        (_a = this.population).push.apply(_a, elitists);\r\n                        // evaluate the population\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 3:\r\n                        // evaluate the population\r\n                        _b.sent();\r\n                        // Check & adjust genomes as needed\r\n                        if (pickGenome) {\r\n                            this.population = this.filterGenome(this.population, this.template, pickGenome, adjustGenome);\r\n                        }\r\n                        // Sort in order of fitness (fittest first)\r\n                        this.sort();\r\n                        fittest = this.population[0].copy();\r\n                        fittest.score = this.population[0].score;\r\n                        // Reset the scores\r\n                        this.population.forEach(function (genome) { return genome.score = undefined; });\r\n                        this.generation++;\r\n                        return [2 /*return*/, fittest];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.getOffspring = function () {\r\n        this.sort();\r\n        var parent1 = this.selection.select(this.population);\r\n        var parent2 = this.selection.select(this.population);\r\n        if (parent1 === null || parent2 === null) {\r\n            throw new ReferenceError(\"Should not be null!\");\r\n        }\r\n        return Network_1.Network.crossOver(parent1, parent2, this.equal);\r\n    };\r\n    NEAT.prototype.mutate = function (method) {\r\n        var _this = this;\r\n        if (method) {\r\n            // Elitist genomes should not be included\r\n            this.population\r\n                .filter(function () { return Math.random() <= _this.mutationRate; })\r\n                .forEach(function (genome) {\r\n                for (var i = 0; i < _this.mutationAmount; i++) {\r\n                    genome.mutate(method);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            // Elitist genomes should not be included\r\n            this.population\r\n                .filter(function () { return Math.random() <= _this.mutationRate; })\r\n                .forEach(function (genome) {\r\n                for (var i = 0; i < _this.mutationAmount; i++) {\r\n                    _this.mutateRandom(genome, _this.mutations);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    NEAT.prototype.evaluate = function (dataset) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, genome;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.fitnessPopulation) return [3 /*break*/, 3];\r\n                        if (this.clear) {\r\n                            this.population.forEach(function (genome) { return genome.clear(); });\r\n                        }\r\n                        if (!this.fitnessFunction) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.fitnessFunction(dataset, this.population)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        _b.label = 2;\r\n                    case 2: return [3 /*break*/, 7];\r\n                    case 3:\r\n                        _i = 0, _a = this.population;\r\n                        _b.label = 4;\r\n                    case 4:\r\n                        if (!(_i < _a.length)) return [3 /*break*/, 7];\r\n                        genome = _a[_i];\r\n                        if (this.clear) {\r\n                            genome.clear();\r\n                        }\r\n                        if (!this.fitnessFunction) return [3 /*break*/, 6];\r\n                        return [4 /*yield*/, this.fitnessFunction(dataset, genome)];\r\n                    case 5:\r\n                        _b.sent();\r\n                        _b.label = 6;\r\n                    case 6:\r\n                        _i++;\r\n                        return [3 /*break*/, 4];\r\n                    case 7:\r\n                        // Sort the population in order of fitness\r\n                        this.sort();\r\n                        return [2 /*return*/, this.population[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.sort = function () {\r\n        this.population.sort(function (a, b) {\r\n            return a.score === undefined || b.score === undefined ? 0 : b.score - a.score;\r\n        });\r\n    };\r\n    NEAT.prototype.getFittest = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.population[this.population.length - 1].score === undefined)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        this.sort();\r\n                        return [2 /*return*/, this.population[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.getAverage = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var score;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.population[this.population.length - 1].score === undefined)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        score = 0;\r\n                        this.population\r\n                            .map(function (genome) { return genome.score; })\r\n                            .forEach(function (val) { return score += val !== null && val !== void 0 ? val : 0; });\r\n                        return [2 /*return*/, score / this.population.length];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.createInitialPopulation = function () {\r\n        for (var i = 0; i < this.populationSize; i++) {\r\n            this.population.push(this.template.copy());\r\n        }\r\n    };\r\n    return NEAT;\r\n}());\r\nexports.NEAT = NEAT;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Connection_1 = require(\"./Connection\");\r\nvar Node_1 = require(\"./Node\");\r\nvar Utils_1 = require(\"../methods/Utils\");\r\nvar Mutation_1 = require(\"../methods/Mutation\");\r\nvar Loss_1 = require(\"../methods/Loss\");\r\nvar Rate_1 = require(\"../methods/Rate\");\r\nvar NEAT_1 = require(\"../NEAT\");\r\nvar Network = /** @class */ (function () {\r\n    function Network(inputSize, outputSize) {\r\n        this.inputSize = inputSize;\r\n        this.outputSize = outputSize;\r\n        this.nodes = [];\r\n        this.connections = [];\r\n        this.gates = [];\r\n        this.score = undefined;\r\n        for (var i = 0; i < inputSize; i++) {\r\n            this.nodes.push(new Node_1.Node(Node_1.NodeType.INPUT));\r\n        }\r\n        for (var i = 0; i < outputSize; i++) {\r\n            this.nodes.push(new Node_1.Node(Node_1.NodeType.OUTPUT));\r\n        }\r\n        for (var i = 0; i < this.inputSize; i++) {\r\n            for (var j = this.inputSize; j < this.outputSize + this.inputSize; j++) {\r\n                var weight = (Math.random() - 0.5) * this.inputSize * Math.sqrt(2 / this.inputSize);\r\n                this.connect(this.nodes[i], this.nodes[j], weight);\r\n            }\r\n        }\r\n    }\r\n    Network.fromJSON = function (json) {\r\n        var network = new Network(json.inputSize, json.outputSize);\r\n        network.nodes = [];\r\n        network.connections = [];\r\n        json.nodes.map(function (nodeJSON) { return Node_1.Node.fromJSON(nodeJSON); }).forEach(function (node) { return network.nodes[node.index] = node; });\r\n        json.connections.forEach(function (jsonConnection) {\r\n            var connection = network.connect(network.nodes[jsonConnection.fromIndex], network.nodes[jsonConnection.toIndex], jsonConnection.weight);\r\n            if (jsonConnection.gateNodeIndex != null) {\r\n                network.addGate(network.nodes[jsonConnection.gateNodeIndex], connection);\r\n            }\r\n        });\r\n        return network;\r\n    };\r\n    Network.crossOver = function (network1, network2, equal) {\r\n        if (network1.inputSize !== network2.inputSize || network1.outputSize !== network2.outputSize) {\r\n            throw new Error(\"Networks don`t have the same input/output size!\");\r\n        }\r\n        // Initialise offspring\r\n        var offspring = new Network(network1.inputSize, network1.outputSize);\r\n        offspring.connections = [];\r\n        offspring.nodes = [];\r\n        // Save scores and create a copy\r\n        var score1 = network1.score || 0;\r\n        var score2 = network2.score || 0;\r\n        // Determine offspring node size\r\n        var offspringSize;\r\n        if (equal || score1 === score2) {\r\n            var max = Math.max(network1.nodes.length, network2.nodes.length);\r\n            var min = Math.min(network1.nodes.length, network2.nodes.length);\r\n            offspringSize = Utils_1.randInt(min, max + 1);\r\n        }\r\n        else if (score1 > score2) {\r\n            offspringSize = network1.nodes.length;\r\n        }\r\n        else {\r\n            offspringSize = network2.nodes.length;\r\n        }\r\n        var inputSize = network1.inputSize;\r\n        var outputSize = network1.outputSize;\r\n        for (var i = 0; i < network1.nodes.length; i++) {\r\n            network1.nodes[i].index = i;\r\n        }\r\n        for (var i = 0; i < network2.nodes.length; i++) {\r\n            network2.nodes[i].index = i;\r\n        }\r\n        // Assign nodes from parents to offspring\r\n        for (var i = 0; i < offspringSize; i++) {\r\n            var chosenNode = void 0;\r\n            var chosenNodeType = null;\r\n            if (i < inputSize) {\r\n                chosenNodeType = Node_1.NodeType.INPUT;\r\n                var sourceNetwork = Utils_1.randBoolean() ? network1 : network2;\r\n                var inputNumber = -1;\r\n                var j = -1;\r\n                while (inputNumber < i) {\r\n                    j++;\r\n                    if (j >= sourceNetwork.nodes.length) {\r\n                        // something is wrong...\r\n                        throw RangeError('something is wrong with the size of the input');\r\n                    }\r\n                    if (sourceNetwork.nodes[j].isInputNode()) {\r\n                        inputNumber++;\r\n                    }\r\n                }\r\n                chosenNode = sourceNetwork.nodes[j];\r\n            }\r\n            else if (i < inputSize + outputSize) { // now select output nodes\r\n                chosenNodeType = Node_1.NodeType.OUTPUT;\r\n                var sourceNetwork = Utils_1.randBoolean() ? network1 : network2;\r\n                var outputNumber = -1;\r\n                var j = -1;\r\n                while (outputNumber < i - inputSize) {\r\n                    j++;\r\n                    if (j >= sourceNetwork.nodes.length) {\r\n                        throw RangeError('something is wrong with the size of the output');\r\n                    }\r\n                    if (sourceNetwork.nodes[j].isOutputNode()) {\r\n                        outputNumber++;\r\n                    }\r\n                }\r\n                chosenNode = sourceNetwork.nodes[j];\r\n            }\r\n            else {\r\n                chosenNodeType = Node_1.NodeType.HIDDEN;\r\n                var sourceNetwork = void 0;\r\n                if (i >= network1.nodes.length) {\r\n                    sourceNetwork = network2;\r\n                }\r\n                else if (i >= network2.nodes.length) {\r\n                    sourceNetwork = network1;\r\n                }\r\n                else {\r\n                    sourceNetwork = Utils_1.randBoolean() ? network1 : network2;\r\n                }\r\n                chosenNode = Utils_1.pickRandom(sourceNetwork.nodes);\r\n            }\r\n            var newNode = new Node_1.Node(chosenNodeType);\r\n            newNode.bias = chosenNode.bias;\r\n            newNode.squash = chosenNode.squash;\r\n            offspring.nodes.push(newNode);\r\n        }\r\n        // Create arrays of connection genes\r\n        var n1connections = [];\r\n        var n2connections = [];\r\n        // Add the connections of network 1\r\n        network1.connections.forEach(function (connection) {\r\n            n1connections[Connection_1.Connection.innovationID(connection.from.index, connection.to.index)] = connection.toJSON();\r\n        });\r\n        // Add the connections of network 2\r\n        network2.connections.forEach(function (connection) {\r\n            n2connections[Connection_1.Connection.innovationID(connection.from.index, connection.to.index)] = connection.toJSON();\r\n        });\r\n        // Split common conn genes from disjoint or excess conn genes\r\n        var connections = [];\r\n        var keys1 = Object.keys(n1connections);\r\n        var keys2 = Object.keys(n2connections);\r\n        for (var i = keys1.length - 1; i >= 0; i--) {\r\n            if (n2connections[parseInt(keys1[i])] !== undefined) {\r\n                connections.push(Utils_1.randBoolean() ? n1connections[parseInt(keys1[i])] : n2connections[parseInt(keys1[i])]);\r\n                n2connections[parseInt(keys1[i])] = undefined;\r\n            }\r\n            else if (score1 >= score2 || equal) {\r\n                connections.push(n1connections[parseInt(keys1[i])]);\r\n            }\r\n        }\r\n        // Excess/disjoint gene\r\n        if (score2 >= score1 || equal) {\r\n            keys2\r\n                .map(function (key) { return parseInt(key); })\r\n                .map(function (key) { return n2connections[key]; })\r\n                .filter(function (conn) { return conn !== undefined; })\r\n                .forEach(function (conn) { return connections.push(conn); });\r\n        }\r\n        // Add common conn genes uniformly\r\n        connections.forEach(function (connectionJSON) {\r\n            if (connectionJSON !== undefined && connectionJSON.toIndex < offspringSize && connectionJSON.fromIndex < offspringSize) {\r\n                var from = offspring.nodes[connectionJSON.fromIndex];\r\n                var to = offspring.nodes[connectionJSON.toIndex];\r\n                var connection = offspring.connect(from, to, connectionJSON.weight);\r\n                if (connectionJSON.gateNodeIndex !== null && connectionJSON.gateNodeIndex < offspringSize) {\r\n                    offspring.addGate(offspring.nodes[connectionJSON.gateNodeIndex], connection);\r\n                }\r\n            }\r\n        });\r\n        return offspring;\r\n    };\r\n    Network.prototype.copy = function () {\r\n        return Network.fromJSON(this.toJSON());\r\n    };\r\n    Network.prototype.connect = function (from, to, weight) {\r\n        if (weight === void 0) { weight = 0; }\r\n        var connection = from.connect(to, weight);\r\n        this.connections.push(connection);\r\n        return connection;\r\n    };\r\n    Network.prototype.activate = function (input, dropoutRate, trace) {\r\n        if (dropoutRate === void 0) { dropoutRate = 0; }\r\n        if (trace === void 0) { trace = true; }\r\n        var inputNodeIndex = 0;\r\n        for (var _i = 0, _a = this.nodes; _i < _a.length; _i++) {\r\n            var node = _a[_i];\r\n            if (inputNodeIndex === this.inputSize) {\r\n                break;\r\n            }\r\n            if (!node.isInputNode()) {\r\n                continue;\r\n            }\r\n            node.activate(input[inputNodeIndex++], trace);\r\n        }\r\n        if (inputNodeIndex !== input.length) {\r\n            throw Error(\"There are \" + inputNodeIndex + \" input nodes, but \" + input.length + \" inputs were passed\");\r\n        }\r\n        this.nodes\r\n            .filter(function (node) { return node.isHiddenNode(); })\r\n            .forEach(function (node) {\r\n            if (dropoutRate) {\r\n                node.mask = Math.random() >= dropoutRate ? 1 : 0;\r\n            }\r\n            node.activate(undefined, trace);\r\n        });\r\n        var output = [];\r\n        for (var _b = 0, _c = this.nodes; _b < _c.length; _b++) {\r\n            var node = _c[_b];\r\n            if (output.length === this.outputSize) {\r\n                break;\r\n            }\r\n            if (!node.isOutputNode()) {\r\n                continue;\r\n            }\r\n            output.push(node.activate(undefined, trace));\r\n        }\r\n        if (output.length !== this.outputSize) {\r\n            throw Error(\"There are \" + this.outputSize + \" output nodes, but \" + output.length + \" outputs were passed\");\r\n        }\r\n        return output;\r\n    };\r\n    Network.prototype.propagate = function (rate, momentum, update, target) {\r\n        if (target.length !== this.outputSize) {\r\n            throw new Error(\"Output target length should match network output length\");\r\n        }\r\n        var targetIndex = 0;\r\n        for (var i = 0; targetIndex < this.outputSize; i++) {\r\n            if (this.nodes[i].isOutputNode()) {\r\n                this.nodes[i].propagate(target[targetIndex++], momentum, rate, update);\r\n            }\r\n        }\r\n        for (var i = this.nodes.length - 1; i >= 0; i--) {\r\n            if (this.nodes[i].isHiddenNode()) {\r\n                this.nodes[i].propagate(undefined, rate, momentum, update);\r\n            }\r\n        }\r\n        this.nodes\r\n            .filter(function (node) { return node.isInputNode(); })\r\n            .forEach(function (node) {\r\n            node.propagate(undefined, rate, momentum, update);\r\n        });\r\n    };\r\n    Network.prototype.clear = function () {\r\n        this.nodes.forEach(function (node) { return node.clear(); });\r\n    };\r\n    Network.prototype.disconnect = function (from, to) {\r\n        var _this = this;\r\n        this.connections\r\n            .filter(function (conn) { return conn.from === from; })\r\n            .filter(function (conn) { return conn.to === to; })\r\n            .forEach(function (conn) {\r\n            if (conn.gateNode !== null) {\r\n                _this.removeGate(conn);\r\n            }\r\n            Utils_1.remove(_this.connections, conn);\r\n        });\r\n        return from.disconnect(to);\r\n    };\r\n    Network.prototype.addGate = function (node, connection) {\r\n        if (this.nodes.indexOf(node) === -1) {\r\n            throw new ReferenceError(\"This node is not part of the network!\");\r\n        }\r\n        else if (connection.gateNode != null) {\r\n            return;\r\n        }\r\n        node.addGate(connection);\r\n        this.gates.push(connection);\r\n    };\r\n    Network.prototype.removeGate = function (connection) {\r\n        if (!Utils_1.anyMatch(this.gates, connection)) {\r\n            throw new Error(\"This connection is not gated!\");\r\n        }\r\n        Utils_1.remove(this.gates, connection);\r\n        if (connection.gateNode != null) {\r\n            connection.gateNode.removeGate(connection);\r\n        }\r\n    };\r\n    Network.prototype.removeNode = function (node, keepGates) {\r\n        var _this = this;\r\n        if (keepGates === void 0) { keepGates = new Mutation_1.SubNodeMutation().keepGates; }\r\n        if (!Utils_1.anyMatch(this.nodes, node)) {\r\n            throw new ReferenceError(\"This node does not exist in the network!\");\r\n        }\r\n        this.disconnect(node, node);\r\n        var inputs = [];\r\n        var gates = [];\r\n        var outputs = [];\r\n        for (var i = node.incoming.length - 1; i >= 0; i--) {\r\n            var connection = node.incoming[i];\r\n            if (keepGates && connection.gateNode !== null && connection.gateNode !== node) {\r\n                gates.push(connection.gateNode);\r\n            }\r\n            inputs.push(connection.from);\r\n            this.disconnect(connection.from, node);\r\n        }\r\n        for (var i = node.outgoing.length - 1; i >= 0; i--) {\r\n            var connection = node.outgoing[i];\r\n            if (keepGates && connection.gateNode !== null && connection.gateNode !== node) {\r\n                gates.push(connection.gateNode);\r\n            }\r\n            outputs.push(connection.to);\r\n            this.disconnect(node, connection.to);\r\n        }\r\n        var connections = [];\r\n        inputs.forEach(function (input) {\r\n            outputs.forEach(function (output) {\r\n                if (!input.isProjectingTo(output)) {\r\n                    connections.push(_this.connect(input, output));\r\n                }\r\n            });\r\n        });\r\n        while (gates.length > 0 && connections.length > 0) {\r\n            var gate = gates.shift();\r\n            if (gate === undefined) {\r\n                continue;\r\n            }\r\n            var connection = Utils_1.pickRandom(connections);\r\n            this.addGate(gate, connection);\r\n            Utils_1.remove(connections, connection);\r\n        }\r\n        for (var i = node.gated.length - 1; i >= 0; i--) {\r\n            this.removeGate(node.gated[i]);\r\n        }\r\n        Utils_1.remove(this.nodes, node);\r\n    };\r\n    Network.prototype.mutate = function (method, maxNodes, maxConnections, maxGates) {\r\n        if (maxNodes === void 0) { maxNodes = Infinity; }\r\n        if (maxConnections === void 0) { maxConnections = Infinity; }\r\n        if (maxGates === void 0) { maxGates = Infinity; }\r\n        var _a;\r\n        method.mutate(this, (_a = maxNodes !== null && maxNodes !== void 0 ? maxNodes : maxConnections) !== null && _a !== void 0 ? _a : maxGates);\r\n    };\r\n    Network.prototype.mutateRandom = function (allowedMethods, maxNodes, maxConnections, maxGates) {\r\n        if (allowedMethods === void 0) { allowedMethods = Mutation_1.ALL_MUTATIONS; }\r\n        if (maxNodes === void 0) { maxNodes = Infinity; }\r\n        if (maxConnections === void 0) { maxConnections = Infinity; }\r\n        if (maxGates === void 0) { maxGates = Infinity; }\r\n        if (allowedMethods.length === 0) {\r\n            return;\r\n        }\r\n        this.mutate(Utils_1.pickRandom(allowedMethods), maxNodes || Infinity, maxConnections || Infinity, maxGates || Infinity);\r\n    };\r\n    Network.prototype.train = function (dataset, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _a;\r\n        if (dataset[0].input.length !== this.inputSize || dataset[0].output.length !== this.outputSize) {\r\n            throw new Error(\"Dataset input/output size should be same as network input/output size!\");\r\n        }\r\n        options.iterations = Utils_1.getOrDefault(options.iterations, 100);\r\n        options.error = Utils_1.getOrDefault(options.error, 0.05);\r\n        options.loss = Utils_1.getOrDefault(options.loss, new Loss_1.MSELoss());\r\n        var baseRate = Utils_1.getOrDefault(options.rate, 0.3);\r\n        options.dropout = Utils_1.getOrDefault(options.dropout, 0);\r\n        options.momentum = Utils_1.getOrDefault(options.momentum, 0);\r\n        options.batchSize = Math.min(dataset.length, Utils_1.getOrDefault(options.batchSize, 1));\r\n        options.ratePolicy = Utils_1.getOrDefault(options.ratePolicy, new Rate_1.FixedRate(baseRate));\r\n        options.log = Utils_1.getOrDefault(options.log, NaN);\r\n        var targetError = options.error <= 0 ? -1 : options.error;\r\n        var start = Date.now();\r\n        // check for errors\r\n        if (options.iterations <= 0 && options.error <= 0) {\r\n            throw new Error(\"At least one of the following options must be specified: error, iterations\");\r\n        }\r\n        var trainingSetSize;\r\n        var trainingSet;\r\n        var testSet;\r\n        if (options.crossValidateTestSize && options.crossValidateTestSize > 0) {\r\n            trainingSetSize = Math.ceil((1 - options.crossValidateTestSize) * dataset.length);\r\n            trainingSet = dataset.slice(0, trainingSetSize);\r\n            testSet = dataset.slice(trainingSetSize);\r\n        }\r\n        else {\r\n            trainingSet = dataset;\r\n            testSet = [];\r\n        }\r\n        var currentTrainingRate;\r\n        var iterationCount = 0;\r\n        var error = 1;\r\n        while (error > targetError && (options.iterations <= 0 || iterationCount < options.iterations)) {\r\n            iterationCount++;\r\n            currentTrainingRate = options.ratePolicy.calc(iterationCount);\r\n            var trainError = this.trainEpoch(trainingSet, options.batchSize, currentTrainingRate, options.momentum, options.loss, options.dropout);\r\n            if (options.clear) {\r\n                this.clear();\r\n            }\r\n            // Checks if cross validation is enabled\r\n            if (options.crossValidateTestSize) {\r\n                error = this.test(testSet, options.loss);\r\n                if (options.clear) {\r\n                    this.clear();\r\n                }\r\n            }\r\n            else {\r\n                error = trainError;\r\n            }\r\n            if ((_a = options.shuffle) !== null && _a !== void 0 ? _a : false) {\r\n                Utils_1.shuffle(dataset);\r\n            }\r\n            if (options.log > 0 && iterationCount % options.log === 0) {\r\n                console.log(\"iteration number\", iterationCount, \"error\", error, \"training rate\", currentTrainingRate);\r\n            }\r\n            if (options.schedule && iterationCount % options.schedule.iterations === 0) {\r\n                options.schedule.function(error, iterationCount);\r\n            }\r\n        }\r\n        if (options.clear) {\r\n            this.clear();\r\n        }\r\n        return {\r\n            error: error,\r\n            iterations: iterationCount,\r\n            time: Date.now() - start\r\n        };\r\n    };\r\n    Network.prototype.trainEpoch = function (dataset, batchSize, trainingRate, momentum, loss, dropoutRate) {\r\n        if (dropoutRate === void 0) { dropoutRate = 0.5; }\r\n        var errorSum = 0;\r\n        for (var i = 0; i < dataset.length; i++) {\r\n            var input = dataset[i].input;\r\n            var correctOutput = dataset[i].output;\r\n            var update = (i + 1) % batchSize === 0 || i + 1 === dataset.length;\r\n            var output = this.activate(input, dropoutRate);\r\n            this.propagate(trainingRate, momentum, update, correctOutput);\r\n            errorSum += loss.calc(correctOutput, output);\r\n        }\r\n        return errorSum / dataset.length;\r\n    };\r\n    Network.prototype.test = function (dataset, loss) {\r\n        if (loss === void 0) { loss = new Loss_1.MSELoss(); }\r\n        var error = 0;\r\n        for (var _i = 0, dataset_1 = dataset; _i < dataset_1.length; _i++) {\r\n            var entry = dataset_1[_i];\r\n            var input = entry.input;\r\n            var target = entry.output;\r\n            var output = this.activate(input, undefined, false);\r\n            error += loss.calc(target, output);\r\n        }\r\n        return error / dataset.length;\r\n    };\r\n    Network.prototype.toJSON = function () {\r\n        var json = {\r\n            nodes: [],\r\n            connections: [],\r\n            inputSize: this.inputSize,\r\n            outputSize: this.outputSize,\r\n        };\r\n        for (var i = 0; i < this.nodes.length; i++) {\r\n            this.nodes[i].index = i;\r\n        }\r\n        this.nodes.forEach(function (node) {\r\n            json.nodes.push(node.toJSON());\r\n            if (node.selfConnection.weight !== 0) {\r\n                json.connections.push(node.selfConnection.toJSON());\r\n            }\r\n        });\r\n        this.connections.forEach(function (conn) { return json.connections.push(conn.toJSON()); });\r\n        return json;\r\n    };\r\n    Network.prototype.evolve = function (dataset, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _a, _b, _c;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var targetError, start, neat, error, bestFitness, bestGenome, fittest, fitness;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        if (dataset[0].input.length !== this.inputSize || dataset[0].output.length !== this.outputSize) {\r\n                            throw new Error(\"Dataset input/output size should be same as network input/output size!\");\r\n                        }\r\n                        targetError = 0;\r\n                        if (typeof options.iterations === \"undefined\" && typeof options.error === \"undefined\") {\r\n                            options.iterations = 1000;\r\n                            targetError = 0.05;\r\n                        }\r\n                        else if (options.iterations) {\r\n                            targetError = -1;\r\n                        }\r\n                        else if (options.error) {\r\n                            targetError = options.error;\r\n                            options.iterations = 0;\r\n                        }\r\n                        options.growth = Utils_1.getOrDefault(options.growth, 0.0001);\r\n                        options.loss = Utils_1.getOrDefault(options.loss, new Loss_1.MSELoss());\r\n                        options.amount = Utils_1.getOrDefault(options.amount, 1);\r\n                        options.fitnessPopulation = Utils_1.getOrDefault(options.fitnessPopulation, false);\r\n                        options.maxNodes = Utils_1.getOrDefault(options.maxNodes, Infinity);\r\n                        options.maxConnections = Utils_1.getOrDefault(options.maxConnections, Infinity);\r\n                        options.maxGates = Utils_1.getOrDefault(options.maxGates, Infinity);\r\n                        start = Date.now();\r\n                        options.fitnessFunction = function (dataset, population) {\r\n                            return __awaiter(this, void 0, void 0, function () {\r\n                                var _this = this;\r\n                                return __generator(this, function (_a) {\r\n                                    switch (_a.label) {\r\n                                        case 0:\r\n                                            if (!Array.isArray(population)) {\r\n                                                population = [population];\r\n                                            }\r\n                                            return [4 /*yield*/, Promise.all(population.map(function (genome) { return __awaiter(_this, void 0, void 0, function () {\r\n                                                    var score, i;\r\n                                                    var _a, _b, _c;\r\n                                                    return __generator(this, function (_d) {\r\n                                                        score = 0;\r\n                                                        for (i = 0; i < ((_a = options.amount) !== null && _a !== void 0 ? _a : 1); i++) {\r\n                                                            score -= genome.test(dataset, options.loss);\r\n                                                        }\r\n                                                        score -= (_b = options.growth) !== null && _b !== void 0 ? _b : 0.0001 * (genome.nodes.length\r\n                                                            - genome.inputSize\r\n                                                            - genome.outputSize\r\n                                                            + genome.connections.length\r\n                                                            + genome.gates.length);\r\n                                                        genome.score = score / ((_c = options.amount) !== null && _c !== void 0 ? _c : 1);\r\n                                                        return [2 /*return*/];\r\n                                                    });\r\n                                                }); }))];\r\n                                        case 1:\r\n                                            _a.sent();\r\n                                            return [2 /*return*/];\r\n                                    }\r\n                                });\r\n                            });\r\n                        };\r\n                        options.fitnessPopulation = true;\r\n                        options.template = this;\r\n                        options.input = this.inputSize;\r\n                        options.output = this.outputSize;\r\n                        neat = new NEAT_1.NEAT(dataset, options);\r\n                        error = -Infinity;\r\n                        bestFitness = -Infinity;\r\n                        _d.label = 1;\r\n                    case 1:\r\n                        if (!(error < -targetError && (options.iterations === 0 || neat.generation < ((_a = options.iterations) !== null && _a !== void 0 ? _a : 0)))) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, neat.evolve(undefined, undefined)];\r\n                    case 2:\r\n                        fittest = _d.sent();\r\n                        fitness = fittest.score === undefined ? -Infinity : fittest.score;\r\n                        error = fitness + options.growth * (fittest.nodes.length\r\n                            - fittest.inputSize\r\n                            - fittest.outputSize\r\n                            + fittest.connections.length\r\n                            + fittest.gates.length);\r\n                        if (fitness > bestFitness) {\r\n                            bestFitness = fitness;\r\n                            bestGenome = fittest;\r\n                        }\r\n                        if (((_b = options.log) !== null && _b !== void 0 ? _b : 0) > 0 && neat.generation % ((_c = options.log) !== null && _c !== void 0 ? _c : 0) === 0) {\r\n                            console.log(\"iteration\", neat.generation, \"fitness\", fitness, \"error\", -error);\r\n                        }\r\n                        if (options.schedule && neat.generation % options.schedule.iterations === 0) {\r\n                            options.schedule.function(fitness, -error, neat.generation);\r\n                        }\r\n                        return [3 /*break*/, 1];\r\n                    case 3:\r\n                        if (bestGenome !== undefined) {\r\n                            this.nodes = bestGenome.nodes;\r\n                            this.connections = bestGenome.connections;\r\n                            this.gates = bestGenome.gates;\r\n                            if (options.clear) {\r\n                                this.clear();\r\n                            }\r\n                        }\r\n                        return [2 /*return*/, {\r\n                                error: -error,\r\n                                iterations: neat.generation,\r\n                                time: Date.now() - start,\r\n                            }];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return Network;\r\n}());\r\nexports.Network = Network;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Activation_1 = require(\"../methods/Activation\");\r\nvar Connection_1 = require(\"./Connection\");\r\nvar Utils_1 = require(\"../methods/Utils\");\r\nvar Node = /** @class */ (function () {\r\n    function Node(type) {\r\n        if (type === void 0) { type = NodeType.HIDDEN; }\r\n        this.type = type;\r\n        this.bias = Utils_1.randDouble(-1, 1);\r\n        this.squash = new Activation_1.LogisticActivation();\r\n        this.activation = 0;\r\n        this.state = 0;\r\n        this.old = 0;\r\n        this.mask = 1;\r\n        this.deltaBiasPrevious = 0;\r\n        this.deltaBiasTotal = 0;\r\n        this.incoming = [];\r\n        this.outgoing = [];\r\n        this.gated = [];\r\n        this.selfConnection = new Connection_1.Connection(this, this, 0);\r\n        this.errorResponsibility = 0;\r\n        this.errorProjected = 0;\r\n        this.errorGated = 0;\r\n        this.index = NaN;\r\n    }\r\n    Node.fromJSON = function (json) {\r\n        var node = new Node();\r\n        node.bias = json.bias;\r\n        node.type = json.type;\r\n        node.squash = Activation_1.Activation.getActivation(json.squash);\r\n        node.mask = json.mask;\r\n        node.index = json.index;\r\n        return node;\r\n    };\r\n    Node.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            connection.eligibility = 0;\r\n            connection.xTraceNodes = [];\r\n            connection.xTraceValues = [];\r\n        }\r\n        for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n            var connection = _c[_b];\r\n            connection.gain = 0;\r\n        }\r\n        this.errorResponsibility = this.errorProjected = this.errorGated = 0;\r\n        this.old = this.state = this.activation = 0;\r\n    };\r\n    Node.prototype.mutateBias = function (method) {\r\n        this.bias += Utils_1.randDouble(method.min, method.max);\r\n    };\r\n    Node.prototype.mutateActivation = function () {\r\n        var newActivationType;\r\n        do {\r\n            newActivationType = Utils_1.pickRandom(Activation_1.ALL_ACTIVATIONS);\r\n        } while (newActivationType === this.squash.type);\r\n        this.squash = Activation_1.Activation.getActivation(newActivationType);\r\n    };\r\n    Node.prototype.isProjectedBy = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.incoming.map(function (conn) { return conn.from; }), node);\r\n        }\r\n    };\r\n    Node.prototype.isProjectingTo = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.outgoing.map(function (conn) { return conn.to; }), node);\r\n        }\r\n    };\r\n    Node.prototype.addGate = function (connection) {\r\n        this.gated.push(connection);\r\n        connection.gateNode = this;\r\n    };\r\n    Node.prototype.removeGate = function (connection) {\r\n        Utils_1.remove(this.gated, connection);\r\n        connection.gateNode = null;\r\n        connection.gain = 1;\r\n    };\r\n    Node.prototype.connect = function (target, weight, twoSided) {\r\n        if (weight === void 0) { weight = 0; }\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (target === this) {\r\n            this.selfConnection.weight = weight || 1;\r\n            return this.selfConnection;\r\n        }\r\n        else if (this.isProjectingTo(target)) {\r\n            throw new ReferenceError();\r\n        }\r\n        else {\r\n            var connection = new Connection_1.Connection(this, target, weight);\r\n            this.outgoing.push(connection);\r\n            target.incoming.push(connection);\r\n            if (twoSided) {\r\n                target.connect(this);\r\n            }\r\n            return connection;\r\n        }\r\n    };\r\n    Node.prototype.disconnect = function (node, twoSided) {\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (node === this) {\r\n            this.selfConnection.weight = 0;\r\n            return this.selfConnection;\r\n        }\r\n        for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            if (connection.to !== node) {\r\n                continue;\r\n            }\r\n            Utils_1.remove(this.outgoing, connection);\r\n            Utils_1.remove(connection.to.incoming, connection);\r\n            if (connection.gateNode !== undefined && connection.gateNode != null) {\r\n                connection.gateNode.removeGate(connection);\r\n            }\r\n            if (twoSided) {\r\n                node.disconnect(this);\r\n            }\r\n            return connection;\r\n        }\r\n        throw new Error(\"No connection found!\");\r\n    };\r\n    Node.prototype.propagate = function (target, momentum, rate, update) {\r\n        // TODO: check for errors\r\n        if (target !== undefined && Number.isFinite(target)) {\r\n            this.errorResponsibility = this.errorProjected = target - this.activation;\r\n        }\r\n        else {\r\n            this.errorProjected = 0;\r\n            for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                this.errorProjected += connection.to.errorResponsibility * connection.weight * connection.gain;\r\n            }\r\n            this.errorProjected *= this.derivative || 1;\r\n            this.errorGated = 0;\r\n            for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                var node = connection.to;\r\n                var influence = void 0;\r\n                if (node.selfConnection.gateNode === this) {\r\n                    influence = node.old + connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    influence = connection.weight * connection.from.activation;\r\n                }\r\n                this.errorGated += node.errorResponsibility * influence;\r\n            }\r\n            this.errorGated *= this.derivative || 1;\r\n            this.errorResponsibility = this.errorProjected + this.errorGated;\r\n        }\r\n        for (var _d = 0, _e = this.incoming; _d < _e.length; _d++) {\r\n            var connection = _e[_d];\r\n            var gradient = this.errorProjected * connection.eligibility;\r\n            for (var j = 0; j < connection.xTraceNodes.length; j++) {\r\n                var node = connection.xTraceNodes[j];\r\n                gradient += node.errorResponsibility * connection.xTraceValues[j];\r\n            }\r\n            connection.deltaWeightsTotal += rate * gradient * this.mask;\r\n            if (update) {\r\n                connection.deltaWeightsTotal += momentum * connection.deltaWeightsPrevious;\r\n                connection.weight += connection.deltaWeightsTotal;\r\n                connection.deltaWeightsPrevious = connection.deltaWeightsTotal;\r\n                connection.deltaWeightsTotal = 0;\r\n            }\r\n        }\r\n        this.deltaBiasTotal += rate * this.errorResponsibility;\r\n        if (update) {\r\n            this.deltaBiasTotal += momentum * this.deltaBiasPrevious;\r\n            this.bias += this.deltaBiasTotal;\r\n            this.deltaBiasPrevious = this.deltaBiasTotal;\r\n            this.deltaBiasTotal = 0;\r\n        }\r\n        return {\r\n            responsibility: this.errorResponsibility,\r\n            projected: this.errorProjected,\r\n            gated: this.errorGated,\r\n        };\r\n    };\r\n    Node.prototype.activate = function (input, trace) {\r\n        var _this = this;\r\n        if (input === void 0) { input = null; }\r\n        if (trace === void 0) { trace = true; }\r\n        // TODO: check for errors\r\n        if (input !== null && Number.isFinite(input)) {\r\n            return this.activation = input;\r\n        }\r\n        if (trace) {\r\n            this.old = this.state;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            this.incoming.forEach(function (conn) {\r\n                _this.state += conn.from.activation * conn.weight * conn.gain;\r\n            });\r\n            this.activation = this.squash.calc(this.state, false) * this.mask;\r\n            this.derivative = this.squash.calc(this.state, true);\r\n            var nodes_1 = [];\r\n            var influences_1 = [];\r\n            this.gated.forEach(function (connection) {\r\n                connection.gain = _this.activation;\r\n                var index = nodes_1.indexOf(connection.to);\r\n                if (index > -1) {\r\n                    influences_1[index] += connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    nodes_1.push(connection.to);\r\n                    if (connection.to.selfConnection.gateNode === _this) {\r\n                        influences_1.push(connection.weight * connection.from.activation + connection.to.old);\r\n                    }\r\n                    else {\r\n                        influences_1.push(connection.weight * connection.from.activation);\r\n                    }\r\n                }\r\n            });\r\n            for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                connection.eligibility = this.selfConnection.gain * this.selfConnection.weight * connection.eligibility + connection.from.activation * connection.gain;\r\n                for (var i = 0; i < nodes_1.length; i++) {\r\n                    var node = nodes_1[i];\r\n                    var influence = influences_1[i];\r\n                    var index = connection.xTraceNodes.indexOf(node);\r\n                    if (index > -1)\r\n                        connection.xTraceValues[index] = node.selfConnection.gain * node.selfConnection.weight * connection.xTraceValues[index] + this.derivative * connection.eligibility * influence;\r\n                    else {\r\n                        connection.xTraceNodes.push(node);\r\n                        connection.xTraceValues.push(this.derivative * connection.eligibility * influence);\r\n                    }\r\n                }\r\n            }\r\n            return this.activation;\r\n        }\r\n        else {\r\n            if (this.isInputNode())\r\n                return this.activation = 0;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            for (var _b = 0, _c = this.incoming; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                this.state += connection.from.activation * connection.weight * connection.gain;\r\n            }\r\n            this.activation = this.squash.calc(this.state, false);\r\n            for (var _d = 0, _e = this.gated; _d < _e.length; _d++) {\r\n                var connection = _e[_d];\r\n                connection.gain = this.activation;\r\n            }\r\n            return this.activation;\r\n        }\r\n    };\r\n    Node.prototype.toJSON = function () {\r\n        return {\r\n            bias: this.bias,\r\n            type: this.type,\r\n            squash: this.squash.type,\r\n            mask: this.mask,\r\n            index: this.index\r\n        };\r\n    };\r\n    Node.prototype.isInputNode = function () {\r\n        return this.type === NodeType.INPUT;\r\n    };\r\n    Node.prototype.isHiddenNode = function () {\r\n        return this.type === NodeType.HIDDEN;\r\n    };\r\n    Node.prototype.isOutputNode = function () {\r\n        return this.type === NodeType.OUTPUT;\r\n    };\r\n    return Node;\r\n}());\r\nexports.Node = Node;\r\nvar NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"INPUT\"] = 0] = \"INPUT\";\r\n    NodeType[NodeType[\"HIDDEN\"] = 1] = \"HIDDEN\";\r\n    NodeType[NodeType[\"OUTPUT\"] = 2] = \"OUTPUT\";\r\n})(NodeType = exports.NodeType || (exports.NodeType = {}));\r\n","\"use strict\";\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result[\"default\"] = mod;\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./architecture/layer/Layer\");\r\nexports.Layer = Layer_1.Layer;\r\nvar ConvolutionLayer_1 = require(\"./architecture/layer/ConvolutionLayer\");\r\nexports.ConvolutionLayer = ConvolutionLayer_1.ConvolutionLayer;\r\nvar DenseLayer_1 = require(\"./architecture/layer/DenseLayer\");\r\nexports.DenseLayer = DenseLayer_1.DenseLayer;\r\nvar GaussianNoiseLayer_1 = require(\"./architecture/layer/GaussianNoiseLayer\");\r\nexports.GaussianNoiseLayer = GaussianNoiseLayer_1.GaussianNoiseLayer;\r\nvar InputLayer_1 = require(\"./architecture/layer/InputLayer\");\r\nexports.InputLayer = InputLayer_1.InputLayer;\r\nvar LSTMLayer_1 = require(\"./architecture/layer/LSTMLayer\");\r\nexports.LSTMLayer = LSTMLayer_1.LSTMLayer;\r\nvar PoolLayer_1 = require(\"./architecture/layer/PoolLayer\");\r\nexports.PoolLayer = PoolLayer_1.PoolLayer;\r\nvar RNNLayer_1 = require(\"./architecture/layer/RNNLayer\");\r\nexports.RNNLayer = RNNLayer_1.RNNLayer;\r\nvar Architect_1 = require(\"./architecture/Architect\");\r\nexports.Architect = Architect_1.Architect;\r\nvar Connection_1 = require(\"./architecture/Connection\");\r\nexports.Connection = Connection_1.Connection;\r\nvar Network_1 = require(\"./architecture/Network\");\r\nexports.Network = Network_1.Network;\r\nvar node_1 = require(\"./architecture/node\");\r\nexports.Node = node_1.Node;\r\nvar Activation = __importStar(require(\"./methods/Activation\"));\r\nexports.Activation = Activation;\r\nvar Loss = __importStar(require(\"./methods/Loss\"));\r\nexports.Loss = Loss;\r\nvar Mutation = __importStar(require(\"./methods/Mutation\"));\r\nexports.Mutation = Mutation;\r\nvar Rate = __importStar(require(\"./methods/Rate\"));\r\nexports.Rate = Rate;\r\nvar Selection = __importStar(require(\"./methods/Selection\"));\r\nexports.Selection = Selection;\r\nvar NEAT_1 = require(\"./NEAT\");\r\nexports.NEAT = NEAT_1.NEAT;\r\n"]}