!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=55)}([function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a}));var o=n(20);let r=o.a;function i(e){r=Object(o.b)(r,e)}function s(e){return r.deserialize(e)}function a(e){return r.serialize(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var o=n(13);const r=Object(o.a)("iterator"),i=Object(o.a)("observable"),s=Object(o.a)("species");function a(e,t){const n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function c(e){let t=e.constructor;return void 0!==t&&(t=t[s],null===t&&(t=void 0)),void 0!==t?t:g}function u(e){u.log?u.log(e):setTimeout(()=>{throw e},0)}function l(e){Promise.resolve().then(()=>{try{e()}catch(e){u(e)}})}function d(e){const t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{const e=a(t,"unsubscribe");e&&e.call(t)}}catch(e){u(e)}}function h(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function f(e,t,n){e._state="running";const o=e._observer;try{const r=o?a(o,t):void 0;switch(t){case"next":r&&r.call(o,n);break;case"error":if(h(e),!r)throw n;r.call(o,n);break;case"complete":h(e),r&&r.call(o)}}catch(e){u(e)}"closed"===e._state?d(e):"running"===e._state&&(e._state="ready")}function p(e,t,n){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:n})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void l(()=>function(e){const t=e._queue;if(t){e._queue=void 0,e._state="ready";for(const n of t)if(f(e,n.type,n.value),"closed"===e._state)break}}(e))):void f(e,t,n)}class m{constructor(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const n=new y(this);try{this._cleanup=t.call(void 0,n)}catch(e){n.error(e)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(h(this),d(this))}}class y{constructor(e){this._subscription=e}get closed(){return"closed"===this._subscription._state}next(e){p(this._subscription,"next",e)}error(e){p(this._subscription,"error",e)}complete(){p(this._subscription,"complete")}}class g{constructor(e){if(!(this instanceof g))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,t,n){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:n}),new m(e,this._subscriber)}pipe(e,...t){let n=this;for(const o of[e,...t])n=o(n);return n}tap(e,t,n){const o="object"!=typeof e||null===e?{next:e,error:t,complete:n}:e;return new g(e=>this.subscribe({next(t){o.next&&o.next(t),e.next(t)},error(t){o.error&&o.error(t),e.error(t)},complete(){o.complete&&o.complete(),e.complete()},start(e){o.start&&o.start(e)}}))}forEach(e){return new Promise((t,n)=>{if("function"!=typeof e)return void n(new TypeError(e+" is not a function"));function o(){r.unsubscribe(),t()}const r=this.subscribe({next(t){try{e(t,o)}catch(e){n(e),r.unsubscribe()}},error:n,complete:t})})}map(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(c(this))(t=>this.subscribe({next(n){let o=n;try{o=e(n)}catch(e){return t.error(e)}t.next(o)},error(e){t.error(e)},complete(){t.complete()}}))}filter(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(c(this))(t=>this.subscribe({next(n){try{if(!e(n))return}catch(e){return t.error(e)}t.next(n)},error(e){t.error(e)},complete(){t.complete()}}))}reduce(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");const n=c(this),o=arguments.length>1;let r=!1,i=t;return new n(t=>this.subscribe({next(n){const s=!r;if(r=!0,!s||o)try{i=e(i,n)}catch(e){return t.error(e)}else i=n},error(e){t.error(e)},complete(){if(!r&&!o)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(i),t.complete()}}))}concat(...e){const t=c(this);return new t(n=>{let o,r=0;return function i(s){o=s.subscribe({next(e){n.next(e)},error(e){n.error(e)},complete(){r===e.length?(o=void 0,n.complete()):i(t.from(e[r++]))}})}(this),()=>{o&&(o.unsubscribe(),o=void 0)}})}flatMap(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");const t=c(this);return new t(n=>{const o=[],r=this.subscribe({next(r){let s;if(e)try{s=e(r)}catch(e){return n.error(e)}else s=r;const a=t.from(s).subscribe({next(e){n.next(e)},error(e){n.error(e)},complete(){const e=o.indexOf(a);e>=0&&o.splice(e,1),i()}});o.push(a)},error(e){n.error(e)},complete(){i()}});function i(){r.closed&&0===o.length&&n.complete()}return()=>{o.forEach(e=>e.unsubscribe()),r.unsubscribe()}})}[i](){return this}static from(e){const t="function"==typeof this?this:g;if(null==e)throw new TypeError(e+" is not an object");const n=a(e,i);if(n){const o=n.call(e);if(Object(o)!==o)throw new TypeError(o+" is not an object");return function(e){return e instanceof g}(o)&&o.constructor===t?o:new t(e=>o.subscribe(e))}if(Object(o.b)("iterator")){const n=a(e,r);if(n)return new t(t=>{l(()=>{if(!t.closed){for(const o of n.call(e))if(t.next(o),t.closed)return;t.complete()}})})}if(Array.isArray(e))return new t(t=>{l(()=>{if(!t.closed){for(const n of e)if(t.next(n),t.closed)return;t.complete()}})});throw new TypeError(e+" is not observable")}static of(...e){return new("function"==typeof this?this:g)(t=>{l(()=>{if(!t.closed){for(const n of e)if(t.next(n),t.closed)return;t.complete()}})})}static get[s](){return this}}Object(o.c)()&&Object.defineProperty(g,Symbol("extensions"),{value:{symbol:i,hostReportError:u},configurable:!0}),t.b=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseNodeType=t.PoolNodeType=t.NodeType=void 0,function(e){e[e.INPUT=0]="INPUT",e[e.HIDDEN=1]="HIDDEN",e[e.OUTPUT=2]="OUTPUT"}(t.NodeType||(t.NodeType={})),function(e){e[e.MAX_POOLING=0]="MAX_POOLING",e[e.AVG_POOLING=1]="AVG_POOLING",e[e.MIN_POOLING=2]="MIN_POOLING"}(t.PoolNodeType||(t.PoolNodeType={})),function(e){e[e.GAUSSIAN_NOISE=0]="GAUSSIAN_NOISE"}(t.NoiseNodeType||(t.NoiseNodeType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALL_ACTIVATIONS=t.GAUSSIAN=t.Sinc=t.Sinusiod=t.SiLU=t.BentIdentity=t.SoftPlus=t.LeakyRELU=t.RELU=t.SoftSign=t.ArSinH=t.ArcTan=t.SQNL=t.TANH=t.Logistic=t.BinaryStep=t.Identitiy=void 0;const o=(e,t=!1)=>t?1:e;t.Identitiy=o;const r=(e,t=!1)=>t||e<0?0:1;t.BinaryStep=r;const i=(e,t=!1)=>{const n=Math.exp(-e);return t?1/(1+n)*(1-1/(1+n)):1/(1+n)};t.Logistic=i;const s=(e,t=!1)=>t?1-Math.pow(Math.tanh(e),2):Math.tanh(e);t.TANH=s;const a=(e,t=!1)=>t?e>2?0:e>=0?1-e/2:e>=-2?1+e/2:0:e>2?1:e>=0?e-Math.pow(e/2,2):e>=-2?e+Math.pow(e/2,2):-1;t.SQNL=a;const c=(e,t=!1)=>t?1/(Math.pow(e,2)+1):Math.atan(e);t.ArcTan=c;const u=(e,t=!1)=>t?1/Math.pow(Math.pow(e,2)+1,.5):Math.asinh(e);t.ArSinH=u;const l=(e,t=!1)=>t?1/Math.pow(1+Math.abs(e),2):e/(1+Math.abs(e));t.SoftSign=l;const d=(e,t=!1)=>t?e>0?1:0:e>0?e:0;t.RELU=d;const h=(e,t=!1)=>t?e>0?1:.01:e>0?e:.01*e;t.LeakyRELU=h;const f=(e,t=!1)=>t?1/(1+Math.exp(-e)):Math.log(1+Math.exp(e));t.SoftPlus=f;const p=(e,t=!1)=>t?e/(2*Math.pow(Math.pow(e,2)+1,.5))+1:(Math.pow(Math.pow(e,2)+1,.5)-1)/2+e;t.BentIdentity=p;const m=(e,t=!1)=>{const n=Math.exp(-e);return t?(1+n+e*n)/Math.pow(1+n,2):e/(1+n)};t.SiLU=m;const y=(e,t=!1)=>t?Math.cos(e):Math.sin(e);t.Sinusiod=y;const g=(e,t=!1)=>t?0===e?0:Math.cos(e)/e-Math.sin(e)/Math.pow(e,2):0===e?1:Math.sin(e)/e;t.Sinc=g;const v=(e,t=!1)=>t?-2*e*Math.exp(-Math.pow(e,2)):1/Math.exp(Math.pow(e,2));t.GAUSSIAN=v,t.ALL_ACTIVATIONS=[o,r,i,s,a,c,u,l,d,h,f,p,m,y,g,v]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionType=void 0,function(e){e[e.NO_CONNECTION=0]="NO_CONNECTION",e[e.ALL_TO_ALL=1]="ALL_TO_ALL",e[e.ONE_TO_ONE=2]="ONE_TO_ONE",e[e.POOLING=3]="POOLING"}(t.ConnectionType||(t.ConnectionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Layer=void 0;const o=n(4),r=n(22);class i{constructor(e){this.outputSize=e,this.nodes=[],this.inputNodes=new Set,this.outputNodes=new Set,this.connections=[],this.gates=[]}static connect(e,t,n=o.ConnectionType.ALL_TO_ALL,r=1){if(n===o.ConnectionType.NO_CONNECTION)throw new ReferenceError("Cannot connect with 'NO_CONNECTION' connection type");const s=Array.from(e instanceof i?e.outputNodes:e),a=Array.from(t instanceof i?t.inputNodes:t);if(0===a.length)throw new ReferenceError("Target from has no input nodes!");if(0===s.length)throw new ReferenceError("This from has no output nodes!");const c=[];if(n===o.ConnectionType.ALL_TO_ALL)s.forEach(e=>{a.forEach(t=>{c.push(e.connect(t,r))})});else if(n===o.ConnectionType.ONE_TO_ONE){if(s.length!==a.length)throw new RangeError("Can't connect one to one! Number of output nodes from are unequal number of incoming nodes from next layer!");for(let e=0;e<s.length;e++)c.push(s[e].connect(a[e],r))}else if(n===o.ConnectionType.POOLING){const e=a.length/s.length;c.push(...s.map((t,n)=>t.connect(a[Math.floor(n*e)],r)))}return c}static gate(e,t,n){const o=[];switch(n){case r.GatingType.INPUT:{const n=Array.from(new Set(t.map(e=>e.to)));for(let r=0;r<n.length;r++){const i=n[r],s=e[r%e.length];i.incoming.forEach(e=>{t.includes(e)&&(s.addGate(e),o.push(e))})}break}case r.GatingType.SELF:{const n=Array.from(new Set(t.map(e=>e.from)));for(let r=0;r<n.length;r++)t.includes(n[r].selfConnection)&&(e[r%e.length].addGate(n[r].selfConnection),o.push(n[r].selfConnection));break}case r.GatingType.OUTPUT:{const n=Array.from(new Set(t.map(e=>e.from)));for(let r=0;r<n.length;r++){const i=n[r],s=e[r%e.length];i.outgoing.forEach(e=>{t.includes(e)&&(s.addGate(e),o.push(e))})}break}}return o}}t.Layer=i},function(e,t,n){"use strict";t.a=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()}},function(e,t,n){"use strict";function o(e,t){return Math.floor(Math.random()*(t-e)+e)}function r(e){if(0===e.length)throw new RangeError;let t=0;for(const n of e)t+=n;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.pairing=t.generateGaussian=t.avg=t.sum=t.min=t.minValueIndex=t.maxValueIndex=t.max=t.shuffle=t.removeFromArray=t.randBoolean=t.randDouble=t.randInt=t.pickRandom=void 0,t.pickRandom=function e(t){if(Array.isArray(t)){if(0===t.length)throw new RangeError("Cannot pick from an empty array");return t[o(0,t.length)]}return e(Array.from(t))},t.randInt=o,t.randDouble=function(e,t){return Math.random()*(t-e)+e},t.randBoolean=function(){return Math.random()>=.5},t.removeFromArray=function(e,t){const n=e.indexOf(t);return-1!==n&&(e.splice(n,1),!0)},t.shuffle=function(e){for(let t=e.length-1;t>0;t--){const n=o(0,t),r=e[t];e[t]=e[n],e[n]=r}},t.max=function(e){if(0===e.length)throw new RangeError;let t=e[0];for(let n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t},t.maxValueIndex=function(e){if(0===e.length)throw new RangeError;let t=e[0],n=0;for(let o=1;o<e.length;o++)e[o]>t&&(t=e[o],n=o);return n},t.minValueIndex=function(e){if(0===e.length)throw new RangeError;let t=e[0],n=0;for(let o=1;o<e.length;o++)e[o]<t&&(t=e[o],n=o);return n},t.min=function(e){if(0===e.length)throw new RangeError;let t=e[0];for(let n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t},t.avg=function(e){return r(e)/e.length},t.sum=r,t.generateGaussian=function(e=0,t=2){let n=0;for(let e=0;e<10;e++)n+=Math.random();return t*n/10+e-.5*t},t.pairing=function(e,t){if(e<0||t<0)throw new RangeError("Should be a positive integer!");return.5*(e+t)*(e+t+1)+t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return a}));const o=Symbol("thread.errors"),r=Symbol("thread.events"),i=Symbol("thread.terminate"),s=Symbol("thread.transferable"),a=Symbol("thread.worker")},function(e,t,n){"use strict";var o,r;n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),function(e){e.run="run"}(o||(o={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;const o=n(3),r=n(2),i=n(16),s=n(7),a=n(34);t.Node=class{constructor(e=r.NodeType.HIDDEN){this.type=e,this.bias=s.randDouble(-1,1),this.squash=o.Logistic,this.activation=0,this.derivativeState=1,this.state=0,this.prevState=0,this.mask=1,this.deltaBiasPrevious=0,this.deltaBiasTotal=0,this.incoming=new Set,this.outgoing=new Set,this.gated=new Set,this.selfConnection=new a.Connection(this,this,0),this.errorResponsibility=0,this.errorProjected=0,this.errorGated=0,this.index=NaN}fromJSON(e){return this.bias=e.bias,this.type=e.type,this.squash=o.ALL_ACTIVATIONS.filter(t=>t.name===e.squash)[0],this.mask=e.mask,this.index=e.index,this.errorResponsibility=e.errorResponsibility,this.errorProjected=e.errorProjected,this.errorGated=e.errorGated,this.deltaBiasPrevious=e.deltaBiasPrevious,this.deltaBiasTotal=e.deltaBiasTotal,this.derivativeState=e.derivativeState,this.state=e.state,this.prevState=e.prevState,this.activation=e.activation,this}clear(){this.incoming.forEach(e=>{e.eligibility=0,e.xTrace.clear()}),this.gated.forEach(e=>e.gain=0),this.errorResponsibility=this.errorProjected=this.errorGated=0,this.prevState=this.state=this.activation=0}mutateBias(e=new i.ModBiasMutation){this.bias+=s.randDouble(e.min,e.max)}mutateActivation(e=Object.values(o.ALL_ACTIVATIONS)){const t=e.filter(e=>e!==this.squash);t.length>0&&(this.squash=s.pickRandom(t))}isProjectedBy(e){return e===this?0!==this.selfConnection.weight:Array.from(this.incoming).map(e=>e.from).includes(e)}isProjectingTo(e){return e===this?0!==this.selfConnection.weight:Array.from(this.outgoing).map(e=>e.to).includes(e)}addGate(e){this.gated.add(e),e.gateNode=this}removeGate(e){this.gated.delete(e),e.gateNode=null,e.gain=1}connect(e,t=1,n=!1){if(e===this)return this.selfConnection.weight=t,this.selfConnection;if(this.isProjectingTo(e))throw new ReferenceError("There is already a connection!");{const o=new a.Connection(this,e,t);return this.outgoing.add(o),e.incoming.add(o),n&&e.connect(this),o}}disconnect(e,t=!1){if(e===this)return this.selfConnection.weight=0,this.selfConnection;const n=Array.from(this.outgoing).filter(t=>t.to===e);if(0===n.length)throw new Error("No Connection found");const o=n[0];return this.outgoing.delete(o),o.to.incoming.delete(o),void 0!==o.gateNode&&null!==o.gateNode&&o.gateNode.removeGate(o),t&&e.disconnect(this),o}propagate(e,t={}){var n,o,r;t.momentum=null!==(n=t.momentum)&&void 0!==n?n:0,t.rate=null!==(o=t.rate)&&void 0!==o?o:.3,t.update=null===(r=t.update)||void 0===r||r,void 0!==e&&Number.isFinite(e)?this.errorResponsibility=this.errorProjected=e-this.activation:(this.errorProjected=0,this.outgoing.forEach(e=>{this.errorProjected+=e.to.errorResponsibility*e.weight*e.gain}),this.errorProjected*=this.derivativeState,this.errorGated=0,this.gated.forEach(e=>{let t;t=e.to.selfConnection.gateNode===this?e.to.prevState+e.weight*e.from.activation:e.weight*e.from.activation,this.errorGated+=e.to.errorResponsibility*t}),this.errorGated*=this.derivativeState,this.errorResponsibility=this.errorProjected+this.errorGated),this.incoming.forEach(e=>{var n,o;let r=this.errorProjected*e.eligibility;e.xTrace.forEach((e,t)=>r+=t.errorResponsibility*e),e.deltaWeightsTotal+=(null!==(n=t.rate)&&void 0!==n?n:.3)*r*this.mask,t.update&&(e.deltaWeightsTotal+=(null!==(o=t.momentum)&&void 0!==o?o:0)*e.deltaWeightsPrevious,e.weight+=e.deltaWeightsTotal,e.deltaWeightsPrevious=e.deltaWeightsTotal,e.deltaWeightsTotal=0)}),this.deltaBiasTotal+=t.rate*this.errorResponsibility,t.update&&(this.deltaBiasTotal+=t.momentum*this.deltaBiasPrevious,this.bias+=this.deltaBiasTotal,this.deltaBiasPrevious=this.deltaBiasTotal,this.deltaBiasTotal=0)}activate(e,t=!0){if(void 0!==e)return this.activation=e;if(this.isInputNode())throw new ReferenceError("There is no input given to an input node!");if(t){this.prevState=this.state,this.state=this.selfConnection.gain*this.selfConnection.weight*this.state+this.bias,this.incoming.forEach(e=>{this.state+=e.from.activation*e.weight*e.gain}),this.activation=this.squash(this.state,!1)*this.mask,this.derivativeState=this.squash(this.state,!0);const e=[],t=[];return this.gated.forEach(n=>{n.gain=this.activation;const o=e.indexOf(n.to);o>-1?t[o]+=n.weight*n.from.activation:(e.push(n.to),n.to.selfConnection.gateNode===this?t.push(n.weight*n.from.activation+n.to.prevState):t.push(n.weight*n.from.activation))}),this.incoming.forEach(n=>{var o;n.eligibility=this.selfConnection.gain*this.selfConnection.weight*n.eligibility+n.from.activation*n.gain;for(let r=0;r<e.length;r++){const i=e[r],s=t[r];n.xTrace.has(i)?n.xTrace.set(i,i.selfConnection.gain*i.selfConnection.weight*(null!==(o=n.xTrace.get(i))&&void 0!==o?o:0)+this.derivativeState*n.eligibility*s):n.xTrace.set(i,this.derivativeState*n.eligibility*s)}}),this.activation}return this.isInputNode()?this.activation=0:(this.state=this.selfConnection.gain*this.selfConnection.weight*this.state+this.bias,this.incoming.forEach(e=>this.state+=e.from.activation*e.weight*e.gain),this.activation=this.squash(this.state,!1),this.gated.forEach(e=>e.gain=this.activation),this.activation)}toJSON(){return{bias:this.bias,type:this.type,squash:this.squash.name,mask:this.mask,index:this.index,errorResponsibility:this.errorResponsibility,errorProjected:this.errorProjected,errorGated:this.errorGated,deltaBiasPrevious:this.deltaBiasPrevious,deltaBiasTotal:this.deltaBiasTotal,derivativeState:this.derivativeState,state:this.state,prevState:this.prevState,activation:this.activation}}isInputNode(){return this.type===r.NodeType.INPUT}isHiddenNode(){return this.type===r.NodeType.HIDDEN}isOutputNode(){return this.type===r.NodeType.OUTPUT}setBias(e){return this.bias=e,this}setActivationType(e){return this.squash=e,this}}},function(e,t,n){"use strict";t.a={isWorkerRuntime:function(){return!("undefined"==typeof self||!self.postMessage)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}},function(e,t,n){(function(o){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(o++,"%c"===e&&(r=o))}),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(57)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(18))},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const o=()=>"function"==typeof Symbol,r=e=>o()&&Boolean(Symbol[e]),i=e=>r(e)?Symbol[e]:"@@"+e;r("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"))},function(e,t,n){"use strict";n.r(t),n.d(t,"filter",(function(){return c})),n.d(t,"flatMap",(function(){return h})),n.d(t,"interval",(function(){return f})),n.d(t,"map",(function(){return m})),n.d(t,"merge",(function(){return y})),n.d(t,"multicast",(function(){return g.a})),n.d(t,"Observable",(function(){return i.b})),n.d(t,"scan",(function(){return b})),n.d(t,"Subject",(function(){return w.a})),n.d(t,"unsubscribe",(function(){return s.a}));var o=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}c((o=o.apply(e,t||[])).next())}))};class r{constructor(e){this._baseObserver=e,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(e=>this._baseObserver.error(e))}error(e){this._baseObserver.error(e)}schedule(e){const t=Promise.all(this._pendingPromises),n=[],r=e=>n.push(e),i=Promise.resolve().then(()=>o(this,void 0,void 0,(function*(){yield t,yield e(r),this._pendingPromises.delete(i);for(const e of n)this._baseObserver.next(e)}))).catch(e=>{this._pendingPromises.delete(i),this._baseObserver.error(e)});this._pendingPromises.add(i)}}var i=n(1),s=n(6),a=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}c((o=o.apply(e,t||[])).next())}))};var c=function(e){return t=>new i.b(n=>{const o=new r(n),i=t.subscribe({complete(){o.complete()},error(e){o.error(e)},next(t){o.schedule(n=>a(this,void 0,void 0,(function*(){(yield e(t))&&n(t)})))}});return()=>Object(s.a)(i)})},u=n(13);var l=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}c((o=o.apply(e,t||[])).next())}))},d=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){(function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)})(o,r,(t=e[n](t)).done,t.value)}))}}};var h=function(e){return t=>new i.b(n=>{const o=new r(n),i=t.subscribe({complete(){o.complete()},error(e){o.error(e)},next(t){o.schedule(n=>l(this,void 0,void 0,(function*(){var o,r;const i=yield e(t);if((c=i)&&Object(u.b)("iterator")&&c[Symbol.iterator]||function(e){return e&&Object(u.b)("asyncIterator")&&e[Symbol.asyncIterator]}(i))try{for(var s,a=d(i);!(s=yield a.next()).done;){const e=s.value;n(e)}}catch(e){o={error:e}}finally{try{s&&!s.done&&(r=a.return)&&(yield r.call(a))}finally{if(o)throw o.error}}else i.map(e=>n(e));var c})))}});return()=>Object(s.a)(i)})};function f(e){return new i.a(t=>{let n=0;const o=setInterval(()=>{t.next(n++)},e);return()=>clearInterval(o)})}var p=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}c((o=o.apply(e,t||[])).next())}))};var m=function(e){return t=>new i.b(n=>{const o=new r(n),i=t.subscribe({complete(){o.complete()},error(e){o.error(e)},next(t){o.schedule(n=>p(this,void 0,void 0,(function*(){const o=yield e(t);n(o)})))}});return()=>Object(s.a)(i)})};var y=function(...e){return 0===e.length?i.a.from([]):new i.a(t=>{let n=0;const o=e.map(o=>o.subscribe({error(e){t.error(e),r()},next(e){t.next(e)},complete(){++n===e.length&&(t.complete(),r())}})),r=()=>{o.forEach(e=>Object(s.a)(e))};return r})},g=n(38),v=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}c((o=o.apply(e,t||[])).next())}))};var b=function(e,t){return n=>new i.b(o=>{let i,a=0;const c=new r(o),u=n.subscribe({complete(){c.complete()},error(e){c.error(e)},next(n){c.schedule(o=>v(this,void 0,void 0,(function*(){const r=0===a?void 0===t?n:t:i;i=yield e(r,n,a++),o(i)})))}});return()=>Object(s.a)(u)})},w=n(30)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var o=n(8);function r(e){return e&&"object"==typeof e&&e[o.d]}function i(e,t){if(!t){if(!(n=e)||"object"!=typeof n)throw Error();t=[e]}var n;return{[o.d]:!0,send:e,transferables:t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwapNodesMutation=t.SubBackConnectionMutation=t.AddBackConnectionMutation=t.SubSelfConnectionMutation=t.AddSelfConnectionMutation=t.SubGateMutation=t.AddGateMutation=t.ModActivationMutation=t.ModBiasMutation=t.ModWeightMutation=t.SubConnectionMutation=t.AddConnectionMutation=t.SubNodeMutation=t.AddNodeMutation=t.Mutation=t.ONLY_STRUCTURE=t.NO_STRUCTURE_MUTATIONS=t.FEEDFORWARD_MUTATIONS=t.ALL_MUTATIONS=void 0;const o=n(10),r=n(2),i=n(7);class s{}t.Mutation=s;class a extends s{constructor(e=!0){super(),this.randomActivation=e}mutate(e,t={}){if(void 0!==t.maxNodes&&e.nodes.length>=t.maxNodes)return;const n=new o.Node(r.NodeType.HIDDEN);this.randomActivation&&n.mutateActivation();const s=i.pickRandom(Array.from(e.connections)),a=s.from,c=s.to;e.disconnect(a,c);const u=Math.max(e.inputSize,1+e.nodes.indexOf(a));e.nodes.splice(u,0,n);const l=e.connect(a,n,1),d=e.connect(n,c,s.weight);null!==s.gateNode&&(i.randBoolean()?e.addGate(s.gateNode,l):e.addGate(s.gateNode,d))}}t.AddNodeMutation=a;class c extends s{constructor(e=!0){super(),this.keepGates=e}mutate(e){const t=e.nodes.filter(e=>void 0!==e&&e.isHiddenNode());t.length>0&&e.removeNode(i.pickRandom(t),this.keepGates)}}t.SubNodeMutation=c;class u extends s{mutate(e,t={}){if(void 0!==t.maxConnections&&e.connections.size>=t.maxConnections)return;const n=[];for(let t=0;t<e.nodes.length-e.outputSize;t++){const o=e.nodes[t];for(let r=Math.max(t+1,e.inputSize);r<e.nodes.length;r++){const t=e.nodes[r];o.isProjectingTo(t)||n.push([o,t])}}if(n.length>0){const t=i.pickRandom(n);e.connect(t[0],t[1])}}}t.AddConnectionMutation=u;class l extends s{mutate(e){const t=Array.from(e.connections).filter(e=>e.from.outgoing.size>1).filter(e=>e.to.incoming.size>1).filter(t=>e.nodes.indexOf(t.to)>e.nodes.indexOf(t.from));if(t.length>0){const n=i.pickRandom(t);e.disconnect(n.from,n.to)}}}t.SubConnectionMutation=l;class d extends s{constructor(e=-1,t=1){super(),this.min=e,this.max=t}mutate(e){i.pickRandom(Array.from(e.connections)).weight+=i.randDouble(this.min,this.max)}}t.ModWeightMutation=d;class h extends s{constructor(e=-1,t=1){super(),this.min=e,this.max=t}mutate(e){i.pickRandom(e.nodes.filter(e=>!e.isInputNode())).mutateBias(this)}}t.ModBiasMutation=h;class f extends s{constructor(e=!1){super(),this.mutateOutput=e}mutate(e,t={}){const n=this.mutateOutput?e.nodes.filter(e=>!e.isInputNode()):e.nodes.filter(e=>e.isHiddenNode());n.length>0&&i.pickRandom(n).mutateActivation(t.allowedActivations)}}t.ModActivationMutation=f;class p extends s{mutate(e){const t=e.nodes.filter(e=>!e.isInputNode()).filter(e=>0===e.selfConnection.weight);if(t.length>0){const n=i.pickRandom(t);e.connect(n,n)}}}t.AddSelfConnectionMutation=p;class m extends s{mutate(e){const t=Array.from(e.connections).filter(e=>e.from===e.to);if(t.length>0){const n=i.pickRandom(t);e.disconnect(n.from,n.to)}}}t.SubSelfConnectionMutation=m;class y extends s{mutate(e,t={}){if(void 0!==t.maxGates&&e.gates.size>=t.maxGates)return;const n=Array.from(e.connections).filter(e=>null===e.gateNode);if(n.length>0){const t=i.pickRandom(e.nodes.filter(e=>!e.isInputNode())),o=i.pickRandom(n);e.addGate(t,o)}}}t.AddGateMutation=y;class g extends s{mutate(e){e.gates.size>0&&e.removeGate(i.pickRandom(Array.from(e.gates)))}}t.SubGateMutation=g;class v extends s{mutate(e){const t=[];for(let n=e.inputSize;n<e.nodes.length;n++){const o=e.nodes[n];for(let r=e.inputSize;r<n;r++){const n=e.nodes[r];o.isProjectingTo(n)||t.push([o,n])}}if(t.length>0){const n=i.pickRandom(t);e.connect(n[0],n[1])}}}t.AddBackConnectionMutation=v;class b extends s{mutate(e){const t=Array.from(e.connections).filter(e=>e.from.outgoing.size>1).filter(e=>e.to.incoming.size>1).filter(t=>e.nodes.indexOf(t.from)>e.nodes.indexOf(t.to));if(t.length>0){const n=i.pickRandom(t);e.disconnect(n.from,n.to)}}}t.SubBackConnectionMutation=b;class w extends s{constructor(e=!1){super(),this.mutateOutput=e}mutate(e){const t=this.mutateOutput?e.nodes.filter(e=>void 0!==e&&!e.isInputNode()):e.nodes.filter(e=>void 0!==e&&e.isHiddenNode());if(t.length>=2){const e=i.pickRandom(t),n=i.pickRandom(t.filter(t=>t!==e)),o=e.bias,r=e.squash;e.bias=n.bias,e.squash=n.squash,n.bias=o,n.squash=r}}}t.SwapNodesMutation=w;const T=[new a,new c,new u,new l,new d,new h,new f,new y,new g,new p,new m,new v,new b,new w];t.ALL_MUTATIONS=T;const O=[new a,new c,new u,new l,new d,new h,new f,new w];t.FEEDFORWARD_MUTATIONS=O;const N=[new d,new h,new f];t.NO_STRUCTURE_MUTATIONS=N;const L=[new a,new c,new u,new l,new y,new g,new p,new m,new v,new b,new w];t.ONLY_STRUCTURE=L},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConstantNode=void 0;const o=n(2),r=n(10);class i extends r.Node{constructor(){super(o.NodeType.HIDDEN),this.bias=1}fromJSON(e){var t;return this.index=null!==(t=e.index)&&void 0!==t?t:-1,this}toJSON(){return super.toJSON()}mutateBias(){throw new ReferenceError("Cannot mutate a pool node!")}mutateActivation(){throw new ReferenceError("Cannot mutate a pool node!")}addGate(){throw new ReferenceError("A pool node can't gate a connection!")}removeGate(){throw new ReferenceError("A pool node can't gate a connection!")}setBias(){throw new ReferenceError("Cannot set the bias of a pool node!")}}t.ConstantNode=i},function(e,t){var n,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var c,u=[],l=!1,d=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(41);let r=o.DefaultSerializer;t.registerSerializer=function(e){r=o.extendSerializer(r,e)},t.deserialize=function(e){return r.deserialize(e)},t.serialize=function(e){return r.serialize(e)}},function(e,t,n){"use strict";function o(e,t){const n=e.deserialize.bind(e),o=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,n),serialize:e=>t.serialize(e,o)}}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));const r={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})},i={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r.deserialize(e):e;var t},serialize:e=>e instanceof Error?r.serialize(e):e}},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(o||(o={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GatingType=void 0,function(e){e[e.INPUT=0]="INPUT",e[e.SELF=1]="SELF",e[e.OUTPUT=2]="OUTPUT"}(t.GatingType||(t.GatingType={}))},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Network=void 0;const a=n(90),c=n(62),u=i(n(26)),l=n(2),d=n(45),h=n(27),f=n(16),p=n(76),m=n(7),y=n(10);class g{constructor(e,t){this.inputSize=e,this.outputSize=t,this.nodes=[],this.connections=new Set,this.gates=new Set,this.score=void 0,this.species=null;for(let t=0;t<e;t++)this.nodes.push(new y.Node(l.NodeType.INPUT));for(let e=0;e<t;e++)this.nodes.push(new y.Node(l.NodeType.OUTPUT));for(let e=0;e<this.inputSize;e++)for(let t=this.inputSize;t<this.outputSize+this.inputSize;t++){const n=(Math.random()-.5)*this.inputSize*Math.sqrt(2/this.inputSize);this.connect(this.nodes[e],this.nodes[t],n)}}static fromJSON(e){const t=new g(e.inputSize,e.outputSize);return t.nodes=[],t.connections.clear(),e.nodes.map(e=>(new y.Node).fromJSON(e)).forEach(e=>t.nodes[e.index]=e),e.connections.forEach(e=>{var n;const o=t.connect(t.nodes[e.fromIndex],t.nodes[e.toIndex],e.weight);null===(n=e.xTraces)||void 0===n||n.forEach((e,n)=>{o.xTrace.set(t.nodes[n],e)}),null!==e.gateNodeIndex&&t.addGate(t.nodes[e.gateNodeIndex],o)}),t}static crossOver(e,t){var n,o;if(e.inputSize!==t.inputSize||e.outputSize!==t.outputSize)throw new Error("Networks don`t have the same input/output size!");const r=new g(e.inputSize,e.outputSize);r.connections.clear(),r.nodes=[];const i=null!==(n=e.score)&&void 0!==n?n:0,s=null!==(o=t.score)&&void 0!==o?o:0;let a;if(i===s){const n=Math.max(e.nodes.length,t.nodes.length),o=Math.min(e.nodes.length,t.nodes.length);a=m.randInt(o,n+1)}else a=i>s?e.nodes.length:t.nodes.length;const c=e.inputSize,u=e.outputSize;for(let t=0;t<e.nodes.length;t++)e.nodes[t].index=t;for(let e=0;e<t.nodes.length;e++)t.nodes[e].index=e;for(let n=0;n<a;n++){let o,i=null;if(n<c){i=l.NodeType.INPUT;const r=m.randBoolean()?e:t;let s=-1,a=-1;for(;s<n;){if(a++>=r.nodes.length)throw RangeError("something is wrong with the size of the input");r.nodes[a].isInputNode()&&s++}o=r.nodes[a]}else if(n<c+u){i=l.NodeType.OUTPUT;const r=m.randBoolean()?e:t;let s=-1,a=-1;for(;s<n-c;){if(a++,a>=r.nodes.length)throw RangeError("something is wrong with the size of the output");r.nodes[a].isOutputNode()&&s++}o=r.nodes[a]}else{let r;i=l.NodeType.HIDDEN,r=n>=e.nodes.length?t:n>=t.nodes.length||m.randBoolean()?e:t,o=m.pickRandom(r.nodes)}const s=new y.Node(i);s.bias=o.bias,s.squash=o.squash,r.nodes.push(s)}const d=[],h=[];e.connections.forEach(e=>{d[m.pairing(e.from.index,e.to.index)]=e.toJSON()}),t.connections.forEach(e=>{h[m.pairing(e.from.index,e.to.index)]=e.toJSON()});const f=[],p=Object.keys(d),v=Object.keys(h);for(let e=p.length-1;e>=0;e--)void 0!==h[parseInt(p[e])]?(f.push(m.randBoolean()?d[parseInt(p[e])]:h[parseInt(p[e])]),h[parseInt(p[e])]=void 0):i>=s&&f.push(d[parseInt(p[e])]);return s>=i&&v.map(e=>parseInt(e)).map(e=>h[e]).filter(e=>void 0!==e).forEach(e=>f.push(e)),f.forEach(e=>{if(void 0!==e&&e.toIndex<a&&e.fromIndex<a){const t=r.nodes[e.fromIndex],n=r.nodes[e.toIndex],o=r.connect(t,n,e.weight);null!==e.gateNodeIndex&&e.gateNodeIndex<a&&r.addGate(r.nodes[e.gateNodeIndex],o)}}),r}deepCopy(){return g.fromJSON(this.toJSON())}connect(e,t,n=0){const o=e.connect(t,n);return this.connections.add(o),o}activate(e,t={}){var n,o;if(e.length!==this.inputSize)throw new RangeError("Input size of dataset is different to network input size!");return t.dropoutRate=null!==(n=t.dropoutRate)&&void 0!==n?n:0,t.trace=null===(o=t.trace)||void 0===o||o,this.nodes.filter(e=>e.isInputNode()).forEach((n,o)=>n.activate(e[o],t.trace)),this.nodes.filter(e=>e.isHiddenNode()).forEach(e=>{t.dropoutRate&&(e.mask=Math.random()>=t.dropoutRate?1:0),e.activate(void 0,t.trace)}),this.nodes.filter(e=>e.isOutputNode()).map(e=>e.activate(void 0,t.trace))}propagate(e,t={}){var n,o,r;if(t.rate=null!==(n=t.rate)&&void 0!==n?n:.3,t.momentum=null!==(o=t.momentum)&&void 0!==o?o:0,t.update=null!==(r=t.update)&&void 0!==r&&r,e.length!==this.outputSize)throw new Error("Output target length should match network output length");this.nodes.filter(e=>e.isOutputNode()).forEach((n,o)=>n.propagate(e[o],t));for(let e=this.nodes.length-1;e>=0;e--)this.nodes[e].isHiddenNode()&&this.nodes[e].propagate(void 0,t);this.nodes.filter(e=>e.isInputNode()).forEach(e=>e.propagate(void 0,t))}clear(){this.nodes.forEach(e=>e.clear())}disconnect(e,t){return this.connections.forEach(n=>{n.from===e&&n.to===t&&(null!==n.gateNode&&this.removeGate(n),this.connections.delete(n))}),e.disconnect(t)}addGate(e,t){if(-1===this.nodes.indexOf(e))throw new ReferenceError("This node is not part of the network!");null===t.gateNode&&(e.addGate(t),this.gates.add(t))}removeGate(e){if(!this.gates.has(e))throw new Error("This connection is not gated!");this.gates.delete(e),null!==e.gateNode&&e.gateNode.removeGate(e)}removeNode(e,t=(new f.SubNodeMutation).keepGates){if(!this.nodes.includes(e))throw new ReferenceError("This node does not exist in the network!");this.disconnect(e,e);const n=[],o=[],r=[],i=[];for(e.incoming.forEach(r=>{t&&null!==r.gateNode&&r.gateNode!==e&&o.push(r.gateNode),n.push(r.from),this.disconnect(r.from,e)}),e.outgoing.forEach(n=>{t&&null!==n.gateNode&&n.gateNode!==e&&o.push(n.gateNode),r.push(n.to),this.disconnect(e,n.to)}),n.forEach(e=>{r.forEach(t=>{e.isProjectingTo(t)||i.push(this.connect(e,t))})});o.length>0&&i.length>0;){const e=o.shift();if(void 0===e)continue;const t=m.pickRandom(i);this.addGate(e,t),m.removeFromArray(i,t)}e.gated.forEach(this.removeGate),m.removeFromArray(this.nodes,e)}mutate(e,t){e.mutate(this,t)}mutateRandom(e=f.ALL_MUTATIONS,t={}){0!==e.length&&this.mutate(m.pickRandom(e),t)}train(e){if(e.dataset[0].input.length!==this.inputSize||e.dataset[0].output.length!==this.outputSize)throw new Error("Dataset input/output size should be same as network input/output size!");const t=Date.now();if(e.iterations<=0&&e.error<=0)throw new Error("At least one of the following options must be specified: error, iterations");let n,o,r,i;e.crossValidateTestSize>0?(n=Math.ceil((1-e.crossValidateTestSize)*e.dataset.length),o=e.dataset.slice(0,n),r=e.dataset.slice(n)):(o=e.dataset,r=[]);let s=0,a=1;for(;a>e.error&&(e.iterations<=0||s<e.iterations);)s++,i=e.rate.calc(s),a=this.trainEpoch({dataset:o,batchSize:e.batchSize,trainingRate:i,momentum:e.momentum,loss:e.loss,dropoutRate:e.dropout}),e.clear&&this.clear(),e.crossValidateTestSize>0&&(a=this.test(r,e.loss),e.clear&&this.clear()),e.shuffle&&m.shuffle(e.dataset),e.log>0&&s%e.log==0&&console.log("iteration number",s,"error",a,"training rate",i),e.schedule&&s%e.schedule.iterations==0&&e.schedule.function(a,s);return e.clear&&this.clear(),{error:a,iterations:s,time:Date.now()-t}}test(e,t=h.MSELoss){let n=0;for(const o of e){const e=o.input;n+=t(o.output,this.activate(e,{trace:!1}))}return n/e.length}toJSON(){const e={nodes:[],connections:[],inputSize:this.inputSize,outputSize:this.outputSize};for(let e=0;e<this.nodes.length;e++)this.nodes[e].index=e;return this.nodes.forEach(t=>{e.nodes.push(t.toJSON()),0!==t.selfConnection.weight&&e.connections.push(t.selfConnection.toJSON())}),this.connections.forEach(t=>{e.connections.push(t.toJSON())}),e}evolve(e=new d.EvolveOptions){return s(this,void 0,void 0,(function*(){if(!e.fitnessFunction&&e.dataset&&(e.dataset[0].input.length!==this.inputSize||e.dataset[0].output.length!==this.outputSize))throw new Error("Dataset input/output size should be same as network input/output size!");e.input=this.inputSize,e.output=this.outputSize;const t=Date.now();let n=null;if(!e.fitnessFunction){const t=JSON.stringify(e.dataset),o=Object.values(h.ALL_LOSSES).indexOf(e.loss);n=c.Pool(()=>a.spawn(new a.Worker("../multithreading/TestWorker")),e.threads),e.fitnessFunction=function(e){return s(this,void 0,void 0,(function*(){for(const r of e)n&&n.queue(e=>s(this,void 0,void 0,(function*(){if(void 0===r)throw new ReferenceError;r.score=-(yield e(t,JSON.stringify(r.toJSON()),o))})));n&&(yield n.completed())}))}}e.template=this;const o=new p.NEAT(e);let r,i=0,u=null;do{const t=yield o.evolve();if(!t.score)throw new ReferenceError;r=t.score,(1===o.options.generation||t.score>i)&&(i=t.score,u=t),e.schedule&&o.options.generation%e.schedule.iterations==0&&e.schedule.function(t.score,-r,o.options.generation)}while(r<-e.error&&(0===e.iterations||o.options.generation<e.iterations));return u&&(this.nodes=u.nodes,this.connections=u.connections,this.gates=u.gates,e.clear&&this.clear()),null!==n&&(yield n.terminate()),{error:-r,iterations:o.options.generation,time:Date.now()-t}}))}distance(e,t,n,o){for(let e=0;e<this.nodes.length;e++)this.nodes[e].index=e;for(let t=0;t<e.nodes.length;t++)e.nodes[t].index=t;let r=0,i=0;const s=Array.from(this.connections).filter(e=>void 0!==e),a=Array.from(e.connections).filter(e=>void 0!==e);u.sort(s,(e,t)=>e.getInnovationID()-t.getInnovationID()),u.sort(a,(e,t)=>e.getInnovationID()-t.getInnovationID());if(s[s.length-1].getInnovationID()<a[a.length-1].getInnovationID())return e.distance(this,t,n,o);let c=0,l=0,d=0;for(;r<s.length&&i<a.length;){const e=s[r],t=a[i];if(void 0===e||void 0===t)throw Error("HERE");e.getInnovationID()===t.getInnovationID()?(r++,i++,l+=Math.abs(e.weight-t.weight),d++):r>i?(i++,c++):(r++,c++)}l/=d;const h=this.connections.size-r;let f=Math.max(this.connections.size,e.connections.size);return f<20&&(f=1),t*h/f+n*c/f+o*l}trainEpoch(e){let t=0;for(let n=0;n<e.dataset.length;n++){const o=e.dataset[n].input,r=e.dataset[n].output,i=(n+1)%e.batchSize==0||n+1===e.dataset.length,s=this.activate(o,{dropoutRate:e.dropoutRate});this.propagate(r,{rate:e.trainingRate,momentum:e.momentum,update:i}),t+=e.loss(r,s)}return t/e.dataset.length}}t.Network=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.$errors=Symbol("thread.errors"),t.$events=Symbol("thread.events"),t.$terminate=Symbol("thread.terminate"),t.$transferable=Symbol("thread.transferable"),t.$worker=Symbol("thread.worker")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(24);t.isTransferDescriptor=function(e){return e&&"object"==typeof e&&e[o.$transferable]},t.Transfer=function(e,t){if(!t){if(!(n=e)||"object"!=typeof n)throw Error();t=[e]}var n;return{[o.$transferable]:!0,send:e,transferables:t}}},function(e,t,n){e.exports=n(75)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ALL_LOSSES=t.HINGELoss=t.MSLELoss=t.WAPELoss=t.MAPELoss=t.MAELoss=t.BinaryLoss=t.MBELoss=t.MSELoss=void 0;const o=n(7);t.MSELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.pow(e[o]-t,2)}),n/t.length},t.MBELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=e[o]-t}),n/t.length},t.BinaryLoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.round(2*e[o])!==Math.round(2*t)?1:0}),n/t.length},t.MAELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.abs(e[o]-t)}),n/t.length},t.MAPELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.abs((t-e[o])/Math.max(e[o],1e-15))}),n/t.length},t.WAPELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.abs(e[o]-t)}),n/o.sum(e)},t.MSLELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.log(Math.max(e[o],1e-15))-Math.log(Math.max(t,1e-15))}),n/t.length},t.HINGELoss=function(e,t){let n=0;return t.forEach((t,o)=>{n+=Math.max(0,1-t*e[o])}),n/t.length},t.ALL_LOSSES={MSELoss:t.MSELoss,MBELoss:t.MBELoss,BinaryLoss:t.BinaryLoss,MAELoss:t.MAELoss,MAPELoss:t.MAPELoss,WAPELoss:t.WAPELoss,MSLELoss:t.MSLELoss,HINGELoss:t.HINGELoss}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoolNode=void 0;const o=n(2),r=n(7),i=n(17);class s extends i.ConstantNode{constructor(e=o.PoolNodeType.MAX_POOLING){super(),this.poolingType=e,this.receivingNode=null}fromJSON(e){return super.fromJSON(e),this.poolingType=e.poolType,this}activate(){const e=Array.from(this.incoming),t=e.map(e=>e.from.activation*e.weight*e.gain);if(this.poolingType===o.PoolNodeType.MAX_POOLING){const n=r.maxValueIndex(t);this.receivingNode=e[n].from,this.state=t[n]}else if(this.poolingType===o.PoolNodeType.AVG_POOLING)this.state=r.avg(t);else{if(this.poolingType!==o.PoolNodeType.MIN_POOLING)throw new ReferenceError("No valid pooling type! Type: "+this.poolingType);{const n=r.minValueIndex(t);this.receivingNode=e[n].from,this.state=t[n]}}return this.activation=this.squash(this.state,!1)*this.mask,this.poolingType===o.PoolNodeType.AVG_POOLING&&(this.derivativeState=this.squash(this.state,!0)),this.gated.forEach(e=>e.gain=this.activation),this.activation}propagate(e,t={}){var n,i,s;t.momentum=null!==(n=t.momentum)&&void 0!==n?n:0,t.rate=null!==(i=t.rate)&&void 0!==i?i:.3,t.update=null===(s=t.update)||void 0===s||s;const a=Array.from(this.outgoing).map(e=>e.to.errorResponsibility*e.weight*e.gain);this.errorResponsibility=this.errorProjected=r.sum(a)*this.derivativeState,this.poolingType===o.PoolNodeType.AVG_POOLING?this.incoming.forEach(e=>{var n,o;let r=this.errorProjected*e.eligibility;e.xTrace.forEach((e,t)=>{r+=t.errorResponsibility*e}),e.deltaWeightsTotal+=(null!==(n=t.rate)&&void 0!==n?n:.3)*r*this.mask,t.update&&(e.deltaWeightsTotal+=(null!==(o=t.momentum)&&void 0!==o?o:0)*e.deltaWeightsPrevious,e.weight+=e.deltaWeightsTotal,e.deltaWeightsPrevious=e.deltaWeightsTotal,e.deltaWeightsTotal=0)}):this.incoming.forEach(e=>{e.weight=this.receivingNode===e.from?1:0,e.gain=this.receivingNode===e.from?1:0})}toJSON(){return Object.assign(super.toJSON(),{poolType:this.poolingType})}}t.PoolNode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoolingLayer=void 0;const o=n(4),r=n(5);class i extends r.Layer{constructor(e){super(e)}getDefaultIncomingConnectionType(){return o.ConnectionType.POOLING}connectionTypeisAllowed(){return!0}}t.PoolingLayer=i},function(e,t,n){"use strict";var o=n(1);class r extends o.b{constructor(){super(e=>(this._observers.add(e),()=>this._observers.delete(e))),this._observers=new Set}next(e){for(const t of this._observers)t.next(e)}error(e){for(const t of this._observers)t.error(e)}complete(){for(const e of this._observers)e.complete()}}t.a=r},function(e,t,n){"use strict";const o=n(59).default;e.exports=e=>Boolean(e&&e[o]&&e===e[o]())},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return b}));var o=n(12),r=n.n(o),i=n(1),s=n(38),a=n(0);const c=()=>{},u=e=>e,l=e=>Promise.resolve().then(e);function d(e){throw e}class h extends i.b{constructor(e){super(t=>{const n=this,o=Object.assign(Object.assign({},t),{complete(){t.complete(),n.onCompletion()},error(e){t.error(e),n.onError(e)},next(e){t.next(e),n.onNext(e)}});try{return this.initHasRun=!0,e(o)}catch(e){o.error(e)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)l(()=>t(e))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)l(()=>e(this.firstValue))}then(e,t){const n=e||u,o=t||d;let r=!1;return new Promise((e,t)=>{const i=n=>{if(!r){r=!0;try{e(o(n))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:i}),"fulfilled"===this.state?e(n(this.firstValue)):"rejected"===this.state?(r=!0,e(o(this.rejection))):(this.fulfillmentCallbacks.push(t=>{try{e(n(t))}catch(e){i(e)}}),void this.rejectionCallbacks.push(i))})}catch(e){return this.then(void 0,e)}finally(e){const t=e||c;return this.then(e=>(t(),e),()=>t())}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new h(t=>{e.then(e=>{t.next(e),t.complete()},e=>{t.error(e)})}):super.from(e)}}var f=n(15),p=n(9);const m=r()("threads:master:messages");let y=1;function g(e,t){return new i.b(n=>{let o;const r=i=>{var s;if(m("Message from worker:",i.data),i.data&&i.data.uid===t)if((s=i.data)&&s.type===p.b.running)o=i.data.resultType;else if((e=>e&&e.type===p.b.result)(i.data))"promise"===o?(void 0!==i.data.payload&&n.next(Object(a.a)(i.data.payload)),n.complete(),e.removeEventListener("message",r)):(i.data.payload&&n.next(Object(a.a)(i.data.payload)),i.data.complete&&(n.complete(),e.removeEventListener("message",r)));else if((e=>e&&e.type===p.b.error)(i.data)){const t=Object(a.a)(i.data.error);n.error(t),e.removeEventListener("message",r)}};return e.addEventListener("message",r),()=>e.removeEventListener("message",r)})}function v(e,t){return(...n)=>{const o=y++,{args:r,transferables:i}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],n=[];for(const o of e)Object(f.b)(o)?(t.push(Object(a.c)(o.send)),n.push(...o.transferables)):t.push(Object(a.c)(o));return{args:t,transferables:0===n.length?n:(o=n,Array.from(new Set(o)))};var o}(n),c={type:p.a.run,uid:o,method:t,args:r};m("Sending command to run function to worker:",c);try{e.postMessage(c,i)}catch(e){return h.from(Promise.reject(e))}return h.from(Object(s.a)(g(e,o)))}}function b(e,t){const n={};for(const o of t)n[o]=v(e,o);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputLayer=void 0;const o=n(4),r=n(2),i=n(10),s=n(5),a=n(35);class c extends s.Layer{constructor(e,t={}){super(e);for(let t=0;t<e;t++){const e=new i.Node(r.NodeType.INPUT);this.nodes.push(e)}if(t.noise){const e=new a.NoiseLayer(t.noise);e.outputNodes.forEach(e=>this.outputNodes.add(e)),this.connections.push(...s.Layer.connect(this.nodes,e,e.getDefaultIncomingConnectionType()))}else this.nodes.forEach(e=>this.outputNodes.add(e))}getDefaultIncomingConnectionType(){return o.ConnectionType.NO_CONNECTION}connectionTypeisAllowed(e){return e===o.ConnectionType.NO_CONNECTION}}t.InputLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;const o=n(7);t.Connection=class{constructor(e,t,n,o){this.from=e,this.to=t,this.weight=null!=n?n:0,this.gain=1,this.eligibility=0,this.deltaWeightsPrevious=0,this.deltaWeightsTotal=0,this.xTrace=new Map,o?(this.gateNode=o,o.addGate(this)):this.gateNode=null}toJSON(){let e;return this.xTrace.size>0?(e=new Map,this.xTrace.forEach((t,n)=>{null==e||e.set(n.index,t)})):e=null,{fromIndex:this.from.index,toIndex:this.to.index,gateNodeIndex:null===this.gateNode?null:this.gateNode.index,weight:this.weight,xTraces:e}}getInnovationID(){return o.pairing(this.from.index,this.to.index)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseLayer=void 0;const o=n(3),r=n(4),i=n(2),s=n(36),a=n(5);class c extends a.Layer{constructor(e,t={}){var n;super(e);const r=null!==(n=t.activation)&&void 0!==n?n:o.Identitiy;for(let n=0;n<e;n++)this.inputNodes.add(new s.NoiseNode({noiseType:i.NoiseNodeType.GAUSSIAN_NOISE,gaussian:t}).setActivationType(r));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}getDefaultIncomingConnectionType(){return r.ConnectionType.ONE_TO_ONE}connectionTypeisAllowed(e){return e===r.ConnectionType.ONE_TO_ONE}}t.NoiseLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoiseNode=void 0;const o=n(2),r=n(7),i=n(17);class s extends i.ConstantNode{constructor(e={}){var t;super(),this.noiseType=null!==(t=e.noiseType)&&void 0!==t?t:o.NoiseNodeType.GAUSSIAN_NOISE,this.options=e}activate(){var e,t,n,i;this.prevState=this.state;const s=Array.from(this.incoming).map(e=>e.from.activation*e.weight*e.gain);switch(this.noiseType){case o.NoiseNodeType.GAUSSIAN_NOISE:this.state=r.avg(s)+r.generateGaussian(null!==(t=null===(e=this.options.gaussian)||void 0===e?void 0:e.mean)&&void 0!==t?t:0,null!==(i=null===(n=this.options.gaussian)||void 0===n?void 0:n.deviation)&&void 0!==i?i:2);break;default:throw new ReferenceError("Cannot activate this noise type!")}return this.activation=this.squash(this.state,!1)*this.mask,this.derivativeState=this.squash(this.state,!0),this.activation}propagate(e,t={}){var n,o,i;t.momentum=null!==(n=t.momentum)&&void 0!==n?n:0,t.rate=null!==(o=t.rate)&&void 0!==o?o:.3,t.update=null===(i=t.update)||void 0===i||i;const s=Array.from(this.outgoing).map(e=>e.to.errorResponsibility*e.weight*e.gain);this.errorResponsibility=this.errorProjected=r.sum(s)*this.derivativeState,this.incoming.forEach(e=>{var n,o;let r=this.errorProjected*e.eligibility;e.xTrace.forEach((e,t)=>{r+=t.errorResponsibility*e}),e.deltaWeightsTotal+=(null!==(n=t.rate)&&void 0!==n?n:.3)*r*this.mask,t.update&&(e.deltaWeightsTotal+=(null!==(o=t.momentum)&&void 0!==o?o:0)*e.deltaWeightsPrevious,e.weight+=e.deltaWeightsTotal,e.deltaWeightsPrevious=e.deltaWeightsTotal,e.deltaWeightsTotal=0)})}}t.NoiseNode=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutputLayer=void 0;const o=n(3),r=n(4),i=n(2),s=n(10),a=n(5);class c extends a.Layer{constructor(e,t={}){var n;super(e);const r=null!==(n=t.activation)&&void 0!==n?n:o.Identitiy;for(let t=0;t<e;t++)this.inputNodes.add(new s.Node(i.NodeType.OUTPUT).setActivationType(r));this.nodes.push(...Array.from(this.inputNodes))}connect(){throw new ReferenceError("Could not connect an OutputLayer!")}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.OutputLayer=c},function(e,t,n){"use strict";var o=n(1),r=n(30),i=n(6);t.a=function(e){const t=new r.a;let n,s=0;return new o.b(o=>{n||(n=e.subscribe(t));const r=t.subscribe(o);return s++,()=>{s--,r.unsubscribe(),0===s&&(Object(i.a)(n),n=void 0)}})}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var o=n(12),r=n.n(o),i=n(1),s=n(0),a=n(53),c=n(8),u=n(21),l=n(32),d=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const h=r()("threads:master:messages"),f=r()("threads:master:spawn"),p=r()("threads:master:thread-utils"),m=void 0!==e&&e.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(e.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function y(e,t,n,o){const r=n.filter(e=>e.type===u.a.internalError).map(e=>e.error);return Object.assign(e,{[c.a]:r,[c.b]:n,[c.c]:o,[c.e]:t})}function g(e,t){return d(this,void 0,void 0,(function*(){f("Initializing new thread");const n=(yield function(e,t,n){return d(this,void 0,void 0,(function*(){let o;const r=new Promise((e,r)=>{o=setTimeout(()=>r(Error(n)),t)}),i=yield Promise.race([e,r]);return clearTimeout(o),i}))}(function(e){return new Promise((t,n)=>{const o=r=>{var i;h("Message from worker before finishing initialization:",r.data),(i=r.data)&&"init"===i.type?(e.removeEventListener("message",o),t(r.data)):(e=>e&&"uncaughtError"===e.type)(r.data)&&(e.removeEventListener("message",o),n(Object(s.a)(r.data.error)))};e.addEventListener("message",o)})}(e),t&&t.timeout?t.timeout:m,`Timeout: Did not receive an init message from worker after ${m}ms. Make sure the worker calls expose().`)).exposed,{termination:o,terminate:r}=function(e){const[t,n]=Object(a.a)();return{terminate:()=>d(this,void 0,void 0,(function*(){p("Terminating worker"),yield e.terminate(),n()})),termination:t}}(e),c=function(e,t){return new i.b(n=>{const o=e=>{const t={type:u.a.message,data:e.data};n.next(t)},r=e=>{p("Unhandled promise rejection event in thread:",e);const t={type:u.a.internalError,error:Error(e.reason)};n.next(t)};e.addEventListener("message",o),e.addEventListener("unhandledrejection",r),t.then(()=>{const t={type:u.a.termination};e.removeEventListener("message",o),e.removeEventListener("unhandledrejection",r),n.next(t),n.complete()})})}(e,o);if("function"===n.type){return y(Object(l.a)(e),e,c,r)}if("module"===n.type){return y(Object(l.b)(e,n.methods),e,c,r)}{const e=n.type;throw Error("Worker init message states unexpected type of expose(): "+e)}}))}}).call(this,n(18))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var o=n(31),r=n.n(o),i=n(0),s=n(15),a=n(9),c=n(11),u=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};let l=!1;const d=e=>e&&e.type===a.a.run,h=e=>r()(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e);function f(e){return Object(s.b)(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function p(e,t){const{payload:n,transferables:o}=f(t),r={type:a.b.error,uid:e,error:Object(i.c)(n)};c.a.postMessageToMaster(r,o)}function m(e,t,n){const{payload:o,transferables:r}=f(n),i={type:a.b.result,uid:e,complete:!!t||void 0,payload:o};c.a.postMessageToMaster(i,r)}function y(e){try{const t={type:a.b.uncaughtError,error:Object(i.c)(e)};c.a.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}function g(e,t,n){return u(this,void 0,void 0,(function*(){let o;try{o=t(...n)}catch(t){return p(e,t)}const r=h(o)?"observable":"promise";if(function(e,t){const n={type:a.b.running,uid:e,resultType:t};c.a.postMessageToMaster(n)}(e,r),h(o))o.subscribe(t=>m(e,!1,Object(i.c)(t)),t=>p(e,Object(i.c)(t)),()=>m(e,!0));else try{const t=yield o;m(e,!0,Object(i.c)(t))}catch(t){p(e,Object(i.c)(t))}}))}function v(e){if(!c.a.isWorkerRuntime())throw Error("expose() called in the master thread.");if(l)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(l=!0,"function"==typeof e)c.a.subscribeToMasterMessages(t=>{d(t)&&!t.method&&g(t.uid,e,t.args.map(i.a))}),function(){const e={type:a.b.init,exposed:{type:"function"}};c.a.postMessageToMaster(e)}();else{if("object"!=typeof e||!e)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: "+e);c.a.subscribeToMasterMessages(t=>{d(t)&&t.method&&g(t.uid,e[t.method],t.args.map(i.a))});!function(e){const t={type:a.b.init,exposed:{type:"module",methods:e}};c.a.postMessageToMaster(t)}(Object.keys(e).filter(t=>"function"==typeof e[t]))}}"undefined"!=typeof self&&"function"==typeof self.addEventListener&&c.a.isWorkerRuntime()&&(self.addEventListener("error",e=>{setTimeout(()=>y(e.error||e),250)}),self.addEventListener("unhandledrejection",e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout(()=>y(t),250)})),void 0!==e&&"function"==typeof e.on&&c.a.isWorkerRuntime()&&(e.on("uncaughtException",e=>{setTimeout(()=>y(e),250)}),e.on("unhandledRejection",e=>{e&&"string"==typeof e.message&&setTimeout(()=>y(e),250)}))}).call(this,n(18))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendSerializer=function(e,t){const n=e.deserialize.bind(e),o=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,n),serialize:e=>t.serialize(e,o)}};const o={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})};t.DefaultSerializer={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?o.deserialize(e):e;var t},serialize:e=>e instanceof Error?o.serialize(e):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(64);t.defaultPoolSize="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;const r=e=>/^(file|https?:)?\/\//i.test(e);function i(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}t.selectWorkerImplementation=function(){return"undefined"==typeof Worker?class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}}:class extends Worker{constructor(e,t){"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!r(e)&&o.getBundleURL().match(/^file:\/\//i)&&(e=new URL(e,o.getBundleURL().replace(/\/[^\/]+$/,"/")),e=i(`importScripts(${JSON.stringify(e)});`)),"string"==typeof e&&r(e)&&(e=i(`importScripts(${JSON.stringify(e)});`)),super(e,t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(24);function r(e){throw Error(e)}t.Thread={errors:e=>e[o.$errors]||r("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:e=>e[o.$events]||r("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:e=>e[o.$terminate]()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.run="run"}(t.MasterMessageType||(t.MasterMessageType={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(t.WorkerMessageType||(t.WorkerMessageType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvolveOptions=void 0;const o=n(3),r=n(23),i=n(27),s=n(16),a=n(46);t.EvolveOptions=class{constructor(){this.speciesDistanceThreshold=4,this.c1=1,this.c2=1,this.c3=1,this.survivors=.8,this.input=1,this.output=1,this.generation=0,this.elitism=1,this.equal=!0,this.clear=!1,this.populationSize=50,this.mutationRate=.6,this.mutationAmount=5,this.selection=new a.FitnessProportionateSelection,this.loss=i.MSELoss,this.mutations=s.FEEDFORWARD_MUTATIONS,this.activations=Object.values(o.ALL_ACTIVATIONS),this.template=new r.Network(this.input,this.output),this.maxNodes=1/0,this.maxConnections=1/0,this.maxGates=1/0,this.threads=4,this.log=-1,this.iterations=1e3,this.error=.05,this.maxStagnation=3}}},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TournamentSelection=t.PowerSelection=t.FitnessProportionateSelection=t.Selection=void 0;const s=i(n(26)),a=n(7);class c{}t.Selection=c;t.FitnessProportionateSelection=class extends c{select(e){var t,n,o;let r=0,i=0;for(const o of e)i=Math.min(null!==(t=o.score)&&void 0!==t?t:i,i),r+=null!==(n=o.score)&&void 0!==n?n:0;i=Math.abs(i),r+=i*e.length;const s=a.randDouble(0,r);let c=0;for(const t of e)if(c+=(null!==(o=t.score)&&void 0!==o?o:0)+i,s<c)return t;return a.pickRandom(e)}};t.PowerSelection=class extends c{constructor(e=4){super(),this.power=e}select(e){return e[Math.floor(Math.pow(Math.random(),this.power)*e.length)]}};t.TournamentSelection=class extends c{constructor(e=5,t=.5){super(),this.size=e,this.probability=t}select(e){if(this.size>e.length)throw new Error("Your tournament size should be lower than the population size, please change methods.selection.TOURNAMENT.size");const t=[];for(let n=0;n<this.size;n++)t.push(a.pickRandom(e));s.sort(t,(e,t)=>void 0===t.score||void 0===e.score?0:t.score-e.score);for(let e=0;e<this.size;e++)if(Math.random()<this.probability||e===this.size-1)return t[e];return a.pickRandom(e)}}},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Species=void 0;const s=i(n(26)),a=n(7),c=n(23);t.Species=class{constructor(e){this.representative=e,this.representative.species=this,this.members=new Set,this.members.add(e),this._score=0,this.lastScore=0,this._stagnation=0}get score(){return this._score}get stagnation(){return this._stagnation}put(e,t,n,o,r){return e.distance(this.representative,t,n,o)<r&&(this.forcePut(e),!0)}forcePut(e){void 0!==e&&(this.members.add(e),e.species=this)}evaluateScore(){let e=0;this.members.forEach(t=>{var n;return e+=null!==(n=t.score)&&void 0!==n?n:0});const t=e/this.members.size;this.lastScore<t?this._stagnation++:this._stagnation=0,this._score=t}reset(){this.representative=a.pickRandom(this.members),this.members.forEach(e=>e.species=null),this.members.clear(),this.members.add(this.representative),this.representative.species=this,this.lastScore=this.score,this._score=0}kill(e){const t=Array.from(this.members);s.sort(t,(e,t)=>void 0===e.score||void 0===t.score?0:e.score-t.score);const n=Math.floor(e*this.members.size);for(let e=0;e<n;e++)this.members.delete(t[e]),t[e].species=null}breed(){return c.Network.crossOver(a.pickRandom(this.members),a.pickRandom(this.members))}size(){return this.members.size}getBest(){const e=Array.from(this.members);return e[a.maxValueIndex(e.map(e=>{var t;return null!==(t=e.score)&&void 0!==t?t:-1/0}))]}print(){console.log("Species={Members: "+this.members.size+"; Score: "+this._score+"; Stagnation: "+this.stagnation+"}")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropoutNode=void 0;const o=n(7),r=n(17);class i extends r.ConstantNode{constructor(e){super(),this.probability=e,this.droppedOut=!1}activate(){if(1!==this.incoming.size)throw new RangeError("Dropout node should have exactly one incoming connection!");const e=Array.from(this.incoming)[0];return o.randDouble(0,1)<this.probability?(this.droppedOut=!0,this.state=0):(this.droppedOut=!1,this.state=e.from.activation*e.weight*e.gain,this.state*=1/(1-this.probability)),this.activation=this.squash(this.state,!1)*this.mask,this.gated.forEach(e=>e.gain=this.activation),this.activation}propagate(e,t={}){var n,r,i;t.momentum=null!==(n=t.momentum)&&void 0!==n?n:0,t.rate=null!==(r=t.rate)&&void 0!==r?r:.3,t.update=null===(i=t.update)||void 0===i||i;const s=Array.from(this.outgoing).map(e=>e.to.errorResponsibility*e.weight*e.gain);if(this.errorResponsibility=this.errorProjected=o.sum(s)/(1-this.probability),1!==this.incoming.size)throw new RangeError("Dropout node should have exactly one incoming connection!");const a=Array.from(this.incoming)[0];if(!this.droppedOut){let e=this.errorProjected*a.eligibility;a.xTrace.forEach((t,n)=>{e+=n.errorResponsibility*t}),t.update&&(a.deltaWeightsTotal+=t.rate*e*this.mask+t.momentum*a.deltaWeightsPrevious,a.weight+=a.deltaWeightsTotal,a.deltaWeightsPrevious=a.deltaWeightsTotal,a.deltaWeightsTotal=0)}}fromJSON(e){return super.fromJSON(e),this.probability=e.probability,this}toJSON(){return Object.assign(super.toJSON(),{probability:this.probability})}}t.DropoutNode=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AvgPooling1DLayer=void 0;const o=n(3),r=n(2),i=n(28),s=n(29);class a extends s.PoolingLayer{constructor(e,t={}){var n;super(e);const s=null!==(n=t.activation)&&void 0!==n?n:o.Identitiy;for(let t=0;t<e;t++)this.inputNodes.add(new i.PoolNode(r.PoolNodeType.AVG_POOLING).setActivationType(s));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}}t.AvgPooling1DLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxPooling1DLayer=void 0;const o=n(3),r=n(2),i=n(28),s=n(29);class a extends s.PoolingLayer{constructor(e,t={}){var n;super(e);const s=null!==(n=t.activation)&&void 0!==n?n:o.Identitiy;for(let t=0;t<e;t++)this.inputNodes.add(new i.PoolNode(r.PoolNodeType.MAX_POOLING).setActivationType(s));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}}t.MaxPooling1DLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinPooling1DLayer=void 0;const o=n(3),r=n(2),i=n(28),s=n(29);class a extends s.PoolingLayer{constructor(e,t={}){var n;super(e);const s=null!==(n=t.activation)&&void 0!==n?n:o.Identitiy;for(let t=0;t<e;t++)this.inputNodes.add(new i.PoolNode(r.PoolNodeType.MIN_POOLING).setActivationType(s));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}}t.MinPooling1DLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InverseRate=t.ExponentialRate=t.StepRate=t.FixedRate=t.Rate=void 0;class o{constructor(e){this.baseRate=e}}t.Rate=o;t.FixedRate=class extends o{calc(){return this.baseRate}};t.StepRate=class extends o{constructor(e,t=.9,n=100){super(e),this.gamma=t,this.stepSize=n}calc(e){return this.baseRate*Math.pow(this.gamma,Math.floor(e/this.stepSize))}};t.ExponentialRate=class extends o{constructor(e,t=.999){super(e),this.gamma=t}calc(e){return this.baseRate*Math.pow(this.gamma,e)}};t.InverseRate=class extends o{constructor(e,t=.001,n=2){super(e),this.gamma=t,this.power=n}calc(e){return this.baseRate*Math.pow(1+this.gamma*e,-this.power)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const o=()=>{};function r(){let e,t=!1,n=o;return[new Promise(o=>{t?o(e):n=o}),o=>{t=!0,e=o,n()}]}},function(e,t,n){"use strict";function o(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateGaussian=t.avg=t.sum=t.min=t.minValueIndex=t.maxValueIndex=t.max=t.shuffle=t.removeFromArray=t.randBoolean=t.randDouble=t.randInt=t.pickRandom=t.TournamentSelection=t.PowerSelection=t.FitnessProportionateSelection=t.Selection=t.InverseRate=t.ExponentialRate=t.StepRate=t.FixedRate=t.Rate=t.SwapNodesMutation=t.SubBackConnectionMutation=t.AddBackConnectionMutation=t.SubSelfConnectionMutation=t.AddSelfConnectionMutation=t.SubGateMutation=t.AddGateMutation=t.ModActivationMutation=t.ModBiasMutation=t.ModWeightMutation=t.SubConnectionMutation=t.AddConnectionMutation=t.SubNodeMutation=t.AddNodeMutation=t.Mutation=t.ONLY_STRUCTURE=t.NO_STRUCTURE_MUTATIONS=t.FEEDFORWARD_MUTATIONS=t.ALL_MUTATIONS=t.HINGELoss=t.MSLELoss=t.WAPELoss=t.MAPELoss=t.MAELoss=t.BinaryLoss=t.MBELoss=t.MSELoss=t.ALL_LOSSES=t.TrainOptions=t.EvolveOptions=t.NoiseNodeType=t.PoolNodeType=t.NodeType=t.GatingType=t.ConnectionType=t.Node=t.Species=t.Network=t.Connection=t.Architect=t.PoolNode=t.NoiseNode=t.DropoutNode=t.ConstantNode=t.Layer=t.MemoryLayer=t.LSTMLayer=t.GRULayer=t.RNNLayer=t.HopfieldLayer=t.ActivationLayer=t.PoolingLayer=t.GlobalMaxPooling1DLayer=t.GlobalMinPooling1DLayer=t.GlobalAvgPooling1DLayer=t.MaxPooling1DLayer=t.MinPooling1DLayer=t.AvgPooling1DLayer=t.NoiseLayer=t.OutputLayer=t.InputLayer=t.DropoutLayer=t.DenseLayer=void 0;const o=n(56);Object.defineProperty(t,"Architect",{enumerable:!0,get:function(){return o.Architect}});const r=n(34);Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return r.Connection}});const i=n(77);Object.defineProperty(t,"ActivationLayer",{enumerable:!0,get:function(){return i.ActivationLayer}});const s=n(79);Object.defineProperty(t,"DenseLayer",{enumerable:!0,get:function(){return s.DenseLayer}});const a=n(80);Object.defineProperty(t,"DropoutLayer",{enumerable:!0,get:function(){return a.DropoutLayer}});const c=n(33);Object.defineProperty(t,"InputLayer",{enumerable:!0,get:function(){return c.InputLayer}});const u=n(37);Object.defineProperty(t,"OutputLayer",{enumerable:!0,get:function(){return u.OutputLayer}});const l=n(5);Object.defineProperty(t,"Layer",{enumerable:!0,get:function(){return l.Layer}});const d=n(35);Object.defineProperty(t,"NoiseLayer",{enumerable:!0,get:function(){return d.NoiseLayer}});const h=n(49);Object.defineProperty(t,"AvgPooling1DLayer",{enumerable:!0,get:function(){return h.AvgPooling1DLayer}});const f=n(81);Object.defineProperty(t,"GlobalAvgPooling1DLayer",{enumerable:!0,get:function(){return f.GlobalAvgPooling1DLayer}});const p=n(82);Object.defineProperty(t,"GlobalMaxPooling1DLayer",{enumerable:!0,get:function(){return p.GlobalMaxPooling1DLayer}});const m=n(83);Object.defineProperty(t,"GlobalMinPooling1DLayer",{enumerable:!0,get:function(){return m.GlobalMinPooling1DLayer}});const y=n(50);Object.defineProperty(t,"MaxPooling1DLayer",{enumerable:!0,get:function(){return y.MaxPooling1DLayer}});const g=n(51);Object.defineProperty(t,"MinPooling1DLayer",{enumerable:!0,get:function(){return g.MinPooling1DLayer}});const v=n(29);Object.defineProperty(t,"PoolingLayer",{enumerable:!0,get:function(){return v.PoolingLayer}});const b=n(84);Object.defineProperty(t,"GRULayer",{enumerable:!0,get:function(){return b.GRULayer}});const w=n(85);Object.defineProperty(t,"HopfieldLayer",{enumerable:!0,get:function(){return w.HopfieldLayer}});const T=n(86);Object.defineProperty(t,"LSTMLayer",{enumerable:!0,get:function(){return T.LSTMLayer}});const O=n(87);Object.defineProperty(t,"MemoryLayer",{enumerable:!0,get:function(){return O.MemoryLayer}});const N=n(88);Object.defineProperty(t,"RNNLayer",{enumerable:!0,get:function(){return N.RNNLayer}});const L=n(23);Object.defineProperty(t,"Network",{enumerable:!0,get:function(){return L.Network}});const _=n(10);Object.defineProperty(t,"Node",{enumerable:!0,get:function(){return _.Node}});const E=n(17);Object.defineProperty(t,"ConstantNode",{enumerable:!0,get:function(){return E.ConstantNode}});const S=n(48);Object.defineProperty(t,"DropoutNode",{enumerable:!0,get:function(){return S.DropoutNode}});const P=n(36);Object.defineProperty(t,"NoiseNode",{enumerable:!0,get:function(){return P.NoiseNode}});const M=n(28);Object.defineProperty(t,"PoolNode",{enumerable:!0,get:function(){return M.PoolNode}});const k=n(47);Object.defineProperty(t,"Species",{enumerable:!0,get:function(){return k.Species}});const x=n(4);Object.defineProperty(t,"ConnectionType",{enumerable:!0,get:function(){return x.ConnectionType}});const C=n(22);Object.defineProperty(t,"GatingType",{enumerable:!0,get:function(){return C.GatingType}});const A=n(2);Object.defineProperty(t,"NodeType",{enumerable:!0,get:function(){return A.NodeType}}),Object.defineProperty(t,"NoiseNodeType",{enumerable:!0,get:function(){return A.NoiseNodeType}}),Object.defineProperty(t,"PoolNodeType",{enumerable:!0,get:function(){return A.PoolNodeType}});const j=n(45);Object.defineProperty(t,"EvolveOptions",{enumerable:!0,get:function(){return j.EvolveOptions}});const I=n(89);Object.defineProperty(t,"TrainOptions",{enumerable:!0,get:function(){return I.TrainOptions}});const R=n(27);Object.defineProperty(t,"ALL_LOSSES",{enumerable:!0,get:function(){return R.ALL_LOSSES}}),Object.defineProperty(t,"BinaryLoss",{enumerable:!0,get:function(){return R.BinaryLoss}}),Object.defineProperty(t,"HINGELoss",{enumerable:!0,get:function(){return R.HINGELoss}}),Object.defineProperty(t,"MAELoss",{enumerable:!0,get:function(){return R.MAELoss}}),Object.defineProperty(t,"MAPELoss",{enumerable:!0,get:function(){return R.MAPELoss}}),Object.defineProperty(t,"MBELoss",{enumerable:!0,get:function(){return R.MBELoss}}),Object.defineProperty(t,"MSELoss",{enumerable:!0,get:function(){return R.MSELoss}}),Object.defineProperty(t,"MSLELoss",{enumerable:!0,get:function(){return R.MSLELoss}}),Object.defineProperty(t,"WAPELoss",{enumerable:!0,get:function(){return R.WAPELoss}});const D=n(16);Object.defineProperty(t,"AddBackConnectionMutation",{enumerable:!0,get:function(){return D.AddBackConnectionMutation}}),Object.defineProperty(t,"AddConnectionMutation",{enumerable:!0,get:function(){return D.AddConnectionMutation}}),Object.defineProperty(t,"AddGateMutation",{enumerable:!0,get:function(){return D.AddGateMutation}}),Object.defineProperty(t,"AddNodeMutation",{enumerable:!0,get:function(){return D.AddNodeMutation}}),Object.defineProperty(t,"AddSelfConnectionMutation",{enumerable:!0,get:function(){return D.AddSelfConnectionMutation}}),Object.defineProperty(t,"ALL_MUTATIONS",{enumerable:!0,get:function(){return D.ALL_MUTATIONS}}),Object.defineProperty(t,"FEEDFORWARD_MUTATIONS",{enumerable:!0,get:function(){return D.FEEDFORWARD_MUTATIONS}}),Object.defineProperty(t,"ModActivationMutation",{enumerable:!0,get:function(){return D.ModActivationMutation}}),Object.defineProperty(t,"ModBiasMutation",{enumerable:!0,get:function(){return D.ModBiasMutation}}),Object.defineProperty(t,"ModWeightMutation",{enumerable:!0,get:function(){return D.ModWeightMutation}}),Object.defineProperty(t,"Mutation",{enumerable:!0,get:function(){return D.Mutation}}),Object.defineProperty(t,"NO_STRUCTURE_MUTATIONS",{enumerable:!0,get:function(){return D.NO_STRUCTURE_MUTATIONS}}),Object.defineProperty(t,"ONLY_STRUCTURE",{enumerable:!0,get:function(){return D.ONLY_STRUCTURE}}),Object.defineProperty(t,"SubBackConnectionMutation",{enumerable:!0,get:function(){return D.SubBackConnectionMutation}}),Object.defineProperty(t,"SubConnectionMutation",{enumerable:!0,get:function(){return D.SubConnectionMutation}}),Object.defineProperty(t,"SubGateMutation",{enumerable:!0,get:function(){return D.SubGateMutation}}),Object.defineProperty(t,"SubNodeMutation",{enumerable:!0,get:function(){return D.SubNodeMutation}}),Object.defineProperty(t,"SubSelfConnectionMutation",{enumerable:!0,get:function(){return D.SubSelfConnectionMutation}}),Object.defineProperty(t,"SwapNodesMutation",{enumerable:!0,get:function(){return D.SwapNodesMutation}});const z=n(52);Object.defineProperty(t,"ExponentialRate",{enumerable:!0,get:function(){return z.ExponentialRate}}),Object.defineProperty(t,"FixedRate",{enumerable:!0,get:function(){return z.FixedRate}}),Object.defineProperty(t,"InverseRate",{enumerable:!0,get:function(){return z.InverseRate}}),Object.defineProperty(t,"Rate",{enumerable:!0,get:function(){return z.Rate}}),Object.defineProperty(t,"StepRate",{enumerable:!0,get:function(){return z.StepRate}});const G=n(46);Object.defineProperty(t,"FitnessProportionateSelection",{enumerable:!0,get:function(){return G.FitnessProportionateSelection}}),Object.defineProperty(t,"PowerSelection",{enumerable:!0,get:function(){return G.PowerSelection}}),Object.defineProperty(t,"Selection",{enumerable:!0,get:function(){return G.Selection}}),Object.defineProperty(t,"TournamentSelection",{enumerable:!0,get:function(){return G.TournamentSelection}});const F=n(7);Object.defineProperty(t,"avg",{enumerable:!0,get:function(){return F.avg}}),Object.defineProperty(t,"generateGaussian",{enumerable:!0,get:function(){return F.generateGaussian}}),Object.defineProperty(t,"max",{enumerable:!0,get:function(){return F.max}}),Object.defineProperty(t,"maxValueIndex",{enumerable:!0,get:function(){return F.maxValueIndex}}),Object.defineProperty(t,"min",{enumerable:!0,get:function(){return F.min}}),Object.defineProperty(t,"minValueIndex",{enumerable:!0,get:function(){return F.minValueIndex}}),Object.defineProperty(t,"pickRandom",{enumerable:!0,get:function(){return F.pickRandom}}),Object.defineProperty(t,"randBoolean",{enumerable:!0,get:function(){return F.randBoolean}}),Object.defineProperty(t,"randDouble",{enumerable:!0,get:function(){return F.randDouble}}),Object.defineProperty(t,"randInt",{enumerable:!0,get:function(){return F.randInt}}),Object.defineProperty(t,"removeFromArray",{enumerable:!0,get:function(){return F.removeFromArray}}),Object.defineProperty(t,"shuffle",{enumerable:!0,get:function(){return F.shuffle}}),Object.defineProperty(t,"sum",{enumerable:!0,get:function(){return F.sum}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Architect=void 0;const o=n(33),r=n(37),i=n(5),s=n(23);t.Architect=class{constructor(){this.layers=[]}addLayer(e,t){const n=null!=t?t:e.getDefaultIncomingConnectionType();if(!e.connectionTypeisAllowed(n))throw new ReferenceError("Connection type "+n+" is not allowed at layer "+e.constructor.name);return this.layers.push({layer:e,incomingConnectionType:n}),this}buildModel(){if(!(this.layers[0].layer instanceof o.InputLayer))throw new ReferenceError("First layer has to be a InputLayer! Currently is: "+this.layers[0].layer.constructor.name);if(!(this.layers[this.layers.length-1].layer instanceof r.OutputLayer))throw new ReferenceError("Last layer has to be a OutputLayer! Currently is: "+this.layers[this.layers.length-1].layer.constructor.name);const e=this.layers[0].layer.nodes.length,t=this.layers[this.layers.length-1].layer.nodes.length,n=new s.Network(e,t);n.nodes=[],n.connections.clear();for(let e=0;e<this.layers.length-1;e++)i.Layer.connect(this.layers[e].layer,this.layers[e+1].layer,this.layers[e+1].incomingConnectionType).forEach(e=>n.connections.add(e)),n.nodes.push(...this.layers[e].layer.nodes),this.layers[e].layer.connections.forEach(e=>n.connections.add(e)),this.layers[e].layer.gates.forEach(e=>n.gates.add(e));return n.nodes.push(...this.layers[this.layers.length-1].layer.nodes),n}}},function(e,t,n){e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return o.colors[Math.abs(t)%o.colors.length]}function o(e){let n;function s(...e){if(!s.enabled)return;const t=s,r=Number(new Date),i=r-(n||r);t.diff=i,t.prev=n,t.curr=r,n=r,e[0]=o.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return n;a++;const i=o.formatters[r];if("function"==typeof i){const o=e[a];n=i.call(t,o),e.splice(a,1),a--}return n}),o.formatArgs.call(t,e);(t.log||o.log).apply(t,e)}return s.namespace=e,s.enabled=o.enabled(e),s.useColors=o.useColors(),s.color=t(e),s.destroy=r,s.extend=i,"function"==typeof o.init&&o.init(s),o.instances.push(s),s}function r(){const e=o.instances.indexOf(this);return-1!==e&&(o.instances.splice(e,1),!0)}function i(e,t){const n=o(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return o.debug=o,o.default=o,o.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},o.disable=function(){const e=[...o.names.map(s),...o.skips.map(s).map(e=>"-"+e)].join(",");return o.enable(""),e},o.enable=function(e){let t;o.save(e),o.names=[],o.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")));for(t=0;t<o.instances.length;t++){const e=o.instances[t];e.enabled=o.enabled(e.namespace)}},o.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=o.skips.length;t<n;t++)if(o.skips[t].test(e))return!1;for(t=0,n=o.names.length;t<n;t++)if(o.names[t].test(e))return!0;return!1},o.humanize=n(58),Object.keys(e).forEach(t=>{o[t]=e[t]}),o.instances=[],o.names=[],o.skips=[],o.formatters={},o.selectColor=t,o.enable(o.load()),o}},function(e,t){var n=1e3,o=6e4,r=60*o,i=24*r;function s(e,t,n,o){var r=t>=1.5*n;return Math.round(e/n)+" "+o+(r?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*o;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return s(e,t,i,"day");if(t>=r)return s(e,t,r,"hour");if(t>=o)return s(e,t,o,"minute");if(t>=n)return s(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=r)return Math.round(e/r)+"h";if(t>=o)return Math.round(e/o)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";n.r(t),function(e,o){var r,i=n(54);r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:o;var s=Object(i.a)(r);t.default=s}.call(this,n(60),n(61)(e))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(19);t.registerSerializer=o.registerSerializer,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(63));var r=n(73);t.expose=r.expose;var i=n(41);t.DefaultSerializer=i.DefaultSerializer;var s=n(25);t.Transfer=s.Transfer},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(42);var r=n(65);t.Pool=r.Pool;var i=n(68);t.spawn=i.spawn;var s=n(43);t.Thread=s.Thread,t.Worker=o.selectWorkerImplementation()},function(e,t,n){"use strict";let o;function r(e){return(""+e).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.getBundleURL=function(){return o||(o=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return r(t[0])}return"/"}()),o},t.getBaseURL=r},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(12)),s=n(14),a=n(66),c=n(42),u=n(67);t.PoolEventType=u.PoolEventType;const l=n(43);t.Thread=l.Thread;let d=1;class h{constructor(e,t){this.eventSubject=new s.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const n="number"==typeof t?{size:t}:t||{},{size:o=c.defaultPoolSize}=n;this.debug=i.default("threads:pool:"+(n.name||String(d++)).replace(/\W/g," ").trim().replace(/\s+/g,"-")),this.options=n,this.workers=function(e,t){return function(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}(t).map(()=>({init:e(),runningTasks:[]}))}(e,o),this.eventObservable=s.multicast(s.Observable.from(this.eventSubject)),Promise.all(this.workers.map(e=>e.init)).then(()=>this.eventSubject.next({type:u.PoolEventType.initialized,size:this.workers.length}),e=>{this.debug("Error while initializing pool worker:",e),this.eventSubject.error(e),this.initErrors.push(e)})}findIdlingWorker(){const{concurrency:e=1}=this.options;return this.workers.find(t=>t.runningTasks.length<e)}runPoolTask(e,t){return o(this,void 0,void 0,(function*(){const n=this.workers.indexOf(e)+1;this.debug(`Running task #${t.id} on worker #${n}...`),this.eventSubject.next({type:u.PoolEventType.taskStart,taskID:t.id,workerID:n});try{const o=yield t.run(yield e.init);this.debug(`Task #${t.id} completed successfully`),this.eventSubject.next({type:u.PoolEventType.taskCompleted,returnValue:o,taskID:t.id,workerID:n})}catch(e){this.debug(`Task #${t.id} failed`),this.eventSubject.next({type:u.PoolEventType.taskFailed,taskID:t.id,error:e,workerID:n})}}))}run(e,t){return o(this,void 0,void 0,(function*(){const n=(()=>o(this,void 0,void 0,(function*(){var o;yield(o=0,new Promise(e=>setTimeout(e,o)));try{yield this.runPoolTask(e,t)}finally{e.runningTasks=e.runningTasks.filter(e=>e!==n),this.isClosing||this.scheduleWork()}})))();e.runningTasks.push(n)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const e=this.findIdlingWorker();if(!e)return;const t=this.taskQueue.shift();if(!t)return this.debug("Task queue is empty"),void this.eventSubject.next({type:u.PoolEventType.taskQueueDrained});this.run(e,t)}taskCompletion(e){return new Promise((t,n)=>{const o=this.events().subscribe(r=>{r.type===u.PoolEventType.taskCompleted&&r.taskID===e?(o.unsubscribe(),t(r.returnValue)):r.type===u.PoolEventType.taskFailed&&r.taskID===e?(o.unsubscribe(),n(r.error)):r.type===u.PoolEventType.terminated&&(o.unsubscribe(),n(Error("Pool has been terminated before task was run.")))})})}settled(e=!1){return o(this,void 0,void 0,(function*(){const t=()=>{return e=this.workers,t=e=>e.runningTasks,e.reduce((e,n)=>[...e,...t(n)],[]);var e,t},n=[],o=this.eventObservable.subscribe(e=>{e.type===u.PoolEventType.taskFailed&&n.push(e.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):e&&0===this.taskQueue.length?(yield a.allSettled(t()),n):(yield new Promise((e,t)=>{const n=this.eventObservable.subscribe({next(t){t.type===u.PoolEventType.taskQueueDrained&&(n.unsubscribe(),e())},error:t})}),yield a.allSettled(t()),o.unsubscribe(),n)}))}completed(e=!1){return o(this,void 0,void 0,(function*(){const t=this.settled(e),n=new Promise((e,n)=>{const o=this.eventObservable.subscribe({next(r){r.type===u.PoolEventType.taskQueueDrained?(o.unsubscribe(),e(t)):r.type===u.PoolEventType.taskFailed&&(o.unsubscribe(),n(r.error))},error:n})}),o=yield Promise.race([t,n]);if(o.length>0)throw o[0]}))}events(){return this.eventObservable}queue(e){const{maxQueuedJobs:t=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const n=()=>this.taskCompletion(r.id);let o;const r={id:this.nextTaskID++,run:e,cancel:()=>{-1!==this.taskQueue.indexOf(r)&&(this.taskQueue=this.taskQueue.filter(e=>e!==r),this.eventSubject.next({type:u.PoolEventType.taskCanceled,taskID:r.id}))},get then(){if(!o){const e=n();o=e.then.bind(e)}return o}};if(this.taskQueue.length>=t)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${r.id}...`),this.taskQueue.push(r),this.eventSubject.next({type:u.PoolEventType.taskQueued,taskID:r.id}),this.scheduleWork(),r}terminate(e){return o(this,void 0,void 0,(function*(){this.isClosing=!0,e||(yield this.completed(!0)),this.eventSubject.next({type:u.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(e=>o(this,void 0,void 0,(function*(){return l.Thread.terminate(yield e.init)}))))}))}}function f(e,t){return new h(e,t)}h.EventType=u.PoolEventType,f.EventType=u.PoolEventType,t.Pool=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allSettled=function(e){return Promise.all(e.map(e=>{const t=e=>({status:"fulfilled",value:e}),n=e=>({status:"rejected",reason:e}),o=Promise.resolve(e);try{return o.then(t,n)}catch(e){return Promise.reject(e)}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.initialized="initialized",e.taskCanceled="taskCanceled",e.taskCompleted="taskCompleted",e.taskFailed="taskFailed",e.taskQueued="taskQueued",e.taskQueueDrained="taskQueueDrained",e.taskStart="taskStart",e.terminated="terminated"}(t.PoolEventType||(t.PoolEventType={}))},function(e,t,n){"use strict";(function(e){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(12)),s=n(14),a=n(19),c=n(69),u=n(24),l=n(70),d=n(71),h=i.default("threads:master:messages"),f=i.default("threads:master:spawn"),p=i.default("threads:master:thread-utils"),m=void 0!==e&&e.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(e.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function y(e,t,n,o){const r=n.filter(e=>e.type===l.WorkerEventType.internalError).map(e=>e.error);return Object.assign(e,{[u.$errors]:r,[u.$events]:n,[u.$terminate]:o,[u.$worker]:t})}t.spawn=function(e,t){return o(this,void 0,void 0,(function*(){f("Initializing new thread");const n=(yield function(e,t,n){return o(this,void 0,void 0,(function*(){let o;const r=new Promise((e,r)=>{o=setTimeout(()=>r(Error(n)),t)}),i=yield Promise.race([e,r]);return clearTimeout(o),i}))}(function(e){return new Promise((t,n)=>{const o=r=>{var i;h("Message from worker before finishing initialization:",r.data),(i=r.data)&&"init"===i.type?(e.removeEventListener("message",o),t(r.data)):(e=>e&&"uncaughtError"===e.type)(r.data)&&(e.removeEventListener("message",o),n(a.deserialize(r.data.error)))};e.addEventListener("message",o)})}(e),t&&t.timeout?t.timeout:m,`Timeout: Did not receive an init message from worker after ${m}ms. Make sure the worker calls expose().`)).exposed,{termination:r,terminate:i}=function(e){const[t,n]=c.createPromiseWithResolver();return{terminate:()=>o(this,void 0,void 0,(function*(){p("Terminating worker"),yield e.terminate(),n()})),termination:t}}(e),u=function(e,t){return new s.Observable(n=>{const o=e=>{const t={type:l.WorkerEventType.message,data:e.data};n.next(t)},r=e=>{p("Unhandled promise rejection event in thread:",e);const t={type:l.WorkerEventType.internalError,error:Error(e.reason)};n.next(t)};e.addEventListener("message",o),e.addEventListener("unhandledrejection",r),t.then(()=>{const t={type:l.WorkerEventType.termination};e.removeEventListener("message",o),e.removeEventListener("unhandledrejection",r),n.next(t),n.complete()})})}(e,r);if("function"===n.type){return y(d.createProxyFunction(e),e,u,i)}if("module"===n.type){return y(d.createProxyModule(e,n.methods),e,u,i)}{const e=n.type;throw Error("Worker init message states unexpected type of expose(): "+e)}}))}}).call(this,n(18))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=()=>{};t.createPromiseWithResolver=function(){let e,t=!1,n=o;return[new Promise(o=>{t?o(e):n=o}),o=>{t=!0,e=o,n()}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(24);!function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(t.WorkerEventType||(t.WorkerEventType={}))},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(12)),i=n(14),s=n(19),a=n(72),c=n(25),u=n(44),l=r.default("threads:master:messages");let d=1;function h(e,t){return new i.Observable(n=>{let o;const r=i=>{var a;if(l("Message from worker:",i.data),i.data&&i.data.uid===t)if((a=i.data)&&a.type===u.WorkerMessageType.running)o=i.data.resultType;else if((e=>e&&e.type===u.WorkerMessageType.result)(i.data))"promise"===o?(void 0!==i.data.payload&&n.next(s.deserialize(i.data.payload)),n.complete(),e.removeEventListener("message",r)):(i.data.payload&&n.next(s.deserialize(i.data.payload)),i.data.complete&&(n.complete(),e.removeEventListener("message",r)));else if((e=>e&&e.type===u.WorkerMessageType.error)(i.data)){const t=s.deserialize(i.data.error);n.error(t),e.removeEventListener("message",r)}};return e.addEventListener("message",r),()=>e.removeEventListener("message",r)})}function f(e,t){return(...n)=>{const o=d++,{args:r,transferables:f}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],n=[];for(const o of e)c.isTransferDescriptor(o)?(t.push(s.serialize(o.send)),n.push(...o.transferables)):t.push(s.serialize(o));return{args:t,transferables:0===n.length?n:(o=n,Array.from(new Set(o)))};var o}(n),p={type:u.MasterMessageType.run,uid:o,method:t,args:r};l("Sending command to run function to worker:",p);try{e.postMessage(p,f)}catch(e){return a.ObservablePromise.from(Promise.reject(e))}return a.ObservablePromise.from(i.multicast(h(e,o)))}}t.createProxyFunction=f,t.createProxyModule=function(e,t){const n={};for(const o of t)n[o]=f(e,o);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(14),r=()=>{},i=e=>e,s=e=>Promise.resolve().then(e);function a(e){throw e}class c extends o.Observable{constructor(e){super(t=>{const n=this,o=Object.assign(Object.assign({},t),{complete(){t.complete(),n.onCompletion()},error(e){t.error(e),n.onError(e)},next(e){t.next(e),n.onNext(e)}});try{return this.initHasRun=!0,e(o)}catch(e){o.error(e)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)s(()=>t(e))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)s(()=>e(this.firstValue))}then(e,t){const n=e||i,o=t||a;let r=!1;return new Promise((e,t)=>{const i=n=>{if(!r){r=!0;try{e(o(n))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:i}),"fulfilled"===this.state?e(n(this.firstValue)):"rejected"===this.state?(r=!0,e(o(this.rejection))):(this.fulfillmentCallbacks.push(t=>{try{e(n(t))}catch(e){i(e)}}),void this.rejectionCallbacks.push(i))})}catch(e){return this.then(void 0,e)}finally(e){const t=e||r;return this.then(e=>(t(),e),()=>t())}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new c(t=>{e.then(e=>{t.next(e),t.complete()},e=>{t.error(e)})}):super.from(e)}}t.ObservablePromise=c},function(e,t,n){"use strict";(function(e){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(31)),s=n(19),a=n(25),c=n(44),u=r(n(74));var l=n(19);t.registerSerializer=l.registerSerializer;var d=n(25);t.Transfer=d.Transfer;let h=!1;const f=e=>e&&e.type===c.MasterMessageType.run,p=e=>i.default(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e);function m(e){return a.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function y(e,t){const{payload:n,transferables:o}=m(t),r={type:c.WorkerMessageType.error,uid:e,error:s.serialize(n)};u.default.postMessageToMaster(r,o)}function g(e,t,n){const{payload:o,transferables:r}=m(n),i={type:c.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:o};u.default.postMessageToMaster(i,r)}function v(e){try{const t={type:c.WorkerMessageType.uncaughtError,error:s.serialize(e)};u.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}function b(e,t,n){return o(this,void 0,void 0,(function*(){let o;try{o=t(...n)}catch(t){return y(e,t)}const r=p(o)?"observable":"promise";if(function(e,t){const n={type:c.WorkerMessageType.running,uid:e,resultType:t};u.default.postMessageToMaster(n)}(e,r),p(o))o.subscribe(t=>g(e,!1,s.serialize(t)),t=>y(e,s.serialize(t)),()=>g(e,!0));else try{const t=yield o;g(e,!0,s.serialize(t))}catch(t){y(e,s.serialize(t))}}))}t.expose=function(e){if(!u.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(h)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(h=!0,"function"==typeof e)u.default.subscribeToMasterMessages(t=>{f(t)&&!t.method&&b(t.uid,e,t.args.map(s.deserialize))}),function(){const e={type:c.WorkerMessageType.init,exposed:{type:"function"}};u.default.postMessageToMaster(e)}();else{if("object"!=typeof e||!e)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: "+e);u.default.subscribeToMasterMessages(t=>{f(t)&&t.method&&b(t.uid,e[t.method],t.args.map(s.deserialize))});!function(e){const t={type:c.WorkerMessageType.init,exposed:{type:"module",methods:e}};u.default.postMessageToMaster(t)}(Object.keys(e).filter(t=>"function"==typeof e[t]))}},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&u.default.isWorkerRuntime()&&(self.addEventListener("error",e=>{setTimeout(()=>v(e.error||e),250)}),self.addEventListener("unhandledrejection",e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout(()=>v(t),250)})),void 0!==e&&"function"==typeof e.on&&u.default.isWorkerRuntime()&&(e.on("uncaughtException",e=>{setTimeout(()=>v(e),250)}),e.on("unhandledRejection",e=>{e&&"string"==typeof e.message&&setTimeout(()=>v(e),250)}))}).call(this,n(18))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={isWorkerRuntime:function(){return!("undefined"==typeof self||!self.postMessage)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}},function(e,t,n){var o,r,i;r=[t],void 0===(i="function"==typeof(o=function(e){"use strict";e.__esModule=!0,e.sort=function(e,t,n,s){if(!Array.isArray(e))throw new TypeError("Can only sort arrays");t?"function"!=typeof t&&(s=n,n=t,t=o):t=o,n||(n=0),s||(s=e.length);var a=s-n;if(!(a<2)){var u=0;if(a<32)return u=r(e,n,s,t),void i(e,n,s,n+u,t);var l=new c(e,t),d=function(e){for(var t=0;e>=32;)t|=1&e,e>>=1;return e+t}(a);do{if((u=r(e,n,s,t))<d){var h=a;h>d&&(h=d),i(e,n,n+h,n+u,t),u=h}l.pushRun(n,u),l.mergeRuns(),a-=u,n+=u}while(0!==a);l.forceMergeRuns()}};var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function n(e){return e<1e5?e<100?e<10?0:1:e<1e4?e<1e3?2:3:4:e<1e7?e<1e6?5:6:e<1e9?e<1e8?7:8:9}function o(e,o){if(e===o)return 0;if(~~e===e&&~~o===o){if(0===e||0===o)return e<o?-1:1;if(e<0||o<0){if(o>=0)return-1;if(e>=0)return 1;e=-e,o=-o}var r=n(e),i=n(o),s=0;return r<i?(e*=t[i-r-1],o/=10,s=-1):r>i&&(o*=t[r-i-1],e/=10,s=1),e===o?s:e<o?-1:1}var a=String(e),c=String(o);return a===c?0:a<c?-1:1}function r(e,t,n,o){var r=t+1;if(r===n)return 1;if(o(e[r++],e[t])<0){for(;r<n&&o(e[r],e[r-1])<0;)r++;!function(e,t,n){for(n--;t<n;){var o=e[t];e[t++]=e[n],e[n--]=o}}(e,t,r)}else for(;r<n&&o(e[r],e[r-1])>=0;)r++;return r-t}function i(e,t,n,o,r){for(o===t&&o++;o<n;o++){for(var i=e[o],s=t,a=o;s<a;){var c=s+a>>>1;r(i,e[c])<0?a=c:s=c+1}var u=o-s;switch(u){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;u>0;)e[s+u]=e[s+u-1],u--}e[s]=i}}function s(e,t,n,o,r,i){var s=0,a=0,c=1;if(i(e,t[n+r])>0){for(a=o-r;c<a&&i(e,t[n+r+c])>0;)s=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a),s+=r,c+=r}else{for(a=r+1;c<a&&i(e,t[n+r-c])<=0;)s=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a);var u=s;s=r-c,c=r-u}for(s++;s<c;){var l=s+(c-s>>>1);i(e,t[n+l])>0?s=l+1:c=l}return c}function a(e,t,n,o,r,i){var s=0,a=0,c=1;if(i(e,t[n+r])<0){for(a=r+1;c<a&&i(e,t[n+r-c])<0;)s=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a);var u=s;s=r-c,c=r-u}else{for(a=o-r;c<a&&i(e,t[n+r+c])>=0;)s=c,(c=1+(c<<1))<=0&&(c=a);c>a&&(c=a),s+=r,c+=r}for(s++;s<c;){var l=s+(c-s>>>1);i(e,t[n+l])<0?c=l:s=l+1}return c}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.array=null,this.compare=null,this.minGallop=7,this.length=0,this.tmpStorageLength=256,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=t,this.compare=n,this.length=t.length,this.length<512&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return e.prototype.pushRun=function(e,t){this.runStart[this.stackSize]=e,this.runLength[this.stackSize]=t,this.stackSize+=1},e.prototype.mergeRuns=function(){for(;this.stackSize>1;){var e=this.stackSize-2;if(e>=1&&this.runLength[e-1]<=this.runLength[e]+this.runLength[e+1]||e>=2&&this.runLength[e-2]<=this.runLength[e]+this.runLength[e-1])this.runLength[e-1]<this.runLength[e+1]&&e--;else if(this.runLength[e]>this.runLength[e+1])break;this.mergeAt(e)}},e.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var e=this.stackSize-2;e>0&&this.runLength[e-1]<this.runLength[e+1]&&e--,this.mergeAt(e)}},e.prototype.mergeAt=function(e){var t=this.compare,n=this.array,o=this.runStart[e],r=this.runLength[e],i=this.runStart[e+1],c=this.runLength[e+1];this.runLength[e]=r+c,e===this.stackSize-3&&(this.runStart[e+1]=this.runStart[e+2],this.runLength[e+1]=this.runLength[e+2]),this.stackSize--;var u=a(n[i],n,o,r,0,t);o+=u,0!=(r-=u)&&0!==(c=s(n[o+r-1],n,i,c,c-1,t))&&(r<=c?this.mergeLow(o,r,i,c):this.mergeHigh(o,r,i,c))},e.prototype.mergeLow=function(e,t,n,o){var r=this.compare,i=this.array,c=this.tmp,u=0;for(u=0;u<t;u++)c[u]=i[e+u];var l=0,d=n,h=e;if(i[h++]=i[d++],0!=--o)if(1!==t){for(var f=this.minGallop;;){var p=0,m=0,y=!1;do{if(r(i[d],c[l])<0){if(i[h++]=i[d++],m++,p=0,0==--o){y=!0;break}}else if(i[h++]=c[l++],p++,m=0,1==--t){y=!0;break}}while((p|m)<f);if(y)break;do{if(0!==(p=a(i[d],c,l,t,0,r))){for(u=0;u<p;u++)i[h+u]=c[l+u];if(h+=p,l+=p,(t-=p)<=1){y=!0;break}}if(i[h++]=i[d++],0==--o){y=!0;break}if(0!==(m=s(c[l],i,d,o,0,r))){for(u=0;u<m;u++)i[h+u]=i[d+u];if(h+=m,d+=m,0==(o-=m)){y=!0;break}}if(i[h++]=c[l++],1==--t){y=!0;break}f--}while(p>=7||m>=7);if(y)break;f<0&&(f=0),f+=2}if(this.minGallop=f,f<1&&(this.minGallop=1),1===t){for(u=0;u<o;u++)i[h+u]=i[d+u];i[h+o]=c[l]}else{if(0===t)throw new Error("mergeLow preconditions were not respected");for(u=0;u<t;u++)i[h+u]=c[l+u]}}else{for(u=0;u<o;u++)i[h+u]=i[d+u];i[h+o]=c[l]}else for(u=0;u<t;u++)i[h+u]=c[l+u]},e.prototype.mergeHigh=function(e,t,n,o){var r=this.compare,i=this.array,c=this.tmp,u=0;for(u=0;u<o;u++)c[u]=i[n+u];var l=e+t-1,d=o-1,h=n+o-1,f=0,p=0;if(i[h--]=i[l--],0!=--t)if(1!==o){for(var m=this.minGallop;;){var y=0,g=0,v=!1;do{if(r(c[d],i[l])<0){if(i[h--]=i[l--],y++,g=0,0==--t){v=!0;break}}else if(i[h--]=c[d--],g++,y=0,1==--o){v=!0;break}}while((y|g)<m);if(v)break;do{if(0!=(y=t-a(c[d],i,e,t,t-1,r))){for(t-=y,p=1+(h-=y),f=1+(l-=y),u=y-1;u>=0;u--)i[p+u]=i[f+u];if(0===t){v=!0;break}}if(i[h--]=c[d--],1==--o){v=!0;break}if(0!=(g=o-s(i[l],c,0,o,o-1,r))){for(o-=g,p=1+(h-=g),f=1+(d-=g),u=0;u<g;u++)i[p+u]=c[f+u];if(o<=1){v=!0;break}}if(i[h--]=i[l--],0==--t){v=!0;break}m--}while(y>=7||g>=7);if(v)break;m<0&&(m=0),m+=2}if(this.minGallop=m,m<1&&(this.minGallop=1),1===o){for(p=1+(h-=t),f=1+(l-=t),u=t-1;u>=0;u--)i[p+u]=i[f+u];i[h]=c[d]}else{if(0===o)throw new Error("mergeHigh preconditions were not respected");for(f=h-(o-1),u=0;u<o;u++)i[f+u]=c[u]}}else{for(p=1+(h-=t),f=1+(l-=t),u=t-1;u>=0;u--)i[p+u]=i[f+u];i[h]=c[d]}else for(f=h-(o-1),u=0;u<o;u++)i[f+u]=c[u]},e}()})?o.apply(t,r):o)||(e.exports=i)},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NEAT=void 0;const a=i(n(26)),c=n(47),u=n(16),l=n(7);t.NEAT=class{constructor(e){if(!e.fitnessFunction)throw new ReferenceError("No fitness function given!");this._options=e,this.population=[],this.species=new Set;for(let e=0;e<this.options.populationSize;e++)this.population.push(this.options.template.deepCopy())}get options(){return this._options}set options(e){this._options=e}mutateRandom(e){const t=this.options.mutations.filter(t=>t.constructor.name!==u.AddNodeMutation.constructor.name||e.nodes.length<this.options.maxNodes||t.constructor.name!==u.AddConnectionMutation.constructor.name||e.connections.size<this.options.maxConnections||t.constructor.name!==u.AddGateMutation.constructor.name||e.gates.size<this.options.maxGates);e.mutate(l.pickRandom(t),{allowedActivations:this.options.activations})}evolve(){return s(this,void 0,void 0,(function*(){if(this.genSpecies(),yield this.evaluate(),this.sort(),this.species.forEach(e=>e.evaluateScore()),this.kill(1-this.options.survivors),this.removeExtinctSpecies(),this.reproduce(),this.mutate(),this.options.training)for(const e of this.population)e.train(this.options.training);yield this.evaluate(),this.sort();const e=this.population[0].deepCopy();if(e.score=this.population[0].score,this.options.log>0&&this.options.generation%this.options.log==0){console.log("\n---------------------------"),console.log("Generation: "+this.options.generation+"; Species: "+this.species.size+"; Score: "+this.population[0].score);for(const e of this.species)e.print()}return this.population.forEach(e=>e.score=void 0),this.options.generation++,e}))}mutate(e){this.population.filter(()=>Math.random()<=this.options.mutationRate).forEach(t=>{for(let n=0;n<this.options.mutationAmount;n++)e?t.mutate(e):this.mutateRandom(t)})}evaluate(){var e,t;return s(this,void 0,void 0,(function*(){return this.options.clear&&this.population.forEach(e=>e.clear()),yield null===(t=(e=this.options).fitnessFunction)||void 0===t?void 0:t.call(e,this.population,this.options.dataset),this.sort(),this.population[0]}))}sort(){a.sort(this.population,(e,t)=>void 0===e.score||void 0===t.score?0:t.score-e.score)}getFittest(){return s(this,void 0,void 0,(function*(){return void 0===this.population[this.population.length-1].score&&(yield this.evaluate()),this.sort(),this.population[0]}))}getAverage(){return s(this,void 0,void 0,(function*(){void 0===this.population[this.population.length-1].score&&(yield this.evaluate());let e=0;return this.population.map(e=>e.score).forEach(t=>e+=null!=t?t:0),e/this.population.length}))}replacePopulation(e){this.population=e,this.options.populationSize=e.length}reproduce(){const e=Array.from(this.species);if(0!==e.length)for(let t=0;t<this.population.length;t++)if(null===this.population[t].species){const n=this.options.selection.select(e);this.population[t]=n.breed(),n.forcePut(this.population[t])}}removeExtinctSpecies(){for(const e of Array.from(this.species))(e.size()<=1||e.stagnation>this.options.maxStagnation)&&(e.members.forEach(e=>e.species=null),this.species.delete(e))}kill(e){this.species.forEach(t=>t.kill(e))}genSpecies(){this.species.forEach(e=>e.reset()),this.population.filter(e=>null===e.species).forEach(e=>{let t=!1;for(const n of Array.from(this.species))if(n.put(e,this.options.c1,this.options.c2,this.options.c3,this.options.speciesDistanceThreshold)){t=!0;break}t||this.species.add(new c.Species(e))})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivationLayer=void 0;const o=n(3),r=n(4),i=n(78),s=n(5);class a extends s.Layer{constructor(e,t={}){var n;super(e);const r=null!==(n=t.activation)&&void 0!==n?n:o.Logistic;for(let t=0;t<e;t++)this.inputNodes.add((new i.ActivationNode).setActivationType(r));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}connectionTypeisAllowed(e){return e===r.ConnectionType.ONE_TO_ONE}getDefaultIncomingConnectionType(){return r.ConnectionType.ONE_TO_ONE}}t.ActivationLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivationNode=void 0;const o=n(7),r=n(17);class i extends r.ConstantNode{constructor(){super()}activate(){this.prevState=this.state;const e=Array.from(this.incoming).map(e=>e.from.activation*e.weight*e.gain);if(1!==e.length)throw new ReferenceError("Only 1 incoming connections is allowed!");return this.state=e[0],this.activation=this.squash(this.state,!1)*this.mask,this.derivativeState=this.squash(this.state,!0),this.activation}propagate(e,t){var n,r,i;t.momentum=null!==(n=t.momentum)&&void 0!==n?n:0,t.rate=null!==(r=t.rate)&&void 0!==r?r:.3,t.update=null===(i=t.update)||void 0===i||i;const s=Array.from(this.outgoing).map(e=>e.to.errorResponsibility*e.weight*e.gain);this.errorResponsibility=this.errorProjected=o.sum(s)*this.derivativeState,this.incoming.forEach(e=>{var n,o;let r=this.errorProjected*e.eligibility;e.xTrace.forEach((e,t)=>{r+=t.errorResponsibility*e}),e.deltaWeightsTotal+=(null!==(n=t.rate)&&void 0!==n?n:.3)*r*this.mask,t.update&&(e.deltaWeightsTotal+=(null!==(o=t.momentum)&&void 0!==o?o:0)*e.deltaWeightsPrevious,e.weight+=e.deltaWeightsTotal,e.deltaWeightsPrevious=e.deltaWeightsTotal,e.deltaWeightsTotal=0)})}}t.ActivationNode=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DenseLayer=void 0;const o=n(3),r=n(4),i=n(2),s=n(10),a=n(5);class c extends a.Layer{constructor(e,t={}){var n;super(e);const r=null!==(n=t.activationType)&&void 0!==n?n:o.Logistic;for(let t=0;t<e;t++)this.inputNodes.add(new s.Node(i.NodeType.HIDDEN).setActivationType(r));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.DenseLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DropoutLayer=void 0;const o=n(3),r=n(4),i=n(48),s=n(5);class a extends s.Layer{constructor(e,t={}){var n,r;super(e);const s=null!==(n=t.activation)&&void 0!==n?n:o.Identitiy,a=null!==(r=t.probability)&&void 0!==r?r:.1;for(let t=0;t<e;t++)this.inputNodes.add(new i.DropoutNode(a).setActivationType(s));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes))}getDefaultIncomingConnectionType(){return r.ConnectionType.ONE_TO_ONE}connectionTypeisAllowed(e){return e===r.ConnectionType.ONE_TO_ONE}}t.DropoutLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalAvgPooling1DLayer=void 0;const o=n(49);class r extends o.AvgPooling1DLayer{constructor(e,t={}){super(1,t)}}t.GlobalAvgPooling1DLayer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalMaxPooling1DLayer=void 0;const o=n(50);class r extends o.MaxPooling1DLayer{constructor(e,t={}){super(1,t)}}t.GlobalMaxPooling1DLayer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalMinPooling1DLayer=void 0;const o=n(51);class r extends o.MinPooling1DLayer{constructor(e,t={}){super(1,t)}}t.GlobalMinPooling1DLayer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GRULayer=void 0;const o=n(3),r=n(4),i=n(22),s=n(2),a=n(10),c=n(5);class u extends c.Layer{constructor(e,t={}){super(e);const n=[],u=[],l=[],d=[],h=[];for(let t=0;t<e;t++)this.inputNodes.add(new a.Node(s.NodeType.HIDDEN)),n.push(new a.Node(s.NodeType.HIDDEN).setBias(1)),u.push(new a.Node(s.NodeType.HIDDEN).setBias(0).setActivationType(o.Logistic)),l.push(new a.Node(s.NodeType.HIDDEN).setBias(0)),d.push(new a.Node(s.NodeType.HIDDEN).setActivationType(o.TANH)),h.push(new a.Node(s.NodeType.HIDDEN).setBias(0).setActivationType(o.Logistic)),this.outputNodes.add(new a.Node(s.NodeType.HIDDEN));this.connections.push(...c.Layer.connect(this.inputNodes,n,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(this.inputNodes,l,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(this.inputNodes,d,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(h,n,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(n,u,r.ConnectionType.ONE_TO_ONE,1)),this.connections.push(...c.Layer.connect(h,l,r.ConnectionType.ALL_TO_ALL));const f=c.Layer.connect(h,d,r.ConnectionType.ALL_TO_ALL);this.connections.push(...f),this.gates.push(...c.Layer.gate(l,f,i.GatingType.OUTPUT));const p=c.Layer.connect(h,this.outputNodes,r.ConnectionType.ALL_TO_ALL),m=c.Layer.connect(d,this.outputNodes,r.ConnectionType.ALL_TO_ALL);this.connections.push(...p),this.connections.push(...m),this.gates.push(...c.Layer.gate(n,p,i.GatingType.OUTPUT)),this.gates.push(...c.Layer.gate(u,m,i.GatingType.OUTPUT)),this.connections.push(...c.Layer.connect(this.outputNodes,h,r.ConnectionType.ONE_TO_ONE,1)),this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...n),this.nodes.push(...u),this.nodes.push(...l),this.nodes.push(...d),this.nodes.push(...Array.from(this.outputNodes)),this.nodes.push(...h),this.outputNodes.forEach(e=>{var n;return e.squash=null!==(n=t.activation)&&void 0!==n?n:o.Logistic})}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.GRULayer=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HopfieldLayer=void 0;const o=n(3),r=n(4),i=n(2),s=n(10),a=n(5);class c extends a.Layer{constructor(e){super(e);for(let t=0;t<e;t++)this.inputNodes.add(new s.Node(i.NodeType.HIDDEN)),this.outputNodes.add(new s.Node(i.NodeType.HIDDEN).setActivationType(o.BinaryStep));this.connections.push(...a.Layer.connect(this.inputNodes,this.outputNodes,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...a.Layer.connect(this.outputNodes,this.inputNodes,r.ConnectionType.ALL_TO_ALL)),this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...Array.from(this.outputNodes))}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.HopfieldLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LSTMLayer=void 0;const o=n(3),r=n(4),i=n(22),s=n(2),a=n(10),c=n(5);class u extends c.Layer{constructor(e,t={}){super(e);const n=[],u=[],l=[],d=[];for(let t=0;t<e;t++)this.inputNodes.add(new a.Node(s.NodeType.HIDDEN)),n.push(new a.Node(s.NodeType.HIDDEN).setBias(1)),u.push(new a.Node(s.NodeType.HIDDEN).setBias(1).setActivationType(o.Logistic)),l.push(new a.Node(s.NodeType.HIDDEN)),d.push(new a.Node(s.NodeType.HIDDEN).setBias(1)),this.outputNodes.add(new a.Node(s.NodeType.HIDDEN));this.connections.push(...c.Layer.connect(l,n,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(l,u,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(l,d,r.ConnectionType.ALL_TO_ALL));const h=c.Layer.connect(l,l,r.ConnectionType.ONE_TO_ONE),f=c.Layer.connect(l,this.outputNodes,r.ConnectionType.ALL_TO_ALL);this.connections.push(...h),this.connections.push(...f),this.connections.push(...c.Layer.connect(this.inputNodes,l,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(this.inputNodes,d,r.ConnectionType.ALL_TO_ALL)),this.connections.push(...c.Layer.connect(this.inputNodes,u,r.ConnectionType.ALL_TO_ALL));const p=c.Layer.connect(this.inputNodes,n,r.ConnectionType.ALL_TO_ALL);this.connections.push(...p),this.gates.push(...c.Layer.gate(u,h,i.GatingType.SELF)),this.gates.push(...c.Layer.gate(d,f,i.GatingType.OUTPUT)),this.gates.push(...c.Layer.gate(n,p,i.GatingType.INPUT)),this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...n),this.nodes.push(...u),this.nodes.push(...l),this.nodes.push(...d),this.nodes.push(...Array.from(this.outputNodes)),this.outputNodes.forEach(e=>{var n;return e.squash=null!==(n=t.activation)&&void 0!==n?n:o.TANH})}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.LSTMLayer=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryLayer=void 0;const o=n(3),r=n(4),i=n(2),s=n(10),a=n(5);class c extends a.Layer{constructor(e,t={}){var n;super(e);for(let t=0;t<e;t++)this.inputNodes.add(new s.Node(i.NodeType.HIDDEN));let c=Array.from(this.inputNodes);const u=[];for(let l=0;l<(null!==(n=t.memorySize)&&void 0!==n?n:1);l++){const t=[];for(let n=0;n<e;n++){const e=new s.Node(i.NodeType.HIDDEN);e.squash=o.Identitiy,e.bias=0,t.push(e)}this.connections.push(...a.Layer.connect(c,t,r.ConnectionType.ONE_TO_ONE)),u.push(...t),c=t}this.nodes.push(...Array.from(this.inputNodes)),this.nodes.push(...u.reverse()),c.forEach(e=>this.outputNodes.add(e)),this.outputNodes.forEach(e=>{var n;return e.squash=null!==(n=t.activation)&&void 0!==n?n:o.Logistic})}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.MemoryLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RNNLayer=void 0;const o=n(3),r=n(4),i=n(2),s=n(10),a=n(5);class c extends a.Layer{constructor(e,t={}){var n;super(e);for(let r=0;r<e;r++)this.inputNodes.add(new s.Node(i.NodeType.HIDDEN).setActivationType(null!==(n=t.activation)&&void 0!==n?n:o.Logistic));this.outputNodes=this.inputNodes,this.nodes.push(...Array.from(this.inputNodes)),this.connections.push(...a.Layer.connect(this.nodes,this.nodes,r.ConnectionType.ONE_TO_ONE))}connectionTypeisAllowed(){return!0}getDefaultIncomingConnectionType(){return r.ConnectionType.ALL_TO_ALL}}t.RNNLayer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrainOptions=void 0;const o=n(27),r=n(52);t.TrainOptions=class{constructor(e){this._dataset=e,this._iterations=-1,this._error=-1,this._loss=o.MSELoss,this._dropout=0,this._momentum=0,this._batchSize=this.dataset.length,this._rate=new r.FixedRate(.3),this._log=-1,this._crossValidateTestSize=-1,this._shuffle=!1,this._clear=!1}get dataset(){return this._dataset}set dataset(e){this._dataset=e}get shuffle(){return this._shuffle}set shuffle(e){this._shuffle=e}get clear(){return this._clear}set clear(e){this._clear=e}get schedule(){return this._schedule}set schedule(e){this._schedule=e}get crossValidateTestSize(){return this._crossValidateTestSize}set crossValidateTestSize(e){this._crossValidateTestSize=e}get rate(){return this._rate}set rate(e){this._rate=e}get loss(){return this._loss}set loss(e){this._loss=e}get iterations(){return this._iterations}set iterations(e){this._iterations=e}get error(){return this._error}set error(e){this._error=e}get momentum(){return this._momentum}set momentum(e){this._momentum=e}get dropout(){return this._dropout}set dropout(e){this._dropout=e}get log(){return this._log}set log(e){this._log=e}get batchSize(){return this._batchSize}set batchSize(e){this._batchSize=e}}},function(e,t,n){"use strict";n.r(t),n.d(t,"registerSerializer",(function(){return o.b})),n.d(t,"Pool",(function(){return N})),n.d(t,"spawn",(function(){return L.a})),n.d(t,"Thread",(function(){return v})),n.d(t,"Worker",(function(){return _})),n.d(t,"expose",(function(){return E.a})),n.d(t,"DefaultSerializer",(function(){return S.a})),n.d(t,"Transfer",(function(){return P.a}));var o=n(0);let r;function i(){return r||(r=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return(""+t[0]).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}return"/"}()),r}const s="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,a=e=>/^(file|https?:)?\/\//i.test(e);function c(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}var u,l=n(12),d=n.n(l),h=n(30),f=n(38),p=n(1);function m(e){return Promise.all(e.map(e=>{const t=e=>({status:"fulfilled",value:e}),n=e=>({status:"rejected",reason:e}),o=Promise.resolve(e);try{return o.then(t,n)}catch(e){return Promise.reject(e)}}))}!function(e){e.initialized="initialized",e.taskCanceled="taskCanceled",e.taskCompleted="taskCompleted",e.taskFailed="taskFailed",e.taskQueued="taskQueued",e.taskQueueDrained="taskQueueDrained",e.taskStart="taskStart",e.terminated="terminated"}(u||(u={}));var y=n(8);function g(e){throw Error(e)}const v={errors:e=>e[y.a]||g("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:e=>e[y.b]||g("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:e=>e[y.c]()};var b=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};let w=1;class T{constructor(e,t){this.eventSubject=new h.a,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const n="number"==typeof t?{size:t}:t||{},{size:o=s}=n;this.debug=d()("threads:pool:"+(n.name||String(w++)).replace(/\W/g," ").trim().replace(/\s+/g,"-")),this.options=n,this.workers=function(e,t){return function(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}(t).map(()=>({init:e(),runningTasks:[]}))}(e,o),this.eventObservable=Object(f.a)(p.b.from(this.eventSubject)),Promise.all(this.workers.map(e=>e.init)).then(()=>this.eventSubject.next({type:u.initialized,size:this.workers.length}),e=>{this.debug("Error while initializing pool worker:",e),this.eventSubject.error(e),this.initErrors.push(e)})}findIdlingWorker(){const{concurrency:e=1}=this.options;return this.workers.find(t=>t.runningTasks.length<e)}runPoolTask(e,t){return b(this,void 0,void 0,(function*(){const n=this.workers.indexOf(e)+1;this.debug(`Running task #${t.id} on worker #${n}...`),this.eventSubject.next({type:u.taskStart,taskID:t.id,workerID:n});try{const o=yield t.run(yield e.init);this.debug(`Task #${t.id} completed successfully`),this.eventSubject.next({type:u.taskCompleted,returnValue:o,taskID:t.id,workerID:n})}catch(e){this.debug(`Task #${t.id} failed`),this.eventSubject.next({type:u.taskFailed,taskID:t.id,error:e,workerID:n})}}))}run(e,t){return b(this,void 0,void 0,(function*(){const n=(()=>b(this,void 0,void 0,(function*(){var o;yield(o=0,new Promise(e=>setTimeout(e,o)));try{yield this.runPoolTask(e,t)}finally{e.runningTasks=e.runningTasks.filter(e=>e!==n),this.isClosing||this.scheduleWork()}})))();e.runningTasks.push(n)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const e=this.findIdlingWorker();if(!e)return;const t=this.taskQueue.shift();if(!t)return this.debug("Task queue is empty"),void this.eventSubject.next({type:u.taskQueueDrained});this.run(e,t)}taskCompletion(e){return new Promise((t,n)=>{const o=this.events().subscribe(r=>{r.type===u.taskCompleted&&r.taskID===e?(o.unsubscribe(),t(r.returnValue)):r.type===u.taskFailed&&r.taskID===e?(o.unsubscribe(),n(r.error)):r.type===u.terminated&&(o.unsubscribe(),n(Error("Pool has been terminated before task was run.")))})})}settled(e=!1){return b(this,void 0,void 0,(function*(){const t=()=>{return e=this.workers,t=e=>e.runningTasks,e.reduce((e,n)=>[...e,...t(n)],[]);var e,t},n=[],o=this.eventObservable.subscribe(e=>{e.type===u.taskFailed&&n.push(e.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):e&&0===this.taskQueue.length?(yield m(t()),n):(yield new Promise((e,t)=>{const n=this.eventObservable.subscribe({next(t){t.type===u.taskQueueDrained&&(n.unsubscribe(),e())},error:t})}),yield m(t()),o.unsubscribe(),n)}))}completed(e=!1){return b(this,void 0,void 0,(function*(){const t=this.settled(e),n=new Promise((e,n)=>{const o=this.eventObservable.subscribe({next(r){r.type===u.taskQueueDrained?(o.unsubscribe(),e(t)):r.type===u.taskFailed&&(o.unsubscribe(),n(r.error))},error:n})}),o=yield Promise.race([t,n]);if(o.length>0)throw o[0]}))}events(){return this.eventObservable}queue(e){const{maxQueuedJobs:t=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const n=()=>this.taskCompletion(r.id);let o;const r={id:this.nextTaskID++,run:e,cancel:()=>{-1!==this.taskQueue.indexOf(r)&&(this.taskQueue=this.taskQueue.filter(e=>e!==r),this.eventSubject.next({type:u.taskCanceled,taskID:r.id}))},get then(){if(!o){const e=n();o=e.then.bind(e)}return o}};if(this.taskQueue.length>=t)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${r.id}...`),this.taskQueue.push(r),this.eventSubject.next({type:u.taskQueued,taskID:r.id}),this.scheduleWork(),r}terminate(e){return b(this,void 0,void 0,(function*(){this.isClosing=!0,e||(yield this.completed(!0)),this.eventSubject.next({type:u.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(e=>b(this,void 0,void 0,(function*(){return v.terminate(yield e.init)}))))}))}}function O(e,t){return new T(e,t)}T.EventType=u,O.EventType=u;const N=O;var L=n(39);const _="undefined"==typeof Worker?class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}}:class extends Worker{constructor(e,t){"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!a(e)&&i().match(/^file:\/\//i)&&(e=new URL(e,i().replace(/\/[^\/]+$/,"/")),e=c(`importScripts(${JSON.stringify(e)});`)),"string"==typeof e&&a(e)&&(e=c(`importScripts(${JSON.stringify(e)});`)),super(e,t)}};var E=n(40),S=n(20),P=n(15)}]);